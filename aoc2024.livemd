# aoc

## 2024

```elixir
defmodule AOC do
  def int(s), do: String.to_integer(s)
  def str(x), do: to_string(x)

  def dup(x, n), do: for(_ <- 1..n//1, do: x)

  def int2d(s, sep \\ ~r/[^\d]+/) do
    String.split(s, "\n", trim: true)
    |> Enum.map(fn s -> for i <- String.split(s, sep), i != "", do: int(i) end)
  end

  def mod(a, b), do: Integer.mod(a, b)
  def divmod(a, b), do: {div(a, b), mod(a, b)}

  def puts(s), do: IO.puts(inspect s, printable_limit: :infinity) && s

  def putm(m) do
    for({{h, w}, _} <- [Enum.max m], i <- 0..h, do: IO.puts(for j <- 0..w, do: m[{i, j}])) && m
  end

  def s2map(s) do
    for {r, i} <- String.split(s, "\n", trim: true) |> Enum.with_index(),
        {c, j} <- String.to_charlist(r) |> Enum.with_index(),
      into: %{}, do: {{i, j}, c}
  end

  def add2({x, y}, {u, v}), do: {x + u, y + v}
  def sub2({x, y}, {u, v}), do: {x - u, y - v}
  def mul2({x, y}, k), do: {x * k, y * k}
  def l1norm({x1, y1}, {x2, y2}), do: abs(x1 - x2) + abs(y1 - y2)
  def dir4(), do: [{1, 0}, {0, 1}, {-1, 0}, {0, -1}]
  def dir8(), do: [{-1, -1}, {-1, 0}, {-1, 1}, { 0, -1}, { 0, 1}, { 1, -1}, { 1, 0}, { 1, 1}]
  def move(p, ds \\ dir4()), do: for(d <- ds, do: add2(p, d))
  def set(enum \\ []), do: MapSet.new(enum)

  defmacro cache(key, do: expr) do
    quote do
      Process.get(unquote(key)) || unquote(expr) |> tap(&Process.put(unquote(key), &1))
    end
  end
end
```

```elixir
defmodule DayNN do
  #import AOC

  def part1(input) do
    input
  end

  def part2(input) do
    input
  end
end

input = ~S"""
"""
|> AOC.puts()

_input = ~S"""
"""

DayNN.part1(input) |> IO.inspect(label: :dayNN_part1, charlists: :as_lists)
DayNN.part2(input) |> IO.inspect(label: :dayNN_part2, charlists: :as_lists)
```

```elixir
defmodule Day1 do
  def parse(s), do: AOC.int2d(s) |> Enum.map(&List.to_tuple/1) |> Enum.unzip()
  def enum1({a, b}), do: for({i, j} <- Enum.zip(Enum.sort(a), Enum.sort(b)), do: abs i - j)
  def enum2({a, b}), do: for(i <- a, do: i * Enum.count(b, &i == &1))
  def part1(s), do: parse(s) |> enum1() |> Enum.sum()
  def part2(s), do: parse(s) |> enum2() |> Enum.sum()
end

input = "61967   56543\n11022   54992\n21268   29417\n90452   95846\n90728   95846\n82351   12878\n40277   58932\n36981   22944\n93875   53190\n39283   59850\n39396   34776\n16395   35328\n32473   10395\n15028   20276\n31930   65432\n24773   22172\n40802   97123\n10909   29189\n23996   60290\n55260   93875\n93378   76216\n46284   95037\n41664   15145\n84475   39021\n52069   55213\n94827   20473\n79648   48127\n43947   76411\n20473   71938\n70251   80695\n13125   65297\n49246   75802\n49184   15227\n92091   54909\n31992   41267\n45911   19856\n93403   97963\n45807   76216\n61063   41259\n47907   21322\n15388   15227\n85798   13686\n60015   50364\n34294   34597\n14526   70647\n79498   72002\n76367   46598\n10763   67546\n53531   88962\n86158   30240\n48843   20473\n74127   95846\n29239   39021\n89243   55213\n42208   52849\n11396   54168\n51485   54805\n28347   34661\n32396   55213\n89137   18330\n84414   55213\n64013   12511\n50364   62725\n69550   70382\n75395   47413\n86240   56543\n22944   56900\n99262   56543\n70893   48848\n49889   85195\n41385   85280\n33498   11649\n53359   11649\n35483   61686\n15429   34776\n82878   78142\n71716   76015\n63677   22034\n38703   71901\n88599   89560\n34092   19913\n79849   34661\n86969   51576\n28571   33019\n26154   22944\n52835   29417\n53205   77890\n20276   39461\n82458   50421\n85308   55213\n23780   34661\n35311   30488\n42273   63441\n68289   14174\n53846   48389\n66984   86158\n69976   83576\n44223   36234\n40372   27603\n83168   76216\n60101   62691\n99675   90166\n70006   84175\n24063   54443\n54560   10210\n30011   34776\n77029   26998\n37798   77700\n69137   77283\n68787   22650\n93357   39021\n18050   81124\n78744   18131\n32059   46598\n21287   42621\n42292   11649\n99706   11352\n86307   34948\n53716   41259\n84440   80333\n39562   66295\n81493   90431\n64911   41267\n41829   82797\n33421   55780\n73962   65004\n70599   48389\n71389   78405\n56211   96609\n86614   20276\n60185   18584\n46519   19856\n85341   21402\n63706   54396\n99509   19131\n77048   68330\n47476   41259\n19677   48389\n21320   22944\n98668   67439\n77246   41489\n20072   31880\n63382   27469\n86557   20276\n80371   51645\n24256   21964\n53783   49002\n36807   85389\n98394   82801\n95346   86158\n10431   85065\n98843   95846\n18651   63897\n10144   65443\n49483   34856\n72449   30766\n94011   91054\n11029   24754\n36006   54821\n18459   65297\n52537   10646\n58677   95846\n52571   24400\n45008   53241\n84084   59701\n63723   65432\n41397   25462\n66176   94916\n37821   87108\n10786   81993\n43825   48389\n59143   99924\n55219   45778\n53780   75436\n52820   46104\n23497   84939\n88371   58423\n41259   37181\n22603   76216\n99333   15881\n96990   19856\n56662   49575\n54876   67245\n25213   78142\n24559   78821\n58907   68881\n14836   15227\n22463   68881\n52592   29417\n39763   40027\n28925   62885\n74177   38729\n58731   56543\n86958   26033\n50538   25025\n18993   10013\n80692   56917\n27924   43417\n57696   84166\n66253   34776\n27631   43340\n66106   94016\n95853   48244\n70430   82286\n23027   26092\n56532   95846\n67501   45349\n12215   41267\n19720   50585\n96226   45042\n74000   27047\n62451   32342\n31717   76164\n45992   51137\n41345   62978\n58818   89347\n49405   34661\n71577   69710\n54334   20032\n23609   78142\n34661   25224\n15665   41259\n69935   21666\n30320   10215\n47745   22944\n16919   79188\n90987   50880\n43151   35249\n56543   85280\n31607   43137\n50565   96043\n76216   53795\n31299   74160\n12068   52582\n34212   25224\n59157   27762\n49371   80778\n12067   34054\n84925   15227\n94050   15227\n16313   95846\n45020   76657\n96730   50985\n35597   80727\n15922   86678\n72237   15949\n19348   91593\n22493   50364\n81453   36932\n63469   31880\n83204   44281\n97516   76216\n29851   85280\n83853   50364\n22722   65432\n44826   11286\n78112   61461\n34712   11649\n77566   63897\n89300   56543\n84751   22250\n17748   34661\n26317   65297\n93586   85526\n93545   46598\n80829   92121\n31655   65297\n70888   19856\n78658   67271\n19856   34776\n39960   56479\n61689   39021\n70480   50390\n55500   21322\n43674   65945\n17507   21322\n37527   60767\n46386   25187\n26815   49575\n84007   56865\n88175   51137\n36052   48389\n59939   53813\n72268   65297\n81352   61501\n16822   68881\n36521   85280\n34361   99506\n63695   86158\n98179   63897\n84080   95846\n35952   25224\n63718   16985\n47260   21322\n32958   86125\n46871   95846\n84506   62971\n22962   87402\n44900   74111\n79913   81638\n83540   20473\n90341   89847\n17097   75291\n95448   11649\n10951   65297\n66309   43216\n71201   15227\n52481   62912\n21951   51137\n22464   62319\n10029   63499\n78832   76216\n98333   11649\n40894   68881\n52946   19856\n50329   14803\n29823   39056\n76686   20473\n83170   26188\n53459   68881\n13042   33617\n78116   60418\n48212   51137\n92069   88727\n57787   34115\n73872   25224\n50550   18671\n97638   62724\n41131   65597\n84806   55213\n94592   31880\n71180   41259\n92360   97729\n98620   62980\n34471   52669\n91532   20276\n35790   61616\n75503   15748\n75074   21322\n11737   41127\n77602   25224\n94166   11649\n11580   58318\n33589   65023\n28957   41259\n48071   85280\n46598   71087\n36777   62347\n60594   20473\n81800   83420\n31339   40736\n16207   47305\n23624   48389\n41126   73202\n95465   44217\n73513   58171\n48492   34661\n27319   65297\n15520   19856\n48278   74391\n42528   42241\n21889   96386\n61833   19076\n13142   93210\n19905   15227\n64895   13547\n15908   78271\n20442   55213\n33221   50364\n78895   40466\n56182   97639\n40093   14980\n85157   26820\n36540   96113\n56873   49315\n39565   30340\n93297   49684\n43957   63789\n63897   50409\n69723   58764\n26167   17686\n78216   51576\n66527   84415\n51137   19856\n36635   56543\n59257   93611\n80851   26970\n21322   36633\n60017   19856\n74310   12230\n54464   85280\n74537   55813\n55344   19856\n19176   41267\n31914   76216\n77455   80335\n34039   39669\n35118   89909\n65432   74023\n37950   11649\n36603   62501\n52464   46856\n32342   72736\n89467   63318\n98246   67207\n15075   17421\n76916   74263\n92157   95846\n31880   43080\n45051   13900\n91452   67550\n68619   90797\n54105   39021\n33071   72624\n63784   57575\n67379   49283\n38131   29417\n57202   55213\n21615   56543\n90526   46598\n96898   65297\n49860   34661\n74266   93975\n21484   44229\n66643   68881\n16715   84749\n90512   73621\n89388   16965\n94053   36641\n35962   65432\n29763   47174\n14745   77272\n34993   34661\n83014   11649\n60837   92670\n15494   20473\n47055   93024\n12035   36814\n49721   39021\n26438   39677\n21933   19856\n16148   40828\n87391   68949\n56399   22506\n48696   72022\n95549   10092\n18684   52865\n44990   21322\n77310   19856\n35505   83623\n89352   74555\n86186   55213\n23227   94800\n37067   34776\n74039   42442\n53442   92091\n85527   55213\n64005   63897\n60463   60857\n84190   19303\n11722   99564\n47545   20473\n50423   25224\n19300   13219\n11549   88441\n41246   56543\n64539   21322\n16656   21331\n81984   29417\n21166   65297\n27236   27913\n73250   22933\n14078   21480\n86888   37494\n60623   68881\n56818   25224\n92340   28382\n72247   42211\n19198   85280\n29546   52039\n44394   65297\n14866   21610\n67444   21322\n85995   96825\n71932   38843\n99764   34776\n79024   43841\n59707   89498\n45503   87250\n83594   96789\n85277   55213\n32640   95846\n27823   23982\n28543   31399\n33759   95846\n23087   91530\n93094   93695\n88151   82097\n53506   17212\n61712   63975\n69833   45914\n19987   60322\n68648   28755\n15919   34380\n76804   90603\n83622   39021\n89705   46485\n29860   58935\n58392   78957\n26149   17889\n19305   89821\n88282   17673\n14085   75808\n78937   41259\n75320   64962\n84453   21322\n29476   94656\n84039   41267\n84385   11391\n39529   52865\n63057   23532\n37397   56543\n39202   19856\n90160   15799\n20310   22944\n40937   41267\n44029   91325\n50399   34661\n83445   39021\n58878   60759\n87071   87733\n44142   46155\n71837   82441\n74478   86781\n68295   50364\n94162   65432\n69323   97655\n63974   61934\n39245   98569\n13669   47701\n44744   34661\n75459   50364\n88291   55213\n99416   11649\n36887   85280\n29988   45252\n97663   76216\n35645   26140\n78021   85280\n67424   69456\n72759   79790\n33820   20473\n95942   39872\n81333   85280\n40810   61461\n69479   32816\n15379   24034\n11921   13179\n52719   54900\n20410   63897\n97887   15408\n40546   43910\n44053   49808\n90572   60565\n80385   78142\n40458   95846\n92895   29481\n30189   84413\n52865   69499\n19745   52865\n50975   49392\n89519   73695\n86176   38188\n47604   62257\n67436   29417\n11296   82182\n85459   91364\n27362   38039\n10585   59869\n46438   22944\n44742   35866\n85280   16513\n21227   81727\n16973   32676\n47127   68881\n98849   68881\n38328   21322\n12186   31773\n13799   71462\n13565   51576\n29848   45510\n76548   86158\n67804   56543\n55213   88508\n88481   12489\n13389   41259\n25035   88404\n50679   51137\n13786   85280\n50406   11649\n38054   89777\n79568   24534\n24756   85373\n93482   86158\n43790   79276\n60250   83576\n43730   21322\n87160   36323\n88807   61112\n97993   89540\n44262   89194\n82245   85280\n40413   96894\n56866   55804\n27892   93799\n15314   52111\n23042   60143\n97060   89497\n58200   19325\n27659   67004\n89411   22944\n87316   89489\n19976   37593\n38865   11649\n45078   24406\n36358   55213\n45579   35021\n99402   73275\n40782   20276\n48389   34465\n61983   65432\n46549   71333\n60731   50364\n28239   82886\n37245   84331\n89695   72707\n45702   35310\n46936   95846\n31661   65432\n63867   34661\n22578   46504\n35924   99928\n97445   95928\n60411   48389\n36833   68881\n10278   50364\n39206   34776\n95474   94852\n15159   45432\n90288   95481\n77881   30096\n56304   62251\n49910   81451\n13678   21322\n42650   94971\n75244   74862\n77750   74920\n54566   50186\n92641   49575\n23566   81405\n39983   70620\n82218   31880\n95885   58807\n97444   40125\n86195   35943\n34776   68881\n20384   76109\n91857   44727\n59888   33738\n47992   61640\n50291   53340\n59747   40258\n98077   68881\n11930   29301\n52116   44318\n96256   77071\n75365   39021\n14830   29417\n34876   92947\n48613   17514\n43229   85569\n15955   72245\n61458   76216\n74993   61461\n97198   63897\n66233   56543\n92861   80868\n22888   50889\n11649   15227\n72510   44999\n60024   46310\n51981   78952\n30134   85280\n15153   48389\n32013   53946\n14541   27325\n54878   19856\n12630   51576\n12646   63897\n68382   76216\n40855   21322\n31477   99082\n94979   10843\n82341   87920\n35488   41259\n57823   99959\n90928   54338\n91407   51576\n81221   22944\n55919   42682\n27235   95483\n68881   73120\n21359   46598\n59534   46435\n91806   50364\n42497   15227\n57049   12517\n76929   26842\n76110   68881\n78586   39021\n51225   65432\n87650   93875\n48080   35764\n68282   80266\n23715   24411\n62383   46689\n35851   38657\n48668   35985\n57008   42062\n44396   52990\n97855   71998\n35578   28469\n22235   56010\n70948   68881\n77965   73892\n15973   14537\n35328   85469\n94454   46598\n62384   19856\n78071   20276\n88122   86158\n88105   68881\n77090   23412\n11822   55213\n31989   39118\n68039   65297\n81126   55174\n43631   32060\n11917   11649\n11974   29417\n62698   41674\n64496   28711\n33691   73796\n92195   66727\n11682   20677\n65996   79079\n92131   95846\n44640   25224\n62049   65297\n67359   34661\n63094   29497\n24813   67897\n41267   38839\n13278   56543\n71572   12828\n80808   78142\n56156   95846\n51530   89113\n75797   63897\n93988   35495\n30272   68056\n31629   16046\n17562   34661\n34072   96205\n43904   62359\n83398   49834\n28423   97195\n82852   90842\n49810   31220\n66513   50188\n27911   45688\n56971   20473\n22800   78142\n86334   41267\n93393   11649\n84601   71534\n86633   79250\n60407   78142\n85126   53116\n74638   36062\n20964   71314\n82352   36930\n83394   29417\n65297   11649\n10164   29082\n15227   76216\n95846   48389\n91167   80269\n72154   47261\n71176   19856\n75281   65297\n51576   50364\n89997   24184\n53631   65432\n24704   25224\n39021   21322\n64838   19091\n76401   48512\n13948   34578\n33099   63897\n94777   12300\n59825   51487\n96739   30997\n41555   48028\n12667   15227\n16397   51137\n74081   58852\n53928   55213\n34791   42483\n29417   27352\n87524   89512\n25224   76216\n47202   25224\n30915   34551\n79149   89897\n92898   72170\n84546   19856\n63881   22611\n65227   85280\n68664   11649\n13738   11834\n48100   20473\n31647   12357\n58285   82005\n38498   61310\n17399   29417\n53470   56543\n94488   41267\n55069   51137\n65843   12011\n86089   21427\n98998   69258\n93772   50364\n61461   21322\n32797   20276\n63534   45983\n42044   68881\n49575   49268\n89725   71824\n13151   55213\n47235   50474\n70742   41267\n69846   83201\n49984   45584\n70773   16704\n41907   58931\n80020   78319\n38557   41267\n59468   17081\n24017   20360\n83576   26453\n44100   42968\n32619   97934\n95538   95846\n10470   41259\n40765   22806\n84349   19856\n31770   75551\n63239   76216\n22175   31938\n50014   51673\n18008   84899\n98253   72600\n38935   22946\n94044   29417\n12440   63667\n71981   22652\n35876   56543\n13131   22143\n78690   34776\n27878   11370\n19659   34776\n64979   50364\n89717   30357\n71844   92010\n26402   90514\n78750   74617\n53297   22944\n49589   50364\n16296   69699\n46311   74647\n83938   50477\n73500   84604\n38665   68881\n62321   73263\n79989   10191\n81079   63922\n19186   15227\n89155   56543\n90154   27651\n36567   65164\n95351   20473\n73278   40535\n47097   19856\n62480   41267\n51246   25224\n94838   27133\n98878   22911\n73123   91366\n21914   67909\n87431   81551\n27032   15227\n15090   61123\n13350   98688\n37173   58301\n92022   11981\n66900   26049\n18381   10986\n75360   15227\n69620   79680\n18780   60264\n84878   68881\n15467   33806\n71799   58322\n47180   19679\n39054   92091\n29531   94509\n62925   70352\n99943   51998\n64891   75738\n88061   20473\n98252   59643\n12766   64598\n38349   30817\n50824   41267\n47031   97828\n82027   46701\n59404   40860\n88020   78142\n83250   72893\n37738   53309\n85272   34122\n57713   65432\n56624   78571\n10906   55213\n42778   39021\n56224   59056\n71584   44879\n42348   55213\n53434   75449\n78142   14981\n40177   28988\n54053   68881\n66277   69900\n35127   50364\n54463   21098\n21554   87868\n89672   76216\n95148   82149\n74621   76216\n40237   20473\n10257   20473\n70014   41883\n42436   41267\n59460   71093\n57487   15227\n65720   91317\n98718   92080\n88722   21322\n63630   26854\n49789   89200\n96784   20473\n30583   20473\n41407   56714\n86109   34661\n13834   44624\n19298   44781\n67868   48389\n73954   14305\n78878   48389\n99934   63566\n53524   51137\n77891   26553\n98684   68881\n28112   38511\n80455   33657\n45447   51355\n77158   75485\n16208   55213\n37619   41978\n77064   20473\n38184   80480\n57747   89791\n88771   29417\n78861   95846\n87502   11649\n31852   98307\n50648   47711\n23961   34661\n96913   79564\n"

Day1.part1(input) |> IO.inspect(label: :day1_part1)
Day1.part2(input) |> IO.inspect(label: :day1_part2)
```

```elixir
defmodule Day2 do
  import AOC

  def safu([i, j]), do: i != j && abs(j - i) < 4 && j - i || 0
  def safu([i | [j | _]=t]), do: i != j && abs(j - i) < 4 && (j - i) * safu(t) > 0 && j - i || 0

  def skip(r, i) when i == length(r), do: false
  def skip(r, i), do: safu(for {x, j} <- Enum.with_index(r), i != j, do: x) != 0 || skip(r, i + 1)

  def part1(s), do: (Enum.sum for r <- int2d(s), safu(r) != 0, do: 1)
  def part2(s), do: (Enum.sum for r <- int2d(s), skip(r, 0), do: 1)
end

input = "38 41 44 47 50 47\n75 78 79 82 85 85\n11 13 16 19 21 25\n39 40 43 44 50\n75 77 80 78 80 83 84 87\n17 20 23 21 22 23 24 22\n80 82 79 80 82 82\n50 51 49 52 56\n78 80 82 83 80 81 82 88\n43 45 48 50 52 52 55\n34 35 38 38 41 39\n51 54 57 60 62 63 63 63\n24 26 27 30 33 33 34 38\n24 25 26 26 27 28 33\n33 35 37 41 44 46\n55 58 60 63 66 70 71 70\n90 93 94 98 98\n63 64 67 69 73 77\n13 15 18 22 25 28 34\n60 63 68 70 71 74 76 79\n76 79 82 89 87\n63 66 69 71 74 76 82 82\n55 57 63 64 66 70\n63 64 67 68 74 75 82\n47 45 46 47 49\n22 21 22 24 27 26\n67 64 65 67 69 72 75 75\n24 22 24 26 28 31 35\n50 48 49 52 57\n69 67 70 71 68 69 70 71\n38 37 38 39 42 41 38\n34 32 31 32 32\n14 13 14 17 19 18 22\n76 74 77 79 80 83 81 88\n89 87 87 90 92\n86 85 87 90 90 92 93 92\n34 33 34 37 37 37\n91 88 89 92 92 96\n84 82 83 86 88 88 95\n10 8 10 14 16 18\n67 64 66 68 72 70\n31 30 32 36 38 38\n64 61 65 66 69 70 74\n61 60 61 65 68 75\n56 53 55 56 63 64\n37 34 35 36 43 44 42\n41 39 41 44 50 51 51\n36 33 34 40 42 43 45 49\n45 44 45 47 50 57 63\n84 84 85 87 90 91 92\n40 40 41 43 46 49 47\n24 24 25 28 30 30\n86 86 88 89 91 94 95 99\n28 28 30 33 35 37 38 43\n74 74 76 73 76\n85 85 86 84 82\n93 93 92 93 96 96\n70 70 73 72 76\n49 49 48 49 54\n12 12 13 15 18 18 21\n59 59 61 63 66 68 68 66\n28 28 31 31 31\n89 89 89 91 95\n24 24 26 28 28 31 32 39\n70 70 71 75 78 81 82\n45 45 48 50 54 51\n42 42 46 48 50 50\n12 12 13 17 19 21 24 28\n4 4 8 11 18\n18 18 19 24 26\n45 45 50 52 53 50\n60 60 62 65 68 74 74\n49 49 51 58 60 61 64 68\n21 21 28 29 30 36\n69 73 76 79 82\n5 9 11 14 17 18 15\n4 8 10 12 12\n62 66 68 69 73\n2 6 7 9 10 11 13 19\n54 58 55 58 59 62\n1 5 7 4 5 3\n55 59 56 58 61 64 64\n85 89 86 88 90 93 97\n79 83 82 84 89\n40 44 44 45 46\n19 23 24 24 23\n28 32 33 33 36 36\n28 32 32 35 38 42\n47 51 52 52 53 59\n29 33 35 37 41 42\n75 79 83 84 85 88 85\n41 45 49 51 54 55 55\n36 40 42 44 48 52\n16 20 23 25 29 36\n47 51 54 55 57 62 63\n87 91 93 99 96\n15 19 21 26 26\n37 41 44 49 52 55 59\n9 13 20 21 28\n16 22 23 26 29\n34 41 43 44 47 48 46\n3 10 12 13 14 14\n16 23 25 28 31 35\n18 24 26 28 29 32 37\n59 66 69 70 73 70 72\n40 45 46 49 46 49 46\n14 20 22 24 27 24 24\n75 82 83 86 84 88\n14 21 22 24 23 26 29 36\n1 7 10 10 11 13 14 16\n2 8 9 12 14 14 12\n2 9 9 12 13 14 14\n10 15 17 17 21\n54 59 60 60 65\n70 77 79 83 84\n21 28 32 35 36 38 37\n26 33 34 38 41 42 43 43\n4 11 12 16 17 18 21 25\n25 32 33 35 38 42 45 50\n19 26 28 29 34 37 40 43\n39 46 51 53 56 57 55\n1 8 13 15 15\n55 62 65 66 71 72 76\n42 49 56 57 58 59 61 68\n78 76 75 74 76\n30 29 27 26 24 23 21 21\n16 13 11 10 7 3\n41 40 38 37 34 32 31 25\n49 46 48 47 44 41\n71 69 71 69 71\n6 3 5 2 2\n94 91 88 86 83 84 82 78\n35 33 30 33 30 25\n43 40 38 38 36 35 33\n34 32 30 29 28 28 27 29\n61 58 58 55 54 52 52\n79 77 76 76 73 69\n81 79 76 73 73 71 66\n20 19 17 13 10\n94 92 89 88 86 83 79 81\n55 54 51 47 47\n27 26 24 21 17 15 11\n20 19 18 14 13 10 4\n50 49 48 47 45 39 36 34\n82 80 74 71 74\n93 92 89 88 83 81 81\n98 95 89 88 85 81\n28 25 23 20 18 11 9 2\n6 7 4 2 1\n52 53 51 49 50\n7 9 8 7 6 5 4 4\n89 90 88 86 83 81 77\n29 32 31 29 28 21\n68 70 72 69 68 65 64 61\n85 87 86 85 87 89\n46 49 48 49 49\n83 84 82 83 79\n32 35 33 35 28\n14 17 16 16 14\n46 47 47 44 47\n15 18 16 13 13 13\n11 13 12 12 11 8 4\n92 93 92 92 89 82\n39 41 38 37 33 31\n12 13 12 8 6 5 3 4\n70 73 70 67 66 62 59 59\n17 18 17 16 15 13 9 5\n39 42 38 35 32 29 27 22\n54 57 54 49 47\n51 54 52 50 45 48\n24 25 24 17 16 16\n32 34 27 25 21\n38 39 37 32 27\n14 14 11 10 7 5 2\n87 87 86 85 82 81 82\n50 50 47 44 43 43\n78 78 76 73 69\n21 21 20 17 16 13 12 6\n53 53 56 53 51 49 48 45\n92 92 95 93 91 89 87 88\n6 6 7 5 3 1 1\n98 98 96 98 95 93 92 88\n15 15 17 14 13 12 9 3\n38 38 38 35 34 33 31\n42 42 40 39 39 36 38\n32 32 31 28 28 27 27\n9 9 9 8 5 1\n49 49 47 44 42 41 41 35\n49 49 48 47 43 40\n61 61 58 56 52 49 46 49\n87 87 83 80 80\n91 91 89 85 84 80\n27 27 26 22 17\n91 91 90 89 82 81 78\n50 50 48 45 38 39\n12 12 6 3 1 1\n84 84 82 81 74 72 70 66\n50 50 47 45 43 38 37 31\n82 78 77 74 71\n94 90 89 86 89\n16 12 10 7 7\n85 81 80 77 73\n86 82 79 76 69\n90 86 85 86 83 82\n46 42 39 36 38 41\n16 12 15 13 10 7 4 4\n38 34 37 35 33 31 27\n53 49 47 44 46 45 38\n58 54 54 53 50\n69 65 63 61 58 58 57 58\n28 24 23 22 21 21 21\n32 28 28 25 22 18\n19 15 13 13 10 4\n63 59 56 52 49 47 46 45\n32 28 25 21 19 17 15 18\n62 58 57 56 52 52\n93 89 88 87 83 79\n94 90 87 83 76\n72 68 65 60 58 55\n44 40 37 30 32\n69 65 64 63 61 58 51 51\n82 78 76 70 69 66 62\n62 58 52 51 45\n90 85 82 81 79 78 75 72\n76 69 67 66 69\n68 63 61 60 58 56 56\n72 65 62 60 56\n81 74 73 71 68 65 58\n69 63 60 63 62 60\n69 62 61 60 58 57 60 61\n57 51 53 51 50 49 49\n26 20 18 21 19 15\n44 39 36 37 30\n48 41 41 39 37\n29 24 24 22 23\n38 31 28 28 27 27\n97 92 90 90 88 84\n53 46 45 42 42 35\n72 67 64 60 58 55 53\n69 64 63 62 60 57 53 56\n32 25 22 18 16 16\n24 17 13 12 8\n31 24 21 19 15 9\n41 36 29 27 24 21 20 18\n22 15 10 7 5 7\n56 51 50 48 42 39 38 38\n59 52 49 43 39\n89 82 81 78 72 69 64\n8 10 11 12 14 15 16 13\n18 20 21 22 24 26 26\n36 37 39 42 45 48 50 54\n15 16 18 20 21 28\n10 13 10 11 13\n87 90 93 96 98 99 97 94\n96 97 98 96 96\n6 7 4 5 8 12\n53 55 53 55 60\n26 27 29 30 30 32 33\n43 44 44 47 46\n31 33 35 35 38 41 44 44\n13 16 17 19 19 21 22 26\n29 31 31 34 35 37 40 45\n83 84 86 87 91 93 96\n78 80 83 84 88 86\n1 2 3 5 9 11 11\n3 4 8 9 10 14\n66 69 73 75 80\n15 18 19 21 28 29 31\n74 76 79 84 86 89 87\n17 19 22 24 31 31\n13 14 15 18 23 25 27 31\n26 27 29 34 37 44\n38 35 38 39 40 41 42\n78 76 78 79 81 80\n8 6 7 8 9 10 10\n56 55 56 59 62 63 65 69\n43 40 42 45 47 48 53\n88 86 85 88 90\n75 74 77 75 76 77 80 77\n7 6 9 6 8 8\n54 52 53 52 53 54 58\n32 29 30 33 32 37\n66 63 64 65 65 66\n85 82 82 83 82\n71 69 69 70 71 71\n82 80 83 86 88 88 92\n92 89 89 90 93 94 99\n72 70 72 73 75 79 80\n51 48 49 50 54 55 58 57\n72 70 73 75 79 80 80\n71 68 71 72 76 80\n49 48 52 55 56 59 65\n42 40 41 44 49 50\n65 63 69 70 71 70\n46 44 45 48 49 54 55 55\n20 18 20 23 30 32 36\n29 27 30 37 40 45\n86 86 88 90 92\n79 79 80 83 86 89 92 89\n73 73 76 79 81 83 83\n61 61 62 63 65 67 71\n87 87 90 91 98\n48 48 51 50 53 56\n54 54 53 54 52\n92 92 91 92 95 95\n31 31 33 36 37 34 35 39\n55 55 52 53 58\n82 82 83 84 86 86 87 89\n20 20 20 21 20\n27 27 30 30 31 31\n22 22 23 23 24 27 28 32\n82 82 84 85 85 87 93\n41 41 45 46 49 50\n61 61 65 67 69 68\n54 54 58 61 64 64\n48 48 52 55 59\n16 16 17 21 26\n18 18 21 24 29 30 32 33\n26 26 29 35 32\n15 15 18 21 24 25 32 32\n63 63 65 71 73 77\n36 36 39 42 45 46 53 60\n40 44 45 47 50 52\n3 7 9 11 12 15 12\n39 43 45 48 49 50 53 53\n1 5 6 9 10 14\n81 85 88 90 91 92 99\n25 29 31 34 32 35\n71 75 77 76 73\n38 42 39 40 42 44 44\n1 5 8 10 9 10 14\n80 84 85 84 86 92\n72 76 78 81 81 84 85\n85 89 92 92 93 95 94\n89 93 93 94 94\n8 12 13 14 15 16 16 20\n57 61 63 66 66 72\n82 86 89 90 93 97 98 99\n4 8 10 14 15 13\n4 8 9 11 15 15\n26 30 33 36 37 41 45\n10 14 16 20 22 29\n3 7 12 15 18\n72 76 78 79 82 87 90 89\n71 75 77 82 82\n71 75 82 84 88\n15 19 26 29 34\n66 72 74 76 78 81\n13 19 22 23 20\n43 50 53 56 58 58\n67 72 73 76 78 82\n67 73 75 77 80 83 84 89\n71 78 77 80 83\n23 30 32 33 32 31\n31 36 39 36 36\n35 41 43 46 45 48 52\n36 43 40 42 48\n49 54 55 57 57 60 63 64\n42 49 52 52 49\n65 70 73 73 75 77 80 80\n61 66 66 69 70 71 73 77\n32 38 38 40 47\n65 72 74 75 77 81 84\n42 48 49 51 55 53\n47 54 56 57 61 62 62\n7 14 16 20 21 22 26\n45 50 52 55 59 62 64 71\n37 44 49 52 53\n27 32 38 40 42 45 46 45\n47 52 58 59 61 61\n1 6 7 12 13 14 17 21\n40 47 53 55 56 63\n74 73 72 70 68 66 63 66\n11 9 7 5 3 3\n38 35 33 31 29 25\n66 64 62 61 60 59 56 49\n20 17 16 17 14 12 11 10\n88 87 88 85 82 81 80 83\n40 37 40 38 37 34 33 33\n13 11 13 11 8 7 3\n64 61 60 63 62 55\n28 26 26 23 22 19\n13 10 7 6 6 7\n53 50 49 49 47 45 45\n71 68 66 65 65 62 60 56\n80 77 75 73 72 72 69 62\n39 37 34 30 29 27\n40 38 37 33 34\n39 37 33 31 29 26 24 24\n60 57 53 51 47\n26 23 19 18 11\n57 56 51 49 48 47 46 44\n75 74 67 66 63 62 61 62\n26 25 20 17 17\n30 29 27 21 19 18 14\n86 85 79 78 71\n38 39 38 35 34 31 30\n52 53 50 49 46 44 45\n92 93 92 91 90 90\n24 27 25 24 23 19\n29 32 29 28 25 24 18\n77 78 81 78 77 75\n21 22 21 19 21 22\n32 35 32 31 32 31 28 28\n81 83 84 82 80 78 74\n23 24 21 18 17 18 15 8\n20 22 21 21 18\n54 57 56 55 53 51 51 52\n11 12 10 10 10\n45 46 45 44 42 42 38\n69 70 67 65 65 64 58\n15 16 15 11 10 9 8\n37 38 34 33 31 29 27 29\n46 49 46 45 41 38 37 37\n41 43 39 37 36 32\n82 85 81 79 77 74 69\n85 87 84 82 81 76 73 71\n75 78 73 70 73\n43 45 38 36 35 33 33\n62 65 59 58 55 51\n31 34 32 27 24 17\n11 11 8 7 4 1\n94 94 93 91 90 87 86 87\n26 26 23 20 19 17 17\n12 12 10 9 7 3\n79 79 78 76 75 69\n16 16 17 16 13\n38 38 35 34 37 36 33 35\n37 37 36 37 36 34 32 32\n48 48 47 50 48 45 41\n53 53 52 49 51 49 42\n78 78 78 76 75\n91 91 90 87 85 85 82 85\n58 58 56 54 51 51 51\n29 29 27 27 26 25 23 19\n71 71 71 70 69 64\n17 17 14 11 7 4 3 1\n21 21 19 15 17\n28 28 26 22 22\n51 51 50 46 42\n26 26 25 21 20 17 11\n72 72 70 65 63 61 58 56\n84 84 78 77 80\n40 40 39 36 31 29 28 28\n22 22 21 18 13 11 10 6\n63 63 61 56 54 47\n91 87 84 81 78 77\n97 93 91 89 86 85 84 87\n19 15 14 13 13\n20 16 13 12 10 6\n96 92 90 88 86 83 76\n97 93 95 94 92 89\n47 43 41 38 36 38 40\n85 81 84 81 79 76 76\n80 76 77 75 71\n32 28 26 29 27 24 23 18\n30 26 24 24 21 19 18 17\n22 18 16 16 18\n77 73 71 71 69 68 67 67\n41 37 36 34 31 31 28 24\n97 93 91 88 85 85 79\n47 43 39 36 34\n29 25 23 21 17 19\n55 51 48 47 43 43\n91 87 86 83 79 78 74\n54 50 46 45 40\n42 38 37 32 31\n40 36 30 29 28 25 24 27\n55 51 44 43 40 37 37\n45 41 36 33 29\n74 70 63 61 54\n38 31 29 26 24 23\n55 50 47 44 41 39 40\n64 57 56 54 53 50 50\n26 20 19 17 13\n86 79 76 73 67\n21 15 12 9 6 3 6 3\n90 85 83 80 82 84\n59 52 54 51 51\n41 35 37 34 31 28 24\n48 42 40 38 35 34 36 31\n40 35 34 34 32\n69 62 62 59 61\n79 73 71 68 67 67 65 65\n57 52 49 48 48 47 45 41\n37 30 29 29 27 26 19\n45 38 35 31 28\n80 74 70 68 66 64 61 62\n91 84 80 78 76 76\n22 16 13 11 7 3\n34 29 25 24 22 15\n87 82 76 73 72\n29 22 19 13 10 13\n86 79 73 72 72\n71 66 65 63 56 55 51\n37 32 25 22 19 18 11\n87 87 86 85 78 76 76\n7 11 13 15 18\n47 46 48 50 51 56 58 63\n35 35 36 35 33 30 32\n38 34 32 25 24 26\n46 41 38 35 32 32\n19 19 15 13 12 5\n22 18 17 16 13 10 9 5\n65 69 72 77 78\n23 22 25 25 24\n3 2 4 5 12 15\n21 21 20 13 11\n45 45 44 43 42 40 38 41\n66 64 63 62 64 64\n39 32 31 27 20\n23 20 18 18 15 12 9 5\n44 41 42 45 48 49 52 56\n10 14 17 18 16\n86 81 75 74 68\n77 76 73 70 69 69\n25 23 26 32 30\n16 20 23 21 24 28\n80 80 83 85 85 82\n21 21 18 20 21 24 26\n26 29 28 26 21\n9 15 17 19 20 21 23 28\n57 58 61 63 65 69 70 75\n72 75 78 81 86 88 90 91\n66 68 69 74 79\n16 15 15 16 17 24\n60 66 67 66 69 76\n46 42 43 42 41 39 34\n31 31 34 34 34\n18 18 14 13 11 7\n1 1 4 5 6 8 15\n43 47 49 55 59\n11 11 14 17 16\n31 34 32 30 29 28 29\n99 99 97 97 95 98\n66 68 72 74 78\n6 13 15 16 19 19 20 21\n91 92 91 91 89 90\n33 39 42 46 52\n51 50 51 52 52\n41 38 40 43 47 48 52\n40 36 34 32 32 29 29\n35 34 37 39 43 44 47\n89 87 86 83 81 79 78 71\n33 29 26 21 20 15\n70 72 73 74 77 77 78 78\n86 87 85 87 89 92 95\n56 59 58 56 55 55 52 52\n8 8 10 11 12 11 17\n29 30 27 26 23 22 20 20\n47 53 55 56 57 59 56 56\n8 8 10 11 15 19\n15 15 16 21 24 27 28 25\n55 52 55 58 65 67 67\n74 68 65 64 62 60 58 52\n30 34 36 35 37\n64 60 59 57 54 53 52 47\n34 36 38 36 39 42 46\n36 30 30 29 26 25 22 22\n95 96 98 96 95\n49 47 44 41 37\n8 14 15 15 18 19 16\n40 42 40 40 33\n50 48 51 51 51\n18 17 20 23 26 26 27 31\n87 91 92 93 93 97\n50 53 56 60 62 64\n71 75 79 81 81\n74 76 70 68 63\n27 22 19 21 20 20\n67 63 62 58 56 54 52 48\n83 85 88 91 92 93 96 96\n67 74 76 74 75 78 80 78\n60 60 57 53 53\n16 15 14 17 20 22 25 29\n66 69 66 66 62\n65 69 72 75 74 74\n52 45 42 40 43\n17 17 20 23 26 31 35\n35 40 42 44 45 44\n80 79 80 82 83 83 84\n25 24 20 17 16 13 8\n88 81 80 77 73 75\n70 69 69 67 61\n9 14 15 21 22 19\n40 40 43 44 45 46 49 52\n78 73 72 70 71 68\n14 20 23 25 31 37\n16 22 23 24 26 25 26\n32 28 26 24 24\n24 21 24 27 28 32 38\n47 48 47 45 41\n45 49 53 54 57 63\n37 40 42 44 45 47 50 55\n42 42 39 42 44 47 47\n45 41 42 41 39 38 35 31\n13 9 7 6 2 2\n63 63 60 59 58 55 54\n44 41 40 38 37 32 28\n33 28 24 23 20 19 19\n27 21 18 18 17 16 15 16\n11 14 13 14 19\n87 83 80 77 70 68 65 65\n15 13 11 8 10\n35 39 40 39 41 39\n46 50 50 53 56 63\n76 79 77 70 68\n63 65 69 72 74 77 75\n30 34 36 38 41 42 46\n20 16 15 12 10 8 5 3\n41 45 45 48 45\n27 33 33 34 38\n78 83 84 90 92 96\n28 29 28 25 22 19 15 15\n81 83 83 80 78 75\n74 69 66 65 62 61 58 54\n89 83 81 79 78 77 77 74\n58 58 56 57 60 61 62 66\n9 12 14 17 19 22 25 24\n14 14 11 9 8 6 7 3\n22 22 20 17 19 14\n43 43 44 51 53 55 62\n75 75 74 73 73 70\n61 61 64 66 66 70\n38 35 35 33 31 29 32\n41 41 39 37 36 33 31 24\n73 70 72 69 76\n91 91 90 89 88 84\n12 16 20 23 25 27 30 34\n84 86 87 89 90 93\n94 92 89 86 85 84 83 82\n49 46 45 44 41\n21 19 17 16 14 12 10\n23 24 25 28 30 31 34 36\n15 12 10 8 6\n67 70 71 72 75 77\n27 26 24 23 20 17 14\n74 75 76 79 81 84 85 88\n35 34 31 29 26 24 23\n9 8 7 4 2\n17 16 13 10 8 6 4 3\n45 47 50 52 54 56 58\n28 29 30 31 32 35 38 40\n69 68 66 64 63 62 60\n43 44 47 48 51 52\n21 24 26 28 29\n29 27 25 22 19 18 16\n86 83 82 80 77 76 73 71\n23 21 20 17 16 15 12 10\n7 8 9 12 15 17 20\n26 28 30 33 36 38\n29 28 25 24 21 19 17\n86 84 83 81 78 77 74\n5 8 11 13 16 18\n70 71 72 73 76 77\n28 31 32 33 35 37\n27 25 24 22 19\n36 35 34 31 30 29\n30 28 25 22 20 18 15 13\n27 30 31 33 34 35 36\n15 17 18 21 23 24\n23 26 28 29 31\n76 79 82 83 86 87 90 91\n32 31 28 25 23\n3 4 5 8 9 10 13 16\n8 11 13 15 17\n58 56 55 54 52 51 48\n41 44 45 47 50 52 54 57\n66 65 64 62 60 59 57\n69 66 63 60 58 55\n27 30 31 33 34 35 36 39\n43 40 39 38 36 35\n42 41 39 36 33\n77 79 82 85 88 89 91\n14 13 12 9 6 4 3 2\n47 49 52 55 56\n88 91 92 93 96 97 99\n99 97 96 93 91 90\n74 77 79 82 85 88 90\n1 4 5 7 10 11\n16 18 21 24 26 28 30\n99 96 93 90 89\n70 69 66 64 63 60 58 57\n77 75 72 69 67 64\n30 27 25 23 21 18\n87 84 83 81 79 77\n20 21 24 27 29\n29 26 23 21 20 17 16 14\n43 41 40 39 38 36 35\n61 64 66 68 70 73 74 75\n39 41 42 43 44 46 49\n17 20 23 25 28 29 30 31\n37 40 43 45 48 49 51 54\n49 52 54 57 58\n15 18 21 24 27 30\n20 18 16 15 14\n86 85 82 81 80 77\n62 61 60 58 56 54 53 52\n16 13 10 9 6 4 3 2\n14 13 11 9 8 7 6 5\n55 56 57 59 62 63 66\n59 61 64 66 67 69 72 75\n14 17 19 21 22\n52 49 47 46 43\n80 82 84 85 88\n18 15 13 11 10\n86 83 80 79 78 75 74\n50 49 46 44 42 41\n46 48 50 52 54 55 58\n64 61 59 57 55 52\n10 11 14 17 19 20\n86 85 83 80 78 77 74\n57 55 54 53 50 49\n72 70 69 68 67 64 63 60\n60 59 56 55 53 52\n46 48 51 54 55 58 61\n24 23 22 20 17 15 12\n71 74 76 78 80 81 84\n30 33 34 35 37 39 40 43\n67 68 70 73 75 78 80 81\n53 51 49 46 43 42\n46 47 48 49 50 52\n16 17 18 20 23 25 27 28\n74 72 71 69 66 65 64 63\n98 97 94 91 88 87 85\n49 48 47 45 44 42 41 38\n83 84 85 87 88 89 90\n41 44 46 48 50 51 52 53\n56 58 59 62 65 67 70\n33 32 31 28 27 25\n57 58 61 64 66 69\n60 59 56 53 50 47\n69 70 72 73 75 78\n39 42 44 47 48\n57 60 61 62 63 66 68 69\n2 3 5 7 9 10\n66 67 68 69 70 71 72\n9 8 7 4 1\n86 84 81 79 76 73 72\n56 55 54 52 50\n35 38 41 42 45 46\n41 39 38 35 34 31\n85 82 79 76 73 71 69\n10 13 14 15 16 19 22\n31 28 26 24 22 19\n89 88 86 83 82 81 80\n50 47 46 44 43 42 39 38\n64 63 60 59 56 54 51 49\n43 41 40 39 37 35 33\n64 61 58 57 54 52 50\n41 44 45 47 49\n89 90 93 94 96\n39 36 33 30 27 25\n30 28 27 25 24\n83 84 86 88 89 92 95\n42 41 38 35 32\n30 29 27 26 23 22 21 20\n8 10 11 12 15\n59 56 54 52 51\n64 63 61 59 56 54 53 52\n68 69 70 73 75 76 79\n62 64 66 68 70 73 75\n33 35 36 37 39 41\n49 52 55 56 59 61\n46 48 51 53 54 57 60 61\n24 26 29 31 33 34 35\n41 39 36 35 34 33 30\n98 96 93 90 87 86 84\n31 29 28 27 25 22 21\n28 31 32 34 35 36 39\n76 77 80 82 84 86\n10 12 15 17 18 19 22\n75 76 79 81 83\n44 43 41 40 38 35 32 31\n63 65 67 70 73 75 77 78\n69 66 63 62 60\n17 20 22 24 26 27\n90 87 85 82 81 78\n95 94 93 90 87 85 83 80\n18 21 23 24 26\n43 41 40 38 37 35 33 32\n70 71 72 74 75 78 79 80\n32 30 27 25 23 21\n55 57 59 62 64 67 69\n52 53 54 56 59 61 62 65\n29 27 24 21 20\n41 42 44 45 46 47\n67 69 70 73 76\n24 22 21 20 17 14 13\n73 72 69 67 65 63 61\n19 20 22 23 24 25 28 29\n37 36 35 34 31 30 29 27\n42 43 44 46 49\n79 82 85 88 90\n27 25 22 20 18\n47 49 52 55 57\n68 66 64 62 59 56\n89 87 84 82 80\n93 91 90 87 86\n31 28 26 25 22\n12 9 7 4 2\n27 26 24 22 21\n71 74 76 79 81 82\n24 23 20 17 14 11 10\n58 55 52 49 48\n97 94 92 89 87 86 85 82\n91 88 87 85 83 82\n63 60 57 56 53 52 51 49\n63 66 68 70 73 76\n22 20 19 18 15 13\n65 63 62 61 60 59\n97 95 94 91 88 85\n13 15 18 20 21 23\n66 67 70 71 74 77\n61 60 58 56 53 52 49\n17 15 12 11 10 7 6 3\n86 87 88 89 91 92\n78 80 83 86 89 91 92 94\n66 65 63 62 61 59 58\n84 86 88 89 92\n80 83 86 87 88\n69 68 65 62 60 59 56 53\n57 59 62 65 68 69 72 73\n11 14 15 16 18 21 22\n20 21 23 26 29 31 33\n26 25 24 22 20 18\n25 28 29 32 34\n63 62 61 60 59 57 56\n69 72 75 77 80 82 83 86\n59 56 53 50 48 45 42\n30 33 34 36 37 40\n51 48 45 42 41\n79 81 83 85 87 89 90 93\n59 61 63 64 66 69 70 72\n44 45 46 49 51 54 57 59\n40 41 42 43 46 48 51\n10 13 15 17 20 21 23 25\n11 9 6 5 4 3\n88 90 91 93 94 97\n94 93 90 87 84 83 80 78\n72 74 76 79 82 83 86\n91 90 89 88 87 86\n24 27 30 33 35 37 38 41\n54 53 50 48 45 43 40\n75 74 72 70 68 66 63\n86 85 83 80 78 75\n72 73 76 77 78 79 82\n81 79 78 77 76 74 71 69\n11 14 16 19 21\n83 80 77 74 71 70\n75 77 79 82 85 87 89 91\n38 40 41 44 47 49\n37 39 40 43 46 48 51\n26 25 22 21 19 16\n28 25 24 22 19 17 15 14\n99 96 93 91 88 87 86\n68 67 66 65 62 60 58\n36 38 41 43 46\n69 71 74 76 78 80 83 85\n37 34 31 28 27 26\n70 73 76 77 78 80 81 83\n65 64 61 59 57 54 52\n13 10 9 6 4\n85 88 91 93 94\n77 78 80 83 86 87 90 93\n36 37 38 39 42 45 46 47\n66 69 70 73 76 79 80\n81 80 77 75 74 71 69\n56 53 50 47 45 42 40\n75 72 70 67 65 64 61 59\n35 33 30 28 26 24 21\n13 14 16 17 18 20 23 25\n30 31 32 33 36 39\n40 37 35 34 32 29 26 25\n19 17 16 14 13 12 11 9\n54 53 50 47 44\n65 64 62 60 57 54\n37 35 32 29 27\n28 29 32 35 38 40 43 46\n87 90 92 93 95 97\n9 10 13 16 17 18 20\n60 57 55 54 53 52 50 47\n74 73 71 69 66\n62 63 66 69 70 71\n37 39 42 43 44 46 48\n15 18 19 20 22\n62 59 58 56 55 54 52 50\n29 26 25 23 20 19\n62 63 66 67 68 70\n97 96 94 93 92 91 88\n42 40 37 35 34\n65 63 60 57 56 54 51\n39 38 37 36 35 33\n45 42 39 36 34 33\n37 35 33 30 28 25 24 22\n20 19 16 15 12 9\n41 38 35 34 33 31 30 29\n69 67 65 63 62 59\n77 75 73 71 70 68 65 63\n3 5 8 10 13 16 18\n21 23 25 27 30 33 35\n67 66 64 62 60\n95 92 90 87 84\n66 63 60 57 56 53 50 49\n47 46 44 41 40\n39 42 43 44 47\n57 56 53 51 48 47\n23 24 25 26 28 30 31\n78 79 80 81 83 86 87\n13 16 18 20 21 24\n90 88 86 83 82 80 78 77\n82 80 79 77 76 73 71 68\n64 65 67 69 71\n64 66 68 69 71 73 74\n25 27 28 31 32 35 36 39\n54 55 57 58 59\n58 55 52 49 46\n18 15 12 9 8 5 3\n13 15 17 19 22 25 26 28\n77 79 82 85 88\n59 61 63 66 69\n15 12 11 8 7 6\n60 63 65 67 70 71 74\n75 74 71 68 67 65 63\n39 40 43 46 48\n67 70 73 75 76 78 81\n73 70 67 64 61\n22 24 25 28 31\n62 64 67 69 71 73\n44 41 40 37 36 33 32 31\n50 47 45 43 41 39 37 34\n36 38 40 41 42\n93 92 90 87 86 84 83 82\n17 14 11 10 8\n90 87 86 84 81\n56 57 60 63 64 66 67 69\n38 36 33 32 31\n67 64 63 60 57 54 52 51\n76 77 79 81 83\n82 83 86 87 88\n39 40 43 45 46 49 52\n67 68 71 73 75 76 78 81\n25 24 21 18 17 16 15 13\n89 86 83 80 78 77 75 72\n20 21 23 25 27 28 29\n1 4 6 9 12 15 18 19\n51 52 53 54 55 56 57\n71 70 68 67 65 62 61\n29 26 24 21 18 17 15\n55 53 52 50 49 48 46 45\n24 27 28 29 32 33 34 37\n61 64 65 66 67 68\n82 80 77 75 74\n71 68 66 63 61 58 56 54\n27 28 30 31 33 35 38 41\n12 13 16 19 21 24 26\n46 49 51 54 55 58 59 61\n63 62 60 57 54\n78 75 74 71 69 66 64\n84 82 80 77 75 72\n75 72 70 68 67\n52 54 57 59 61 64\n42 45 47 49 50 53\n80 83 85 86 88 91 93 94\n29 32 33 36 38\n4 5 7 8 9\n37 36 35 33 31 29\n58 59 62 63 65 67\n60 58 56 55 53\n76 79 81 82 84 86 87\n87 89 90 92 93 95 96\n59 61 64 65 68\n63 65 68 69 71 74\n81 83 86 89 90 91 94 95\n54 53 51 50 49 47 44\n78 81 83 86 89 92\n64 65 68 69 70\n30 28 25 22 21 18 17\n36 34 33 32 30\n31 30 27 24 23 22 21 18\n62 64 65 66 69 72\n9 6 5 3 1\n6 8 11 13 14\n51 49 48 47 45 43 41\n76 75 74 71 68 65 63 61\n83 85 88 91 92 93\n51 49 47 45 44 43\n69 66 64 62 60 58\n6 7 9 10 12 13 16 19\n45 44 43 42 41\n56 58 60 63 64 67 68\n71 73 76 78 81 83 84 86\n83 82 81 78 75 72 70 67\n51 50 48 45 42 39 37\n88 86 85 82 79\n51 48 46 43 42 40 39 38\n34 36 39 42 45 48 50 53\n27 24 22 21 19 17 16\n66 63 61 60 58 57 54 53\n83 84 87 90 91 94 96 98\n"

Day2.part1(input) |> IO.inspect(label: :day2_part1)
Day2.part2(input) |> IO.inspect(label: :day2_part2)

```

```elixir
defmodule Day3 do
  import AOC, only: [int: 1]

  def sim([], acc, _), do: acc
  def sim([[s] | rest], acc, _), do: sim(rest, acc, s =~ "n" && 0 || 1)
  def sim([[_, x, y] | rest], acc, w), do: sim(rest, acc + w * int(x) * int(y), w)

  def part1(s), do: sim(Regex.scan(~r/mul\((\d+),(\d+)\)/, s), 0, 1)
  def part2(s), do: sim(Regex.scan(~r/mul\((\d+),(\d+)\)|do\(\)|don't\(\)/, s), 0, 1)
end

input = "@~don't()mul(683,461) >,~select()what()};<mul(848,589)!\#{$$:,#mul(597,936)]!how();)+mul(944,148)who()mul(84,922)what()(mul(95,23)[;]*mul(186,673)$@+,;mul(662,571),^^&&mul(467,635)]>what()*,why()mul(456,228)%/'where()~{mul(508,422)mul(78,184)&why()/(mul(373,546)why()*</mul(840,607)(:how(428,64)>why():-~{@mul(615,760)}?/*>$mul(422,670)},?#''how()@#mul(597,259)??mul(281,991)when()why()]/;}:who()why()/mul(864,121)how()\#{[from()&mul(336,536) what()/what()#:>mul(908,667)[%^>&]select()*(mul(716,31)what()[+~what())]where():mul(131,416)what()from()]^when()$mul(808,465)from(747,493)*@;mul(728,405)@mul(528,186)where(830,813) mul(138,404)&&$,,mul(220,842)(from()*~from()how()where()mul(44,647)~where()}%$+mul(523,78)}mul(506,925)where()) ?mul(650,260)what()))when()mul(992,831)*]?-(mul(382,514)<?mul(338,811)~who()<)mul(510,851)[mul(362,413)^why()how()mul(456,506)why())},)*where(294,226)do()<when()>@<>,{*<mul(695,394)from(){/~mul(192,894);how()where()what()who()!:mul(932,681)@select()(where()@{?^+mul(260,501)from()+select()?^mul(445,400)@:;>^/why()[don't()#>how(558,115)mul(303,593)${~from()%*$%do()-+[$mul(406,365)how()mul(561,819)how():select()[:when()mul(283,930)where()$>why():<from(){who()^mul(5,405);%#what()[(*>#mul(154,725)from(496,796))@[how()from()- mul(942,491)-don't()~who()^)#select()where()mul(880,650)>(when(),)who()]where()mul(735,764)<-select()where()~#mul(685,917)from()!how()&who(),~why()[/mul(838,662) }what()from()from()<mul(25,821)]$+?)[>[mul(217,645)who(){who()mul(712,250)*}~who(133,126)where()}what()-where()mul(879,905)mul(95,8)~{?%:/mul(885,299)mul(509,215)~mul(97,351)mul(11,228)mul(976,139)where()mul(532,340)mul(535,236)</@)+mul(91,686)^+)(/}where()why()(<mul#-+!%(mul(23,448)!{:}#,mul(761,358)select()<mul(557,974)<({select()& why()]'mul(940,978)from()*why(871,616)$[mul#mul(652,248)what(455,217)-$<)'!{who(),mul(530,568))<;[}^do(){where()#&$};,}mul(903,867);-#**[/~mul(698,27),~mul(701,325)where()#who()>)'mul(544,423)@@ mul(543,903)why()mul(610,22)where()when()^)mul(529,383) ;,/'when(179,924)mul(31,223)when());<mul(812,214)mul(375,504)]:(~& !who()[~mul(192,595){~[{what()who()'from()mul(127,309)who()mul(555,543)%/%!~select(),?[from()mul(832,869)mul(808,878){[@mul(301,808)?>*from()mul(810,928) ^'{'?~mul(840,456)?where()}~:who()'do()@where(){(@$select(471,179)mul(490,95)where()?>)<mul(355,525)from(971,891)+select(){mul(247,601))%how()[;~select()mul(960,14)? #}/~from()why()%from()mul(507,980+from()#@@mul(50,394)how(751,319)who()?~what()'when()$}-mul(791,444)))!#/>^$mul(192,331)?when()where()!}who()*%[%mul(778,800)+}when()who()how()mul(836,264)from()+)@where()mul(261,535)&)@why()-#/(mul(187,2)(?what()mul(467,281)when()where()#, [+what()select()(mul(232,619)don't()^mul(406,760)mul(400,865)%%who()where()}${?[!don't()#%@^/)when()]@%mul(268,776){-:how()}:'~+mul(817,838)}when()when()#/where()?how()+mul(712,30)select()(%* !mul(11,366)\n select(463,746)]mul(475,757)where()$ }~)<mul(467,155)<how()why();&mul(656,291-{>}'mul(201,678)what()when()]',who()how()mul(228,56)^'what()from()@$,+{[mul(725,736)mul(96,310)*:<>how()from()<when()mul(729,298)']~when()*mul(376,300){select()mul(385,844) %/[-'mul(831,34)<mul(397,823)#,,~mul(594,367)how()-)why()when(30,465)^why()^mul(273,629)@^?]!]mul(545,532)select()where()+where()<;^mul(321,301)!~~why()mul(98,108)[why()){$)mul(857,959)don't()when()^mul(417,755)/who();don't()how()?how()%@mul(274,441)~mul(562,453)<;}-from()@;$how()}mul(186,62*+[@'^%mul(995,463)?!!select(883,304)/^;{-#mul(964,420)@?%select()when()mul(89,676)(^;~<'@!mul(280,290)[?when();#}~{from() mul(5<(when()when())]+<where()mul(603,617)[mul(959,445)&<(#(where()!from()]mul(493,785)^-*/when()mul(268,895)-?:(~mul(379,592{~! [?-mul(822,591)from(295,31)<- *)(mul(757,754),)!who()where(),mul(386,923)@$what()[from()mul(984#what():&who(543,949)mul(514,887)!@when())from() :,%!mul(26,604)why()why()#when()from()mul(664,312){&do()mul(988,752):' ^:where()>&{>mul(533,345)>where()>%when()mul(816,202)#what()]+/}%when()<]don't():*%;mul(368,570)~from(251,737):^ ;select(589,302);~mul(780/what()/{&when()mul(780,721))';+>mul(191,651)#}why()!when())mul(321,579)%~ what();/!who()mul(707,979)!select()when():+<& do();>what()}what(318,824)mul(755,111)%/(?*}#how(431,277)mul(85,134)mul(280~<$:who()when()where(174,374)mul(113,173)>don't()^(who()(mul(765,356)!/$? select()-%+?mul(991,23)?why(270,631)when()!:)/&mul(782,296)(~['+*?don't()@)+?mul(553,968)how()what()%where()<when()!mul(44,677)how()select()'how()*,select()(-mul(247,522))when(),'mul(459,682)/why()&]' mul(917,91)]how(51,797),/@?who()when()[}do()*+!(mul(752,850)}%mul(750,273):#)'?why()@?mul(974,149)?what()>]where()&&mul(621,835)when()/:what()@,@where()>mul(317,451)~why()+where(),))mul(364,198)+what()}*[mul(883,802)]/'where()mul(387,43 where()~?;)@@what()how()mul(322,326)who()<mul(30,534),}%!{how()!%what()mul(610,849)who()]why()-mul@-}!)mul(108,806);:{/% mul(486,125)select()[!/^!{&mul(758,458)&{,how(){@&mul(46,465)%where(845,173)do()why():'+'?-)~mul(822,408)]]#from()!?+-select()mul(905 /from()+@(!mul(327,879)(+;;>+mul(326,133)/(]%,? mul(907,688))-(select()#mul(666,327),!who()mul(895,291);&)^)[mul(658,676)@who()/+>&mul(44,325):^>why()who()$*select()mul(641,527)mul(524,670)~mul(25,367)mul(499,446) ,why()who()%mul(100,283)#when()who() how() @&mul(351,89)why(36,81)'!,select()>who()!who()/mul(52,820)/^mul(630,788)from()%<(^:}mul(420,483)mul(473,512);*}-mul(761,735)'mul(419,165)&mul(523,446))mul(834,76)!#mul(562,151):-'who(285,490)[mul(984,224)'!;mul(469,881)>**-'mul(385,297)@mul(994,97)+*%mul(281,326)@//$mul(664,734)how()select()[:@?#,do() !)%what(202,601)+how()from()mul(391,934)!%?)how()mul(825,779)how()([how()do()who()+who()#%when();mul(642,60)from()&mul(425,517):what()mul(675,402))?@/how(668,137)from()-mul(400,170)mul(808,291)<!)'[?mul(284,214)why())mul(684,417) from()who()$#[$><mul(154,319)^why()who()$@}[<-mul(542,516)when()when()^'#do()what()where()mul(986,109)from();$do()from()&:who()mul(865,597))what()~why()>{how()mul(142,403)\nmul(868,598)@from()%>&?;@mul(20,94)&?why())?mul(758,315)~&;where()'what()mul(152,875)mul(308,470)][select()$&-:>?mul(256,361)<')>&from();{why()mul(620,603):{~where();' -mul(693,340)$mul(646,441)-what()do()%!when()->mul(617,502),#,]mul(212,569)$when()])mul(635,595)~}:@*mul(292,790)}mul(933,20)@^{(mul(22,237)&'mul(103,788){}{why()who()%what()don't()(,#'(;mul]when()mul(268,616)how()mul(675,612)>**@$mul(111,445)$:!how()mul(56,5) mul(419,542)why()&@mul(214,101)]how()from()why()why();^where()mul(841,681)<when()mul(209,671)%select()%^where() :from()mul(76,245)+>)$',#%}&mul(777,293){mul(778,822)><!##why()!#mul(698,922) #!%;:how(188,944)@mul(593,401);+who()where()##mul(17,157)%)$+mul(949/}?]',mul(693,839)}}>*{{)'from(644,961)why()mul(559,996)*how()<(mul(41*!:select()%#''+what()mul(193,482)$;%([]-*mul(271,561)mul(632,842:^+/%)mul(605,351)<$}mul(80,304),!(]$/when()-when())mul(942,823)~^,,}#'mulhow()mul(558,938))+how(),mul(345,610)<what()$)how()]#mul(217,743)[ %when()when()?mul(624,634)-*&mul!&; &)mul(168,19)\#{{}>]%<(mul(550,971):,#)mul(468,45);$:how() *(>mul(354,420)/:+how()#::mul(71,315)&mul(378,96); +*what()[when()]):mul(486,242)+(@from()'-^(}mul(727how()? }^/^mul(470,146)from()'why()how()<~,+-mul(522,547)#**?+:what()who()from()>mul(793,81)$)'~what();do()]how()select(432,392)+;-[mul(997,671) where()?mul(129,744)select()why()<+mul(567,796)from(817,482)@(mul(462,463)/)<mul(678,95)&?+what()#?mul(360,496)(what();mul(728,595)mul(605,288)where()select()when()mul(563,994))&+'mul(934,978)^*when()do()mul(218,50)why()what()( %mul(905,176)do()mul(559,597)?,when(52,254)who()why(486,729)mul(732,462)$]>!why());mul(893,320)@;&)why()?why()when()who();mul(731,381)when()/:how()%mul(999,422)where()from()]select(739,491)#*;mul(435,663):mul(872,159&/&where(70,34)};where()from()mul(518,656)>[*who()<{when():don't()(mul(616,333){@/why()?what()*>mul(823,123)how()mul(113,251)from()~('mul(894,176*when()#/*]>mul(542,271)when(159,532)]:~from()mul(629,280)from(676,859)[&&!]mul(980,396)where()}*' ^!how(298,757)mul(593,718#)~do()>!{what()';what()-mul(417,931)mul(379,961)#>!}-- mul(770,269)-]~&'*mul(179,685)how()why(){;^mul(515,206)+^$#]- ;@mul(854,862)-%,mul(217,603){why()^select():where()*mul(458,549)where()!% mul(336,105)from()!};$why()%[~why()mul(701,97)mul(566,796)'/}!mul(987,970)why()/ where()?*why()mul(938,415)(#^>(mul(358,974why()>mul(127,685)]what():mul(23,486)!+[}!mul(703,30)when()'%,#mul(182,500):mul(13,248)^-[,]what())'who()mul(150,306)>/mul(353,581);%:where():mul(296,383);%why()select())][ /mul(185,486)~#mul(383,477)mul(484,779)/select()what()#%+from()]'why()mul(410,683,mul(892,307)<-~,~mul(463,990)?#>-+mul(500,467)~~mul(41,729)-^don't() mul(478,617);,{$mul(722,601) when()who()>>&mul(107,557)}why()-why(){select()mul(963,953)+mul(56,679)/#!/usr/bin/perl(+where()?~%when()<mul(591,840)\nmul(120,615)mul(290,327)@mul(908where()#(when()(-~mul(577,101)why(715,329)mul(176,185)where()[#how()mul(750,233)[mul(159,147)~)who()select()+who()why()mul(742,864when()mul(427,119)}]*%@$}how()mul(480,127)$^]}how()from()[/>,mul(415,271)mul(681,988)</~~/where(),&:,mul(130who()'mul(551,234)'what():'!@why()+!mul(710,188)^select()mul(59,292)&;^why(359,678)?>??mul(244,420)&mul(348,572)when(746,716)/]^why()what()mul(476,900)];what()mul(203,688)why()*#who()when()+(why()where()from()mul(362,853){#'!%%mul(606,167)select()mul(928,445)!+<mul(275,155) ?'$mul(226,200)do() ;$ ):&when()~mul(495,155)-]~what()(mul(388,132)+}-mul(816,927){when(50,691)select()[[mul(157,67)^,-when()/}<:mul(273,650)^mul(459,438){)who()mul(403,758)how()mul(163,436)^([~-how(){what()mul(550,927)#$<&%mul(883,534)where()+mul(964,832)}mul(68,704)how(987,646)()how()what()when()*'mul(309,481){{where()<how()%mul(501,81) 'why()mul(925,35)!what()+@mul(249,565)[(mul(396from(604,6)$)mul(206,227))when()>'select()mul(41,136)mul(245,634^who(419,312)#/'<)'%mul(804,572)'%+' who()+@mul(913,22?;+-from(278,530)#how()mul(141,596)@>select(540,148)!]{mul%!-@#&}mul(889,958)mul(485,341)~%+how()?select()#mul(777,805)'how()!mul(266,524)<+)when()$<when(55,561)/mul(304,989)~}<'mul(298,616)who()how()mul(436,599)!what()+'#[mul(430,767)*/&mul(949,856)%>{mul(880,580)select()&who()~#)mul(486,513)why()when()%;how()#mul(937,105)*mul(186,474)mul(420,471) what()[>,%)]mul(862,899)(&}]{+$mul(871,579)$why()#}#mul(125,369)when(271,818)<''}-select(){ don't();#who(){-#mul(268,334)^:%do()mul(75,572){what()mul(283,605)mul(919,23){;)what()~who(445,781)from()&>mul(294,330):*from()who()#from(868,274)-[mul(47,694)mul]$when()$+mul(747,604))!~;mul(588,239)what()(^(>}mul(376,745)why()]where()why()/who()mul(265,949)mul(889,524),,{what()+{/*mul(946,665);?*?;~,mul(738,941)&]why()]~^~where()*mul(865,982):',mul(146,728)~mul(399,437)(do()mul[why()<!$mul(538,185)/@({where(){%]^mul(687,547){)/%?>from()who(),:mul(277,862)from():'mul(367,848)where();why(),(select()-when()who(){mul(833,730),+select()mul(196,278) ?}}[!^^mul(825,271):select()&@~^+<mul(254,892/*),when()]&why()mul(456,902)$?when(119,330)'?why()$mul(862,499)'>why()<from()*'mul(993,416)what()>%mul(858,60)};how()}^mul(285,548)mul(989,956)$mul(849,412)}>/:>/@mul(803,749)select()>,#mul(270,484),mul(49,218)%{;/>select()'+mul(645,947)select()*?do()' >@'~;mul(222,599)#@from()where(),what()mul(989,460)?{)<$mul(444,901)<@'mul(402,13)/!*mul(657,625){#when()what()mul(762,228)#mul(704,630)@&{??!//?/mul(104,95) mul(337,388)#^ )who())where()mul(623,138)$mul(403,157);%mul(101,259)>what()don't()>mul(998,640)mul(448,211)?*!select()who(),? )mul(271,985)$}--~&mul(234,431)from()+where(891,795){$+:~)mul(11,379)\nwhy(872,627)when() @who()&why()mul(585,812)-+#%(%)mul(774,83)where()<mul(895,861)mul(251,516);where()>-(/~mul(249,409)&>don't()('^mul(504,414)!%>%[\#{*<%mul(188,200)mul(167,558)>?>select():@mul(56,920)-how()}[{?^*,mul(280,213how(298,460)/]<*mul(827,209)$^{where();mul(55,859)?mul(820,629)^],*@+!]&mul(51,796)*@[:mul(391,202)(*&($?%;{mul(715,516)where()when()when(878,620)>^%><()mul(200,147)##}^$ ]'select()+mul(830,239)((~select()'mul(107,50),:<{when()(select(441,699)when()mul(190,106)]what()+where()@{where()#who()mul(280,967)who();from()( do()+'] /;where()&select()/mul(196,704))<&mul(268,129)#)!'?+**mul(2,819)---{what()mul(340,265)]-;@}-{>mul(957,38)>@~>&@<<mul(135,648)~mul(544,906)-mul(406,769)who()from()*where(713,507))(do()'[*select()&<'who(784,971){$mul(520,472);from()mul(823,285)]?)%{}mul(412,741+&{mul(822,931)^'*'*why()where()&!mulwhen()%@;^from(){mul(432,703)+/when(331,316):&who(713,258)mul(763,674):}~:mul/!select()why()&]{who()}]who()mul(908,41)mul(209,528)^mul% %#@@how()mul(986,797)+];~>who()(how()'~mul(576,420)!]:(who()mul(696,352)what()*,{]how()<#mul(722,996*^>[mul(707,555)mul(690,368)+*\#{why()/why()?;mul(191,355)-}mul(634select()from(662,490)^select(130,551)>$when()mul(785,141)how()from()@//^do()from()when()%mul(280,35)(select()who()<:who()#<-mul(656,404)&+&mul(876,651),<'>mul(932,833)where()(,when()when()!/mul(756,656)&where();-^why()]mul(247,388)where()}{why()}?do()$}why()select()mul(783,462) &],(who()?:;mul(981,136)<{];>mul(848,166),]-why()do()from(102,362):-~how() why()how()who()mul(163,237)%;]mul(762,71)~,<when()^) /mul:who()[>:-;mul(996,713)#!-~do()<mul(573,915))>/ ^^mul(190,532)&'why()@~mul(580,20)mul(512,144),how(712,274)# ([mul(74,589)>-what()what()~mul(144,880){mul(566,592), {@*why()mul(523,558)@)!mul(826,790)!select()why()from()(mul(110,522)!select()('mul(704,195>+from()?%>mul(274,353)))}who()[when(660,595)~how()]mul(552,121)from()select()why()mul(240,146)why()>   mul(679,332)why()(%(from()^:why(492,169)}~mul(799,127)%~}mul(755,381)[;%what()how())*when()what(323,755)?mul(454,719[-%/;why()how(316,859)^!when()mul(151,252)where()&<who()%mul(379,643)/!#]what()+*<[mul(495,86)%>/ &mul(802,262)**why()mul(860,835)<&]from()where(617,545);;mul(547,933)'mul(809,108)! ~%]})where()mul}'what():mul(270,513)who() (]@,~][mul(900,601)~:?!'mul(772,689)*(%'**~^from(){mul(664,414)&&-who();who()from()who()$,mul(658!*+mul(68,562)[*mul(227,260)^:#(;mul(171,823);>select()where()'+$$mul(520,111)>+*select()why()mul(713,530)}-<$;(;mul(94,879)?who()why()@/^/@mul(58,649)?why();(what(994,808)-:,mul(439,811)' mul(885,101)[what()mul(713,539)?/~where()!#/:#mul(119,763)where()select()[%;:from():+mul(78,791)select()}'mul(253,65)^ %mul(175,244)]#+why()where()@;mul(610,884)*;what()mul(70,112)( mul(375,253)mul(321,80);+mul(498,751)>[~?mul(848,622?$<how()':?']-what()mul(931,202)-@where()-$+$>mul(43,693)how(){(^<who()why()!*mul(696,319),when() ?,$mul(655,774)~who()mul(507,610)@^<]mul(303,538)[] what()what()!)?mul(699,30)$;}{who()(+when();mul(100,158)>mul(91[)why()^:^from()]*mul(773,980);how()@who()(mul(817,36)\n!']*;&mul(832,66)[when()'^mul(839,760){ what()mul(374,389)-^*when()what()mul(743,565)+%where(24,265)--@mul(37,414)mul(200,132)&<&@when()who()]~what()mul(816,483))from()%{:mul(237,407)]what()select()where()mul(937,582)why())!)mul(196,261)>*<%;who()<:!mul(42,391)) where(711,384)mul(286from()'[%mul(112,582)from();:mul(755,219)!**where()<#?)mul(893,667)who()> #mul[:where()select()<mul(969,985){{mulfrom()#>>(/from()>:-mul(587,565)mul(979,685)mul(686,145)who()?;]:{$mul(815,666'?&mul(981,191)mul(710,249)~@what():*&+from()<mul(581,50)from() #$(; #;mul(299,214)when()%&where()/(&mul(982,443select()*?%>&mul(420,352)&(-mul(308,752)@'mul(408,712)why()<]mul(610,709)~{mul(495,81)~),select()^mul(257,534)where()}mul(154,658)^}mul(313,894)(why()mul(950,201)>why()%what(276,768)%-+??(mul(578,595)mul(860,931)&{>:)^mul(566,551)>what()+how()[*from()[)mul(879,564)from()~:^'}[select()#who()do()%what();who()#mul(614,173))>'mul(274,742)why()+!&*/mul(962,316)?do()<@mul(599,386))mul(355,316)+-;&where()-;don't()?#[]#where()[::mul(532,56)>~@mul(264,327)~?%]&@! when()+mul(739,388)<$*)what()mul(732,804)from()who()'who()#,~mul(642,712)?}?mul(362,448)&,}+}: -mul(980,701)']when()-;]^^mul(761,19)+,mul(69,535)$>@<mul(901,942)who()when()^how()when()mul(424,524)-why())select(934,173)what()}/where()>do()%/:mul(244,738) mul(836,850):;when()from()'?do()]who(931,224)+}*@when(690,226)how()!mul(651,163)?how()-(&$-@mul(159,702)@mul(165,723)}(mul(401,331)'what() what(75,87)){,mul(665,944)/<:@'why(290,555)&%';mul(906,18)select()mul(394,692)*where()'mul(127,395){^what()~-^mul(892,931)%@who()<!/!(mul(900,441)']:(~$%,from()$mul(128,485))^+]what()do())&from()}'?%-from()how()mul(72,571)]+:~where()^&/$ mul(265,657);why()mul(420,896)':$@~ +<?mul(738,771)*~mul(769,630)select(202,447)];mul(64,143),(mul(820,863)}[]:)<[from()mul(913,277)<;+;@[*!/mul(339,478)mul(533,783)^mul(925,371)@@what()]mul(554,646)]{do()--where(),}mul(869,832)?::-<>mul(770,492)when()mul(615,744)<;+]+how()}&(mul(849,515)who(651,542)/@$mul(551,298)mul(752,737)>?what();^{,mul(518,320)~select()(+-,>;)~mul(37,708)why()'mul(213,584) how()mul(552,286)mul(41,894) <(mul(410,393)(why(),^<(\#{~+don't()what()/when()what(35,148)$how()  $'mul(352,31)'!?[mul(922,598)# mul(274,543)/{/'!-()mul(899,396))&-,#select()how()select(963,44)mul(719,545)(')mul(909,800)-[-mul(718,282);< )where();*#+mul(509,20)>?@^select() $do()]:what()>}!!^({mul(492,556);<{$how()mul(98,348){]'don't(){{',mul(564,736)>{how()'mul(154,829)'~from()]do(){mul(452,695)+where()who(),-mul(906,99){} >why()why()mul(12,879)~when(646,247) ;mul(878,782)+ '{+&>who() mul(726,701)%<##!mul(457,189)$>')+~!%do()where() @when()mul(159,260)<%[~when() why()mul(663,679)}/\n"

Day3.part1(input) |> IO.inspect(label: :day3_part1)
Day3.part2(input) |> IO.inspect(label: :day3_part2)
```

```elixir
defmodule Day4 do
  import AOC, only: [s2map: 1, dir8: 0, add2: 2, mul2: 2]

  def cut(m, p, d, ks), do: List.to_string for(k <- ks, c = m[add2(p, mul2(d, k))], do: c)

  def part1(s), do: Enum.sum(for m <- [s2map(s)], {p, _} <- m,
    d <- dir8(), cut(m, p, d, 0..3) == "XMAS", do: 1)

  def part2(s), do: Enum.sum(for m <- [s2map(s)], {p, _} <- m,
    Enum.all?([{1, 1}, {-1, 1}], &cut(m, p, &1, -1..1) in ["MAS", "SAM"]), do: 1)
end

input = "SXMSMMXMASMSSSSXAMXMXAMXXAAXMAMSAMMXMAMXSAMXMXMMMMSMMXMXMASMMSMMSSSMAXXMSMSSXMASMXSSSXSMMSSSSSXMASXSAMXSMMSSMXXXXXMASXMXMSSSMMSSMSSSMMMMSSXM\nSAMAMSMSMSXAAMAAXMSXMSSSXSXMSMMSASASXSMSMSSMSSMXAAMXMASXSAAMAXASAXMASXSASMASMMSMMAMXSAAXAAXAAAASAMAXAXASAAAAMMSMMSMMMASASAMXSAAAAMASMAASMMAS\nSAMXSAAXAMMMMMMXAXSAMMAMAMXMAAXSXMASAAMSXAXAAAXSMSSSSXSAMXMMASMMMSXAMSAAXMAMMMAAMASAMXMMMSSMMMMMASMXMMXSMMSXMAAAAAAAXMASMASAMMSMMMAMMMXMAMAM\nSAMXSMSMAMAAXSXSSXSAMMAMAMASXSMSXXXMMMMSMMSMMXMSAAAMXXMXMXXMXXXASAMXMSMSMMXXAXXXMAXAMSXXAAMXSAASMMMSXAAXMAXMSMSMMSXMXMMMSXMXSXMMMMXSXSMSSMMS\nMSSXMAXMASMSSMAXMAMXMMASAXMXAMAMXMMMXMXMAMXXAXSMMMSMXMMAMMXMAMSMMMSSXSAXMSASXXSXMSSMMSAMMMSAMMMMAAAAMMMSSXMAMAAAAMMSXXAAXXSASAAAXMASAAAAMAXA\nXAXASMXSAMAMAMMMMAMASMMMMSXMSMSMSAASXSXSAMAMSMSAXSAMXAAAXMAMAMAAMAAMAMAMAMASAASAMAAXAXAMASMMSSSSSMMSAMAAMAMAMSSMMSAMMSMXXMMASMSMMSAMXMMMSMMM\nMMSMMMAMMSXSAMAASAMXMAAAXMAXMAXAMSMSAMASXSXAMASMMXAAXXXMXMMMASMSMMSSSMSMSMAMMMMAAXXMXMMMXMAAAAXAAMAMMMMASMMXXAAAAMAMMAMXMXAAMXMAAMXSASXMAXAX\nXAAAAMMSAAASXMSASASXSSMMSMMMSAMSAMXMAMAMMAMSMAMMXSXMSMSASXMSXSAMXMAXMAXXXAXXXASXMASMXSAMSSMMSXMXMMAXXASAMAASMSSMMSSMMASAASMXSAMMMSMSXSASASXS\nMSSMMSMMMMMMMMMAXAMAAXMASASASXMXMAMSAMXXSAMXMAMMXSMAAAMSMAASAMXMSXMXMAMSSMMMSASMMXXAASXMAAAMAAMSXSSSMMMSMMMSXAXXXAAXSAXAXMAASXSAMXAXXSAMXSAS\nXAAASXXAAMAAXAMSMMMXMMMMXAMAXAMXAMMSXSXMXSSXSAXXASMMMSMAMMMMAMMAMXXXMASXMAAXMAXASMMMMSAMSSMMMXMAAAMAAMAMMMSMMMSMMMSAMAXSAMXMSAXXSMMMAXAMAMMM\nMMSMSAXSSSMMMMAXAXMASAXSMSMXSAMXXXAMMMMMAMMMSMSMASXMXMMMMAXSMMSASMSSSXMASXMXMMMAXMAMSSMMMAMXXSSSSMSSMMASAMAAAAAAAAMMMXMAASAXMXXMXMASMMSMMSAS\nAXAXMAMMAXAXAMSMSMMAXMXSAXAMSAMXMMMSAAAMAMSAMXAMAXASXMASMMMMMASAMAXAAXSMMMXAAXMXMMMSAMASXAAAAAAAXAXXASASMSSSMSSXMXSXXXMXAMXXSSMMAMMAXSMAXXMA\nXSASMMMMAMMSXSAAMAASXSASXMAMMSMASAMXMXXXAXMASXXSSSMMXMASAAXAMMXXMSMMMMMAAAXSXXMSASXMASXMSAMMMMMMMMMSMMXSXXXMAXMMSMSMSMSAMASXSAAAASMMMAMMMSXM\nXSAMMAXMMMMSMSMSMSMMAMASASXMAAXXMASAXXSMSSSMMAXAAMAAXXASMMSSSSMSAMASAAXMMMMMAAAAMMASXMXMAXXXAAAMXSASAXMMMSSMXMAXSASAAAXXSAMXMSMMXMAASAMSASAX\nAMAMSXSXMASMAMAMMMAMMMXMXAMMXSSMXXMAMSAMXAAMASMMSMSASMXXAASXAAASASAMSSSSSXASMMXMASAMASMMMAMXSSXSAMXSAMSAMXAMASMMMAMSXSXXMAXAXMMSMXSMMMMASXSM\nAMMMXAMASMMMAMAMSSMMXSASXMMSAMAMAMMMMXAMMXMAAXMXXAMXXAXXMMSMSMMSAMAXXXAAAMXAXMXMAMASAAAAAAMXMMXMMMXMMMSASXMMXAAAMXMXXMMMSSMMASAAMMMMASMMMMMM\nMSSMSAAAXAASMSMSXAXMMSASAAAMASMMASAMMSMMMXXMSSSMMAMXMSMXSAMMASMMMMSSMMMMMXXSXXAMAXAMXSSMSMSAAAXMAMXAMXXMAAXAMSMSXMXMSMAMAMAMAMMMXAASAXMXXAAM\nMAAXSAMXMSMSAMXSMXMXAMAMMMXMMMXSMSASAAMAMAXXAAAMSAMAMAAMMAMSAMMAAAXAAAXAXMMMMMMMSXMMAAAAAASMSMSMAMSAMXMXSSMXAMAMMMAXAXAXXXAMASXXSSMMMSSMSSMS\nMMSMSXMAMXMMXMAMMSMMXXAMXXSSXSASASAMMXSAMSSMMSMMSMSMSASXXAMMMMSXMXSSSMSMSMAAAASMMASMMSAMMMMAMAMXXXASMMSAAAASMMAMAXSSSXSSMMASASMXAXAAAAAAAAAS\nMMAAXAMXXSAMXSSMASMAMXSXSSMASXAMMMMMXMXAMAAXXAXXSXSASAMMMSSMMASMMMXAXXAAAMMMSASAXXMAAAAXMXMAMAMMMSMMXAMMSMMAAMMXSMMAXAMAMSAMAXAMMXSMMXSSMMMS\nMSMSMMSAMXAMAMAMAXMASMMAMXMXMMSMSAMSXMSSMSSMMSXXMAMAMAMSAAAXMASASMMAMSMSMSMAMXSAMSMSMSSMSASASASAAXXXMMMMAAMSMMSAMASAMXMAMXMMXMSXSAXMAXMAMMAX\nAAXXAAXAXMAMXXAMXXMASAMSMMMSMAXMMAMMAMAMMXAMAXSMMSMSMXMMMSSMXXSAMXMAMXAAAAAMXAMMMAAXAAXASXSAXXSMSMMXMXSSMSXAAAMASMMMSXMAMAXMXXXAAXSXMASAAMAM\nSXXMMMSXMMSXMSSSMMMASXXAAAAAMAMMMSMXAMASMXAMXMASAAXMSMXMAXAAXMMMMASAMMSMSMSSMAXMXMXMMMMAMMMMMMXMXASAMAMAAXMMMMSAMMASAASASXSXSAMMMSMMXXMAMMAS\nAMSXSAMXSAMXAAAMAMSXMASXXMMSXSAAAXASMSXAMMXXAAXMXSMMAXMXMSMSMXAXSXSASAAAAXAXMAMSMSMXMMXXXAAAXXAMXSMXSASMMMXXAXSXAMMXMAMXAAAAXAAXXXMASMXSAMAM\nXMAXMASAMASXMMSMSMSASXXMASXMAMMMMSASAAAMXASXMSMSMMASMMMAMMAMASAMMASAMXSSMMMSMSXSAAAASAMXSMSSMSASMAAASXSAMAMSMMMXSSSSXSMSMMMMMXSMXMMASAAAAMXS\nSAMXSAMXSMMXMAXXXASXMXAMXSAMAMXXXMXMXMMXMMAAAAAAASAMXMSASMAMXXXAMMSMMAMAMXXAMMAMSMMMSAAMMMMAMSAAXMMMSASXMAMAAAXAXAAMAAXAXMAXSXMMSAMXMMMMXMXM\nMAXAMASXSAMXSASXMAMXSXMAMMAMMMXMMXXXSMSXSMSMMMSMMXXSAMSASXMXAMXMSAMXMXSAMSSMMMAMXSXMXMXSAMSAMXMAXMAXMMMMSSSSSMSXMMMMSXSSSSSSMXAAMXMXSASMMMMS\nSXMASMMMSAXXMASAMXXAXASMXXMMXXMSAAMMMMAMSAXAAXXXXSMMAMMAMMSMSSXAMXMXXAXAMMAMXSAMMAMSAMASAMXASMMSMSMSSXAASAAXXAAMMXMAXMAMAMXAMSSMSAAAMAAMAAAX\nMAMAMASASAMXMAMXMMMMSAMXXSSSSXAMXMMAAAASMAMSMSMSMMXXXMMMMASAAAMMMSSSMSMSMSMMMMASXAMMMMASAMSSMXAXXXMXMSMSMMMMSSMAAXMXXAXMXMSAXAAASMXXMMMSSMSS\nMMMASMMAXXAMMMSMMMAASXMMMAAAMMAMXMMMMSMSMSMXXMASAAASMMXSMASMMXAAAAAXAMAMMMAAMMMMMXSXXMASAMMXAMXMMMMAMSXAAXMAXAXSSXSMXSXSMASXMMSMSASMXSMAXXAX\nSASXSXMMMSXXMAAAASMMSASAAMMMMASMSSMSAXAXAAMMSSSMMMXSAMMMMXXAXXSSMXSMSMAXAMSMSASASAAXMAXSAMXMMMAAAAXAXXAXXMMXSAMXAASAMAAAMAMAMAMXMAMXAAMASXMM\nAMSAMXMMASAMXSSSMSMXSAMXSXXMXSAAAAAAAMAMMMSAMXAMXMXSXMAMXASXMXMAAXMXMMXSMMMXSASASMAMSXAMAMMAMSSXSSSSSMMSAAAXAMXMMMMSAMXXMASXMASAMSMMAMMXXAAA\nSXXAMXMMAXAAMAMAMXAAMAMXXMAMXXMMMMMMMMXMSAMASXMMAXMSASXXMAASMSXMSMXAXSASXSAAMXMXMASMXXXXAMAMXAXMXAXAAMAAXMMSAMMXSXXAXXMXXAXAMXSAMAAMMXMAXSMM\nASXSMXMMSSMXMAMAMMMASAMXMSMXXSXMAXAXMXAAAASAMAASASASXMAASXMXXAAXAXSMMMXMASMXXAMXSAXXSMMSMSSXMASMMSMXMMMXXMXMAXSAMXMMMAMXSSMSMMMMSSMMMAMSMXAA\nMAMAAXXAMAMASMSSMMXMMASXMAMXMASASXSSMMSMSAMXSSMMMMAMMMMMMAASMSSMMXXXASAMXMMMSSSMMASAMAXMXAMXMSAMXMASMSSMSSSSMMMASMAAMAXAAAAXMAAAMMSXSAAAASXM\nXXMAMMMXXAMAAAAAASXMMMMMSASXMASMMXXAXXXAMXMAMMMXXMXMAMXMSMMMAAAAXSASAXXMMAXXAAAAMAMXMSMSASMMXMAMXMAMAAAAMXAAAXSMSMMSMSSSMMMMSSSMSAAMSMSMXMAA\nXXASASXASXMSSMMSMMAMASXXSAXXSAMASXSSMMMMMAMXMAMXMMAMXMAAXXXXMMXMMXAMMSSMSAMMMSMMMASAXMAMMXAXAMAMSMMXMXMMMMSMMXMAMMSMAMAXAMXMMMXAMMMXXAXMASXM\nXMAXAAXMASAAXMAXAXXMAMAAMAMXMXMAMAAAMAAMSXSSSSMASAMMSAMXMASMXSXMXMXMMAXAAAMXAXAAMXSAMMSMXSAMASAMAAAMSASASAAAXMMAMSASMMAMMMAMAXMXMSMSMSMMMXAA\nSXAXXMMXAMMSMMMMAXSMSXSAMAMXAAMSMMMMMSXMXMAXAAMASAAASASAMMMMAXMAMSAMXMMXMMMMXSSMMMSAMAMXAXAMXSXMSSMXSASAMSSSMMSMSMAMXMXMMSMSMSAMXAAXAAAMSSMM\nAMXSSMXMXMSAMASMXMMAXAMXSXSMMMXMAMMXXXSSMSMMSMMMXXMASMSASXAMXSMMMMSAAXMMMAXMAXASAASXMXXMSSMMXSAXMAMXMMMAMAMAMAAMXMAMXMSSMSAXMAMXSMSMMMMMAASX\nMAXAMXAMMMMASAXAMXMAMAMAAAMXSAMSSMAAXMASAAMMMMSSMXMAMMSAMMSSMMMSAAXXXXMASMSXMMAMMMMASMSMMAMXAXMMSAMXMXSAMXSAMSMMASASAMAAAMXMMSMMXAAXXAAMSXMM\nXSMXXSXSAXSAMXSSXMASXXMXSXXAMAXAMXXMMMMMMMSAASAXAXMXSAMAMAXXMSASMSMASMMMXAAXXMAMSASXMAAMMAMMMSXXMAMSAMXMMXMXMMXSAXXMMSSMMMMSAAASMSMSSSSMMASA\nSXSAAMMSAMMXMAMXASAMXSMMMAMSSMMSSMSMSAAMMXSMSMMXSAMAMXSAMXSMXMASAMXMMAMAMXMMXMSXSASMASMSSXMAAMXMSXMAMMAXMAMMMMXMMSMSAMXMAASMMSSMAAXXXAMAMAAS\nSASMXMAMXMAXMAXMAMXSAMXAMAMAAMAMAXAAXSMSAASXXMXAXAMAXMMAXMAXAMAXMASXSSMAXSAMXAMXMMMXMAXAASMMSSSXSAMSMSSSSSXMAMXAAAXAMASXMXSAMXMASASMMXMAMMMA\nMAMXMSSSSSSSSSSMSMMMXSAMXAMXMMASMMMSMXMXMASAMXMXSASXSMSAMSMXXXMXXASXMASAMSAMXSSSXAAXSMMMSMMAXAMASAMMAXAAXAASASXMMMSAMXSAXASMMAXMASXAXMSXSSSM\nMAMAAXAAAAXAAAMAAAAAMMASMXMASMXSMMMAAXAMXAXAMAAXSAMXAASXMAMMSAMSMXSASXXXMMAXAXAMMMSXMXMSMMMSMAMAMAMMAMMMMSMMASXASAMXXXSAMXSASMSXXMMMMMMXMAAX\nMAXXMMMMMMMMMMMSSSMSSXAAMXXMXMAMAAMMXXSSMMSAMXSAMXMMMMMXSXXASAMXMMSAMMMMSSSMXMMMASMMXAXMAXAMXXMXSAMXXAMAMXAMAMMMMMSMAMMASXSAMXMXAMAMXXXAMSMM\nSSSMMAXAXXXSMSXMAAAAMMMMXASXMSSSMMSMSMMAAASXMXMXMAXAXSSMMSMASXMAMAMSMAAAXAXAAMASMSAXXMSSMMSMMMMXAASMSSMAMSAMMSMSAMAAXXMAMMSASAMMSSSSSSSMMAMX\nXAAASXMMMAAMMSAMXMAMXMASMMSAAAAMMSAMAASMMMMMMASMSMSSXMAAAXMMMMSASASMSXSXMXMSASASXSXMSMAAAAMAAAMAMMMAAAXAMAMXAAMMASMSMXMAMAMMXAXAAAAAAAMSAAMX\nMMMMMMASMSMXAMXMAMXXMSAXAASMMMMMMSASXXMAXXASMXMAMXAMASXMMSMAMASMSXSAMXXXMMXAXMAXAMMAAMSSMMSSMMMMSMXXMSMXMXSMMSMSAMXMASMMMSSSSSMMSSMMMMMAMSMM\nASXSMSASAAAMSSMXXSAAXMSMMMSXMXMAXSAMXMMSMSXSAXMMMMASXMASXXXAMASASMMXMAMAMSXMAXSMASASMXMAXMMMMSMSAMXSAAAASASAXAAMASXMMMAMXMAMAMMMAMMXXXXMAXXA\nSXAAXMASMMMMMAXMASMSMAMXMASASXSMMMSMMSMMASASAMSMSAAXMMXSXASMSASMMMSMMASAMAMXMAMXXMAMXSXAMMAAAAMXAMAAMMSMMASMMMSMSXMAXSAMAMAMAMASAMMAMXSMXMAX\nMMMMMMAMXXXASAMMAMAXMAMAMAXAMAXSXAXMAAAMSMXMAMAAAMMMSMAMMXMMMMSASAAMSASXSAMAMMSASMAMAMMMSSSMSSSSSMSMXMAAMXMAAXAXMASMMAMSXSXSXSMSASXXXASMSSSM\nSAXMASMMXASXMAXMSSSXMSSSMSMSMMMMMMMSSSSMMMAXAMMSMXSAAMSSSSSMSSSXMMXXMASASXSXSAAAMMMMMSMXAAAAXXMAXAMASXSSMMMSMSMSMXMMAMXMASMMXSXMXMASMMMAAAAS\nSMMMXMAASMMMXSMAXAMASAAAAXAMXSAXSAAMMAAMXXSSSSMXXAMMASXAAAAAXASAXMXMMMMMMMMXMXMSMXSAMAAMXSMMMSMAMXMASAMAXAXAAAAAAAXMAXXMAMASAMMXSAAXAAMMMXMM\nMAAXAXMMSAAMAXMMMAMXMMXMMMASXXASMMXMMMMSXXMAXMXSMASMMSMMMSMMMSMMMMMMAAAAAAXAMXXAAASASMSMMMASAMMXSMSAMAMMMMSMSMSMSMSSXSXMASAMAMAXAMXMSMXSSMAX\nXSXSSSMASXMMMMASMMXMAXXXXMSMASXMXMMSSMASMMMAMMASMAAAAXXXAXXXSXSXAAASXSSSSSMMSAMXMMSAMMAMXSAMAXXAXAXXMAMXAXAXAMXAAXXMMMAMAMXSMMSMMSMXMMSAXSXM\nMMXAAMAMXXXMXMAMMXAAASMMAXXMAMMAXXAAAMXMAMXMMMAXMSSMMSXMMMMXMASXXXMMXAMMAMXSAMSAXXXMXSAMMMAMXASMMMMMSMMSSSMSAMXXXSAAAMAMASMSXXXAXAXAAXMMMMXM\nXMASMMSAMXMXSMMSMSAXMAAXSSSMSSSMMMMSSMSSSMMSXMMSAAAAAXMAMASAMXMASMSSMSMMAMSXAMSMSMAMXMAXMMAMXMAXAMAMASAAAAMAMASAAXMAMSASMMMXMMSMMMSMSMMXMMAA\nASAXXAMAMASAMXMAMMMMMSAMXAAAAMAAXXAMAMAAXMAMAMSSMSSMMSAXSASASAMAMAAXAAXSXSSMMMXMAMAMMSMMSSMSMXMXXXASMSMMXSMMSAMMAMAXMSAMAXMMSAAAMXXAXAXAAXAS\nMMAXMXXAXSMMXXSASXSAAXMMMMMMMSSMMMAMAMMXMMSSSMXSAAMAMXXXMXXMMMMSMMMMSSMMXXXAAAASASXMXAAAMAAAXAXXMSASXSASAAXAMXSXMMMMAMMSMMXAMXMMMMMMMSSSSSMM\nMMSMMSMXMMASAASMSAMXSXMXASXSAXXAXMASMSXAMMAAXSSMMMSMXMASMSSSSXAAAAXMAMMSSSSSMSMSXSAMSSMMSMMMSASAAMAMASAMSSMXSMSMSAASXMAAXAMSSSSSSXSAAXXMAAAX\nXAXAAMMMASAMMMMAMMMMAAMSMSASXMSMMMMAAMXXSSMMMXMAMXMMAXMASAAAXMSSXMSMASXAAMAAAXAMAMAMAAMMAXXXXAXMXMAMAMAMXXXXAAXXMSXMAMSSMMAXXAAAMAXMXXAMSMMM\nMMSMMSXAMMMMXXMMMXMMMSMAAMAMAAAXXMMXAMXXMMAMMMSXMASMSSSXAMMMMMMXAASMASMMSMSMMMASMSSMSXMMAMMMMSMMMSASASMMMAMSMMMSMMMSMMXAMXSXMMMMMMMMAMSAMXAA\nXXAAAXMSXSMSSXSAMXSAAAXXMMAMMSMSASMSAMXAXSAMAAAASMMMXMAMMSXXXSASMMMMAMAXAMXMAMXAXAXAXMMMXMAAAMAAAXASASXAMAMAMAAAAAAAMXMAMAXASASXAASMASAAMSSM\nXSSSXSAXASAAXXMASASMSMSSXSXSXAMAAAASAMSMMSXSMSSMMMSSSSMXAAXMAMMSMAMASXSSXSXSSSMSMMSAMXSAMSSSSSMMSSMMAMMXXAXASMMXSMSMSASAMASMMXSSSXSSXSAMXAMA\nXMAAAXAMMMMXSASAMAXXXMXMAMAMXXSMSXAMAAMAMXMSAMXAXSXAAMXMMSSMAMXXXAXAAAXMASXAAXAAAXMXMAMAMAAAAAMMXXXAAMMMSSSMSXSAAAAMSMSXMAXAMAMMMMMMMMAXMASM\nMMMMMMXMXAXAXAMSSXMSSMAMAMAMMMXMMMXSMMMAMXAMSMMSMAMMMMAASAXXAMXMXSSMMMMMAMMMMMMXSXMAMXMMMSMXMASMMSMXMAXMAMAAXAAMMMMXSAMXMSSMMAMAAXAMXXXMMAMM\nAAXMASAMXXSMXMAMXAMXASMSXSXSXXAAXSMXASXSSSSMAXXMMMASMSASMXXMXSXSAMXMASAXMAMSAAXSMMSASMXXAMXXXXAXAAXMXSMMSSMMMSMSSXXAMAMMMXAXSASXXSAMXXSAMAAX\nSMXXAMASXMXXSXSXSMMSMMMMMMXMAMMSASAMXMAXAAXSSXSMAXAMXMMAMMSSXSAMSSXSASXMAMXXXXXAAXSASAAMSMSMMSMMSMMSAMXAAAASXMAAXAMXXSMMSMMMMASAASMSAMSAMXSM\nXAAMXSMMAXSAMXMASMXXAAAXSSSMXSAMXXMAMMMMMMMAXAXSMMAMAMSASAXMASMSAMXSAMMSMXMXSSSSXMXMMMMMMAMAAAXMMXAMASMMSSMMAMMMSMXMSMAAXAAAMXMMMMXMAMSAMAXM\nAMSSMAMSXMMAAMMAXMXMSSSMAAAAAXXSAMMSXAAAAMSAMSMSXMAXAXSAMASMMMXMAMAMAMMAMMMMAAMXXMXXMMSXMAMSSMSAMXXXAMXMAXASXMAMAMASASMMSSSSSMXXMMMSSMXAMXMX\nSXAAMAMMMXSMMMSAMXSMAAMMMMMMMMMXAMXMSSSSSXMASMAMMMMXMMMXMASASMMMSMXMAMXAMAAMMSMMAMAMMAAAMSMMAAXMMSSMASMMAMMMMXAXASMSASMXAMAMAAMXXMASAMSXXXXX\nMMSSMXSXXAXASASASASMMXMMXSXASASXSMXXAMXAAXSXMMSMSASASXSAMMSMMXMAXASXSSSSSSXSAMASXSASMMXSMAASMMSXAAAMXMASXSAAAXSXMSXSAMXASMAMXSAMXMXSAMAMMMMS\nMAMXMASMMSSMMASMMASXSMSAASMXSXMAAMMMSSMSMMAMXXAXSASASASMSMMXSAMXSAAAAMXMAMAMASAXASAMXMAXMXMMAAXMMSSMXXXAASMMSMMAXXAMXSXMXSMSXMMMMSASAMMAAAAA\nMASAMASXAAAAMAMMMSMAXAMMXMAXXMMSMMAAMXXAXMASXSXMMMMAMAMMAXXXMAMAMXMMMMAMAMMSMMASMMSMAXMMAMSXMMSMMAXAMXMMMMXXMASMMMXMAAAXAXXMMMAXAAAMXMXSSSSM\nSASXMASMSMSMMMSXSAMXMSMSMSXAAMMMXSMMSASMXMAXMAXSAMMSMXMSASMMSSMMSSMMMSXSASXSASAMXAMSXMXMSMSASXAASMMMAAXXXXXXMAMMASAMXMXMMSXMAMSMSMSSMXXMAMAX\nMASAMXSMMXXAMXSMSASAMXAAASMMMMAMMMXSMAMMAMMXSAMXAMAMAMAMAXAAAAMXAXAAMMMXMXXXAMXSASMMSAXXMASAMSSXMAXMSXSXXMASMAMSSSXSSSMAAMXMAXXAXAMAAASXMSSM\nSAMXXMSASASASAMAXSMAMMMMSMAXMSMSAMSAMXMXAMMMMASMSMMSAMMMSSMMSSMMSSSMSXAXSSSMAMAMAMAAXSMXMXMXMXMAMMMXAASMSAMXMAMMAMAXAAXMMMXXMXMAMXMMSMMAXAMX\nMAXMAXSAMASXMAXAXXXAXXAMAMMMMMXSASMMSMSSMXAASAMMMAAXASXAAMMMAAMXAAAAXMMSMAXSAMASASAMMXXMMMSMMAXAMXSMSXSAXXXMXMXMAMXMXMMXASMAMSMMMAXXXXSSMSSS\nSAMASMMXMAMMAMXSSMSMXSASASMSXSAMXMMAMMXAASMXMXSXSMMSMMMMXMAMXAMMMSMMMMMAMMMSXMXMXSASAXMAMAAAMMSSXXMAXAMXMSMSAAMSSMAMMAXSAXSAMXAAMMXMXMXAAAAA\nMASMMAAXMASAMXAMAAAMXXAMASMSAMXXXMMASMSMMMMAAAMMMMMAMXSSXSXSASAMXAAAAASMMXXMASASMSAMXSASMSSSMXAMXSMSMMMSXAAMMMMAAMASMMMAMMSMSMSMSSSXAMSMMMSM\nSAMXSMMXMASASMSSSSSMMMMMXSAMSMMMSSSMMMAAMASMMAXAAASASXAXAAASAMXSSSSMSAMXSXAASAMXAMXMAMXMXXMAMMASASAAAAAXSMSMSAMXSMXMAAXMMXXXSAAAAAMXXXAMXMAX\nMMSASAXXMASAAAAAAAMAAAXMAMXMMSAASASAXXMXSASXXMAMSXSASMSMMMMMAMMMAMXXMMXMAXMXXMXMSMAMMMAMXMMMXSSMAXXAXMSMMXXAMASAAAASXMMXMAMAMSMMMXMASMMSSSMS\nSMXAXMMSMASMMMMSMSSSSSSMASXMAMMXSAMXMMSAMXSMMMSAAXMXMAMSXAXAMXMMMMSXSSMSAMSASXMAXSMSSSMSMSAXASAMXMXSAMXAXAMXSAMMSMXAMXSAMAMXXAXASXMMSAXXAAAA\nMMMSSMAXAMSAXMXXAAAAAAAMASMSMSMAMAMXMAMASMMXSAMMAMXAMSMSSMXXMAXAXXXAAAXMAMMASXMAXAXAXAAAAMASMSXSXMAMMXSXMSSMMXMAXMMXMASAXXSMSXXXSAAXSXMMSMMM\nSXAMAMXMMXMASMMMSMMMSMMMMMAAAAMASAMMXAMSMXAAMAMXAASMSMMMSMASMMSASMMMMMMMAMMXMAMXMMMSSSMSXSAMXMASMMMSMAMMMXAMXAMXSMSXMASMMSMMXSSMSMMMMAAXMXXX\nAMSSMMXMSAMXMAAAAXXAAXXSXMSMSMSASASXMSSXAMMMSAMSMMMMAAAAMXXSAAMAMAAXMXSXXSMMSSMAAXAMXAAAAMXMAMXMAMXAMASASXXMSXSMAXSMMMSAMXAAAXMASAMASXMMMMAM\nMXAMXMAMAASXSSMMSSMSSSMXAXMAMMMAXXMAAMAMXMAXXMMMXAAXSSMSXMAMMMMXMSMMMASXAMXMAAXSMMSSSMMMSMMMXXSSMMSXMASAMXAXAASMSMMAAAMXMSXMASMAMAMMSMMAMAAX\nXMAMAAXXAXAMXAASXMAAMAMXMMXMXSMSMXMMMMASXMASXSAMMSSMXXAAXMAMMMMMMAMXMASMSMAMSSMXAAXXMAXAAXMASMMAXASMMMMXMSMMMSMAXASXMMSAXMAMSAMXSSMAXAXAMSSS\nAXSSSSMMMMMXSXMMMMMMMAMMXSXMMXAMMSSMMSAMXMASMMAXXAMXMMSMXSAXAAAAMASAMMSAAXXMAAXSMMSASAMSSXSASASXMMSAMXASMAMXMAMMMXMAAASAMXSMXXXMAMMSMXXAMAMX\nSXMAAMAASASXSAXSAAAXMMXSAMASAMXMAAAAAMAMXMAMAXAMAMXSAXAAMSAMSSSSSMSASAMMMSMXMAMXAXXAMXMAAAMASXMAAASAMMMMSMSSSMSMSSMMMMMSAMXAMXMMAXAAAMXSMMSS\nAXMSMMMMSASASMMMSASMXSAMASAMMSXMMSSMMSXMXMMSSMMMXSAXSXMSMMXMAAMMAMXMMAMAXAMMSMSAMXMAMXMMSMMAMXSMMMSAMXMAMXAAAAXAAXASAMXAMAMAMSXMMMMSSXAMXXXA\nMXAMASAAMMMMMMXXAMMAAMMMMMXSXMASAAMAMSXSAAAAAAXXAMXSMXXMXMMMMMMSSMSMSMSMSMSAASAXXAAAMAXAMASXSASXMASMMXMSSMMMMMMMMXXXAAMMSSSXMXSAASAAMMMSAMAM\nXMAXAMMXMAAAAXMMMSMMMMAAXMASAAMMMXXSMSASMSMSSMMMSSSXMAMMAMMMSAMMXAXAAAAAMAMMSMMSXSMSSSMMSAMMSASMSAMXXAXMAMASXMSAXXSMSMXXAAXMAAXXAMMMMMXAAMAX\nMSAMSMMSSSSSXSAAASASAXSXSMAXMMMXXXAXAMAMAXXMAAXAAXMASXMSSMSASMSMMMMSMXMSMAXXAAXMXXAAMAAAMMSAMAMXMASXSMMSAMASAASMSMSAAMXMMMMSMSSSSMSAASMSSSXS\nXMAMMAXXMAMAXXMMXSAMAMMASMSSXXMASMAMAMSMMMASMMMMXMSAMXMAXMMASXAMASAMXXSXXMMMXSMMAMMMMSMMSASXMMMMSSMMMMAXXMXSMMMAAAMSMSAMAMAAXXAAMAMSMMAMXMAM\nXXAMSAMMMSMMMMSMMMAMXMMAMAXMASMASMMMMMXAXXMMMMAXMAMASXMSSXMMMMMSAMMMSMSAXSASXXMMAXMAMMXMSAXXSAAMXMSASXSSSSMSAAMXMSMXXSMSAMSASMAMMAMMSMSMSMSM\nSSMMXMAXAMAAASAAAXAMXSMMMXMMASMMMAXMMAXXMMSAMSAXSASAMXAAXXSAMXXMMXAXAAMAMMASAAXSAMSASMMMMSMXSSSSMMXSXAMAAMASMMSSMXASASASXMAXSAMMSAXMAXAAAAAM\nXAMAMMSMSSSMXAXSMSMSXSAXMMMSASAMSAMXMASMAXSAMMAMSAMXSXSMSASASMMASMMSMSMXMMAMMSMMAMMASAAAAMMAMXMXAMMXMMMMMMMSMXMASMXMAMMMSMSXMAMAXXMSMSMSMMMX\nSAMXSMAMXAAXSMMMAAXXASXMAAAMMMAMXMMMMAMMSMMXMXMXMSMMXAAXXMSAMXMAMAASXXMASMXMAAXXSMMSMMSMSMMASXMXAMXMASAXXMAMMXSAMMSMXMXAAXMASMMSSXMAXAAAXMSS\nSAMXMMAXMSMMAXASMMSMXMMSSMSSXSSMMSAMMASAAXXAMASAAAMMMMMXXXMXXAMASMMMMMMASXSMSMXAMAXAAXXMXXSASAASMMMSAMMSMMMSAAMAMXASASMXSAMMMAAMAMSAMMSMSAAX\nSMXASXSSMXXAXMXXAAXMAMXMAMAMXAXAASASXMSMMASMSASMSMMXSAMXMASMSMSXXMAXMSMASXXXMASMSXMMXMMMMAMAXMMMMAXMAMXAAMXMMXMAMXMSXXAXMXMMSMMMSAMXXXMASMSM\nSMMXSAMXAMXSSMXSMMMSAMMSMMASMMMMMSMMXMSASMAAMAMMXAXAMAAMSAMAAAXAMMMMAAMMMMXAMXMXAMXSAXAAAXMASMSMSSMSAMSMSXXXSMSSSSXMMSMMMSMXAMXXMMXSAAMAMXAA\nXXAMMXMMXMAMAXMAXSASXSAMAMSSMAAAASMASMSAMXXMAMMXSMMMSMXXMAXSMSMSMASXSMSAAXMXMAXXXSMSASMMMSAXXAAAMMAMMXAAMMMMMAXAAMXMAAAMAAMXAMXXXXASMSMAAXXS\nAXSXXAXAAMASAMMSXMASXMAMSMAMXSSXXSMASXMXMASXSSMXXAAAAXMXXXMMSMAXMASAAXSMXSASXMXSMMAMAMXAASXMMSMMSMSMMSMXMAXAAXMMMMAMSSSMMSSSSMMMSMMSAMMSSSMM\nSAMXSMSSXSXSXMXAMMAMMMXXXAMXAMAMSMMMSASXMXSAMXMASMMSSSMSAMXMAMSMSXMXMMXXASMXAMMXAMSMAMXMMSAXAAASAAMAMXSAAMSXMSSXAMXMMAAMXAAMMAAXMASMMMAAAAXM\nMAXAAAAXMMMMAXXMSMASMMMAMAXMAMAMAAMXXAMAXXMMMSMAXAAXAAAXMMAMMSXMASAMXAXMASXXSMASXMMMASMMMMMMXXSMMXXAMASXSXXXASAMXMMAMXMXMMSMSSMMSXMAAMMSSMMS\nSSMMMSMSMAAXAMXMAXASAAXXSXMXMSSSSSMMSSMMMMSMSAMMSMAMMMMMXXAMXMXXMASXXXSAMXMSMMMXMAXMAXMASXSAMSAMXSSXMAMSAMXAMMAMAMSXMMSXXXMMXAXASXSXMSAMAAXA\nMXAAAAXSMSSSMSXMAMSSMSAAMMMMXAAAAXAXAMASMXAXSAMXAXXXXASMMMXSAAXMXXMMMMAXXSXAXXMASMMMSSSMSMMAXSAMXXASAMXMMXAMASXMAXASMASXMMMXSMMMSASAXMMSSMSM\nMSXMSMXMXXMAMMASXSXMAMMXMAAASMSMMMSMMSAXASXMXMMSXSMMSMSAXAASMMMMSMMAAXMMMMMMSAMXXMASAAAAXAMXMMAMXSAMXMMAMMSSMXASMSAAMASASMMASAMAMAMMXMAMMAXX\nMAAMAMSMSSSMMSAMMMAMXMXAMSSXSXAAXXXAMMMSXXMASMMSAXXAAXSAMSMXAXSAXASMXSAAXMAXMXSXMASMMSMMMSMMMXMMMXAMXMAAMAAMXMMMMMXMAMSAMAMMSAMMMMAXAMAXMSMM\nMMSMASXAAMAXMMMSASMMXMSXXAXXMXMXMMXMMAAXXAMXMAASASXSXXMAMXASMMMXXXAAXSMMSSMSAMMMMSXSAXMMAXAXXASASMAXSMSSSMMSSSMXAXASXMMAMXSXSAMXMSMSMSAXSAAA\nXAAXXMMMMSSMXAXXMAAASMMSMMSSMSSMASASXMXSXXMXSMMMAMXAMSSMMXMAMAMAMMMXMSAMXAASXSAAMXAMXSAMASAMSMSASXMMXAAMAAXAAAXSXSASXMMAMMAASXMAXAAAXAASXMXS\nMSSSSXMXAAAMSMSMMSMMMAAAXAXAAAXAXSASAMXSXSAMXAXMXMXMMXASXXSMSAMAXXAXSXMSSMMMASXSSMSMMSMAMMXMMAMAMMSMMMMSSMMMMMMXMSAMAMSMSAMXMASMSMSMSMSMXXSM\nAXAAXMASMXAMAAAXMAAXSMMMMASMMMSMAMAMASXMASXXXXXMASXXSSMMMAMAXXXMXMMSXAXMASMMAMMMMAMMMMXMMMMSMAMAMAAMAAMMAMMSAXXAMMAMSMAAMXXAMXMXMAXAMXAAAMAM\nSMMMMAAXMASMMSMSSSSXSMAMMMMAMXMMAMAMMSAMAMMMMSMSMSXMAMAAMAMMMSMXAAMXXAMSMMXMAXAAMAMMAMAAAAMXSMXMMSSSMSMXAMASASXSSSMMASXSSSSSSSMASMMAMSMSMMMS\nXAAXSMMSSXMAAXAAAXMAMMSAAASAMMAXXMASAXXMASAAXXMAAXXSSMSMSMSAXMAMSMSAXMMASMASXSSSSMXSASXSSMSAMXMSXMAXAAXSSMMSAMAMMMSMASXMAAXXAMSASASXMXAXXXXS\nXSXXAMAMXAMMMMSMMMXMAAXMSMSMSMSXSMXMMSXMXSASXMSMSMMMMAAAAAXXSMSMAAMMMXSASMXSMAMAMAXMASXAXAXMMAMAAMAMMMMMMAMSMMAMAAMMAMAMMAMMXMMXSAMXSMMMXSAS\nMXMMMSMMMSMSAMMAXAMXMXSAXXMMAMXASAAAAAAMXSXMAXSXAMSAMSMMMSMMMAMAMXMMAMMAXMXXAAMAMAXMAMMMMSMMSXSMSMAXAXSXSAMXASXSMSSMMSXMXMMMAMMMXMMMSAAAMMAM\nAXAAXAAAAAXSASXSMSAAXMMMMASXXXMAMSSMMXSMAMAMXMSAMXAXMXXMAMXAMMMAXAXMSSSSSMXASXMSMSAMAMAAAAAXXXXAMMSMMMAASMXSAMXXXMXAASAMXMASAMAMMXXXSSMSMMXM\nMMMMMSSMXXXMMMAXAXSMMMAAMAMXMASAMXMASAMMAXSASXSXXAMMMMSAMXSMSASMSSSMAXAAAASXMSXMAMMSASXMSSSMMMMMMAXASAMXMAASXSMMMMMMMXASASASMSMSAMSMXXMAMSAM\nXMXSAXMAMSMSSMMMSMAXASASXMXSAAXAMSAAMAMMAMXAMAMMMSXASAMAMMSAMASXAMAMMSMMMMMAAMMMAMXMMSXAXXXAAAAAMAMAMXSAMXMXAXMAAAMAXMXMAMASAAXXXAMMAMMSXSAS\nXAAAXSAASAAAMASAMXSMXSAXASXMMMMAMAMSSSMMSMMAMXMASAAASXSAMMMSMAMMSSSMAAXAXXSMMMASAMAMXSMMMXSSSSSMSAMAMXSAMMXMAMXMMMSASAAMXMAMMMSMMMASXSAMXSSM\nXMAMMMXMSMMMSAMMSXMSMMMSAMXMAMSAMASXAXMAXAMXMAMMMMMMMASASMAMMXMXAMAMSSSMSMMXXSMSASASAMAMMAMMMAAASMMSSMXXMXAASMMSAMXAMXAMXMAMSASAMXAXXMAXASMS\nSSMMSXMXXXSXMXXMAMMASAAMAMAMAXMAMXSMAMMASXMSSXSASXSXXXMMAMAMSMSMMSMMAAXXAAASMMMSASAMMSAMMASAMMMMMAAMAXSMXXASXAASAMMMMXMXMXSAMASASMAMXMSMMMAM\nMAAASASXMMAAXSMSAMMAXXMMAXXMSXSAMMMMMXMASAXXAASAMAMXMSMXAMAXAAXMXAXMMMMSSSMSAAXMAMXMMSAXSASASXMAMMMSAMXAMSMMMMMSAMAMAMSAMXXMMXMAMMMAAAAAXMAM\nXSMMMXMAAASMMSAMAXMSMSMSMSAXAASASAAAXXMASMSMMMMMMAMASASMSXSAMXMXSSSXSAAAMXMMMMSMAMSMASAMMXSXMASXSAXMXMAXMAAXXSAMXSASAMMASASXSSMMMMXSMSSSXSSS\nMXASXSSSMXAMAMXMAMSMAAAAASMMMXMASMSMSMXXSAMXAXMASXSMSAMXXAMXMASAAAAASMSXMASXMASXAAAMMXMXXAMASAMXSAMSASASXXMMXMASXMMSASXSMASAXSXXAXXXMAMXAXAM\nMSAMAAAAXSMXSXXXXXAAMMMMMMSSMMMXMMMMMMMMMXMSMSSMAMAMMMMAMMMXMAMMXMMMMXMAMAXAMASXSSSSXSXSMXSAMASXMAMMXMASMMSAXSAMMSMSAMXAMMMMMMSSSSMMSMMXSMSA\nMMMMMMMMMASAMXAMXSMSSXXXMMMMAASASAXAAAMAAAXAAMAMMSSMAAMXSASMMSSMXMSXMSSSMSSMMXSMMAAMAAAXXAMAMXMAMMMXSMMMAXSAMSASAAMMAMXMASAXAAAXXAMAAAXMXAXA\nXAXXAXXXXAMMXSMAMXAAAMAMAAAMSMSASMSSSSSMSSSMSMXSAMXSXSAASMSAMAAXXMASMAAAAXAMAASMMMMMMMSMMSMSMSSSMAAMXAAXSMMAMXAMMMMXAMXXASXSMSXSSXMMXMMAXMXX\nSMSMXMMMMMSXMASXAMMMSAXMSSSXMXMAMXMMMMAAAAAAXMXXAMAMMMMXSXSAMSSMXSASMAXMMMAXMMSAMXXAXAAAXAAMAMAASMSSSXMXMAMSMMXMMSSSMSXMASMXMAAMMMSSMMSSMMSM\nAXAXAXAAAMAAAMXSMMSAXXXMAMMMXXMXMAAAAMAMMSMMMMMSMMAMXAXXMAMAMXXAAMASXMSSXSAMMXMMMMXMMSSSMMSMAMXMASAAAXSASMMMAXSAAAAAAMXSAMXMMMMMAAAAAAAAAAAA\nMSMMMSXMXXAXMSAXMASMXSMMASMMXXMAMXXSSSMSXXXXAAAAXSAMSSSMMXMSAMXMMMAMAMAMXSXMMASXMMAMMXMAMXMXXMAXMMMSMMMAXMASAMSAMMSMMMAMASMMMSMSMMXSMMXMMSSS\nMAXAMSMSSXSAAMASMXSAASXSASAAAXSSMSMMAAAXXXXSSMXSMSMMMXAXAMXXASXMAMASAMAXMMAMSMSAMSSSMASAMMMXMXXSAMAAAXXXMMXMXMXAMXAAAMASAAAMXAAXAXXMXSMSMAAX\nSASXAXASAAMXMASMXAMMMSAMXSMMXXAAASMMSMMMMXXMAXAMMXMAXSMMMMMSXMASASMXAMMMAMAMSAMXMAMAXASXSAMXMAXMAMSSSMMXMXXMXMSSMXMMASAXMSXMMMMMSMXXAXAAAMMM\nMASXMMMMMMMAMSMMXXSMAMAMMXMAXMMMMMAMASXAMXSSSMMSASXSXMMXAAXSMSAMXMASXMSASMASMAMAMXSAMXSMXASAMSMSAMAMAASAMSXMAAAXMASMASAXMMMMASAMAASMMMSMSAMS\nMAMMXAXAXXSAMAAAAMXMASAMSAMXSSXAAAMMAMSASAMXAAAAXMAMXAASXSMXAMSSXMASAASAMSXMMAMXSAMXSXSASXMASAASMMAMSAMASAASMSMXSASMAMAMAAMSASASMSXAAAXSXMSX\nMMSASMSMSASXSSSMMAMSXSASMXMXSAMSSSXMXXSXMXSSSMMSSMXMAMASAAMMXMMSXMSSMMMSMXXMAXSAMXXSAMXXSSSSMMXMXSSMXMSMMMXMMAMXMXSMASMSMXMMASMMXMMSMSSMMSSX\n"

Day4.part1(input) |> IO.inspect(label: :day4_part1)
Day4.part2(input) |> IO.inspect(label: :day4_part2)
```

```elixir
defmodule Day5 do
  def parse(input), do: for(p <- String.split(input, "\n\n"), do: AOC.int2d(p, ~r/[|,]/))

  def sort(u, rs), do: Enum.sort(u, &([&1, &2] in rs))

  def mid(u), do: Enum.at(u, div(length(u), 2))

  def part1(input) do
    [rs, us] = parse(input)
    for u <- us, s = sort(u, rs), u == s, reduce: 0, do: (acc -> acc + mid(s))
  end

  def part2(input) do
    [rs, us] = parse(input)
    for u <- us, s = sort(u, rs), u != s, reduce: 0, do: (acc -> acc + mid(s))
  end
end

input = "83|94\n97|41\n97|59\n35|79\n35|41\n35|84\n92|57\n92|97\n92|22\n92|23\n89|17\n89|95\n89|14\n89|94\n89|74\n52|39\n52|37\n52|81\n52|97\n52|12\n52|78\n87|35\n87|21\n87|58\n87|13\n87|52\n87|14\n87|53\n93|71\n93|77\n93|12\n93|69\n93|16\n93|94\n93|74\n93|83\n69|47\n69|92\n69|77\n69|28\n69|83\n69|94\n69|42\n69|31\n69|27\n42|23\n42|41\n42|37\n42|86\n42|54\n42|79\n42|81\n42|21\n42|53\n42|75\n25|58\n25|92\n25|53\n25|94\n25|13\n25|12\n25|17\n25|31\n25|19\n25|71\n25|95\n94|87\n94|14\n94|92\n94|35\n94|99\n94|54\n94|27\n94|52\n94|22\n94|24\n94|95\n94|17\n14|86\n14|24\n14|84\n14|99\n14|21\n14|13\n14|39\n14|35\n14|79\n14|54\n14|23\n14|33\n14|53\n57|86\n57|19\n57|16\n57|97\n57|74\n57|81\n57|93\n57|77\n57|78\n57|37\n57|15\n57|67\n57|46\n57|83\n99|41\n99|67\n99|77\n99|89\n99|78\n99|15\n99|81\n99|46\n99|79\n99|97\n99|59\n99|84\n99|83\n99|86\n99|23\n58|75\n58|13\n58|21\n58|95\n58|39\n58|52\n58|42\n58|54\n58|86\n58|93\n58|37\n58|99\n58|53\n58|31\n58|97\n58|22\n31|53\n31|84\n31|95\n31|86\n31|23\n31|93\n31|99\n31|46\n31|21\n31|24\n31|81\n31|57\n31|79\n31|35\n31|97\n31|22\n31|67\n37|19\n37|94\n37|41\n37|59\n37|67\n37|16\n37|14\n37|47\n37|78\n37|12\n37|15\n37|46\n37|75\n37|81\n37|71\n37|89\n37|74\n37|87\n79|81\n79|37\n79|86\n79|94\n79|75\n79|59\n79|47\n79|77\n79|97\n79|16\n79|12\n79|69\n79|78\n79|89\n79|46\n79|57\n79|15\n79|67\n79|41\n74|87\n74|19\n74|42\n74|27\n74|21\n74|24\n74|35\n74|54\n74|22\n74|52\n74|17\n74|84\n74|33\n74|28\n74|58\n74|92\n74|31\n74|71\n74|13\n74|95\n22|86\n22|84\n22|35\n22|41\n22|57\n22|81\n22|69\n22|99\n22|79\n22|37\n22|46\n22|59\n22|67\n22|78\n22|25\n22|23\n22|75\n22|97\n22|77\n22|52\n22|47\n84|75\n84|94\n84|47\n84|25\n84|78\n84|86\n84|67\n84|41\n84|59\n84|69\n84|89\n84|97\n84|77\n84|15\n84|79\n84|81\n84|93\n84|37\n84|46\n84|39\n84|23\n84|12\n12|95\n12|19\n12|53\n12|71\n12|83\n12|31\n12|92\n12|14\n12|74\n12|33\n12|15\n12|24\n12|22\n12|28\n12|16\n12|87\n12|42\n12|58\n12|27\n12|94\n12|17\n12|54\n12|13\n33|99\n33|37\n33|17\n33|22\n33|39\n33|21\n33|42\n33|95\n33|54\n33|53\n33|79\n33|52\n33|93\n33|31\n33|35\n33|75\n33|24\n33|23\n33|84\n33|58\n33|86\n33|13\n33|97\n33|57\n81|94\n81|33\n81|74\n81|14\n81|47\n81|67\n81|19\n81|13\n81|15\n81|27\n81|69\n81|78\n81|16\n81|25\n81|58\n81|87\n81|71\n81|89\n81|92\n81|28\n81|12\n81|83\n81|59\n81|77\n39|57\n39|74\n39|77\n39|46\n39|37\n39|78\n39|41\n39|94\n39|86\n39|93\n39|47\n39|15\n39|75\n39|97\n39|83\n39|25\n39|81\n39|67\n39|69\n39|23\n39|89\n39|12\n39|79\n39|59\n17|53\n17|69\n17|35\n17|41\n17|22\n17|84\n17|78\n17|81\n17|39\n17|21\n17|75\n17|77\n17|57\n17|37\n17|59\n17|67\n17|23\n17|97\n17|46\n17|86\n17|52\n17|79\n17|99\n17|93\n95|97\n95|79\n95|22\n95|17\n95|59\n95|39\n95|69\n95|81\n95|46\n95|41\n95|67\n95|75\n95|86\n95|21\n95|53\n95|23\n95|37\n95|93\n95|99\n95|78\n95|52\n95|57\n95|84\n95|35\n54|75\n54|37\n54|22\n54|67\n54|79\n54|21\n54|53\n54|52\n54|97\n54|99\n54|93\n54|81\n54|23\n54|17\n54|69\n54|84\n54|46\n54|39\n54|86\n54|78\n54|35\n54|95\n54|57\n54|41\n47|83\n47|14\n47|13\n47|28\n47|12\n47|17\n47|71\n47|58\n47|87\n47|74\n47|27\n47|33\n47|92\n47|25\n47|54\n47|16\n47|24\n47|95\n47|94\n47|15\n47|31\n47|42\n47|89\n47|19\n41|16\n41|78\n41|12\n41|87\n41|92\n41|25\n41|89\n41|69\n41|94\n41|46\n41|59\n41|83\n41|15\n41|19\n41|81\n41|67\n41|14\n41|74\n41|33\n41|27\n41|77\n41|28\n41|71\n41|47\n67|71\n67|94\n67|59\n67|15\n67|25\n67|16\n67|69\n67|12\n67|33\n67|13\n67|58\n67|89\n67|87\n67|47\n67|42\n67|92\n67|83\n67|14\n67|27\n67|19\n67|77\n67|78\n67|28\n67|74\n77|14\n77|94\n77|92\n77|13\n77|83\n77|33\n77|24\n77|42\n77|89\n77|16\n77|31\n77|12\n77|19\n77|58\n77|74\n77|87\n77|71\n77|28\n77|27\n77|54\n77|25\n77|15\n77|95\n77|47\n15|53\n15|54\n15|33\n15|87\n15|17\n15|52\n15|74\n15|71\n15|35\n15|58\n15|27\n15|13\n15|14\n15|21\n15|19\n15|94\n15|16\n15|24\n15|22\n15|42\n15|95\n15|28\n15|31\n15|92\n78|42\n78|14\n78|87\n78|28\n78|69\n78|74\n78|16\n78|31\n78|89\n78|83\n78|77\n78|58\n78|92\n78|12\n78|19\n78|27\n78|33\n78|47\n78|71\n78|13\n78|59\n78|15\n78|94\n78|25\n71|33\n71|28\n71|95\n71|86\n71|52\n71|24\n71|92\n71|99\n71|79\n71|22\n71|35\n71|21\n71|39\n71|57\n71|97\n71|31\n71|54\n71|17\n71|42\n71|23\n71|53\n71|13\n71|58\n71|84\n23|47\n23|77\n23|12\n23|25\n23|87\n23|94\n23|78\n23|89\n23|37\n23|75\n23|15\n23|59\n23|16\n23|74\n23|41\n23|81\n23|69\n23|83\n23|93\n23|67\n23|46\n23|27\n23|19\n23|97\n13|37\n13|54\n13|99\n13|17\n13|95\n13|41\n13|75\n13|79\n13|42\n13|57\n13|22\n13|31\n13|97\n13|23\n13|35\n13|39\n13|24\n13|86\n13|46\n13|52\n13|93\n13|84\n13|21\n13|53\n28|37\n28|93\n28|13\n28|21\n28|79\n28|97\n28|39\n28|24\n28|33\n28|42\n28|54\n28|31\n28|23\n28|86\n28|17\n28|35\n28|95\n28|57\n28|58\n28|84\n28|22\n28|99\n28|53\n28|52\n16|27\n16|14\n16|87\n16|92\n16|33\n16|53\n16|39\n16|54\n16|24\n16|22\n16|52\n16|13\n16|71\n16|84\n16|58\n16|21\n16|99\n16|31\n16|95\n16|19\n16|17\n16|42\n16|28\n16|35\n75|69\n75|28\n75|27\n75|25\n75|47\n75|16\n75|19\n75|67\n75|15\n75|59\n75|89\n75|14\n75|46\n75|94\n75|74\n75|12\n75|81\n75|78\n75|41\n75|71\n75|92\n75|77\n75|83\n75|87\n27|17\n27|22\n27|52\n27|33\n27|99\n27|35\n27|54\n27|42\n27|84\n27|79\n27|71\n27|87\n27|53\n27|57\n27|28\n27|58\n27|39\n27|13\n27|24\n27|92\n27|95\n27|21\n27|31\n27|14\n21|78\n21|97\n21|77\n21|86\n21|79\n21|46\n21|69\n21|37\n21|39\n21|81\n21|25\n21|35\n21|59\n21|23\n21|57\n21|84\n21|75\n21|12\n21|47\n21|93\n21|83\n21|99\n21|67\n21|41\n53|75\n53|79\n53|77\n53|52\n53|97\n53|67\n53|81\n53|57\n53|22\n53|47\n53|78\n53|99\n53|86\n53|84\n53|35\n53|37\n53|69\n53|23\n53|46\n53|21\n53|93\n53|41\n53|59\n53|39\n86|94\n86|75\n86|89\n86|25\n86|74\n86|15\n86|93\n86|27\n86|78\n86|81\n86|77\n86|97\n86|59\n86|41\n86|83\n86|37\n86|69\n86|19\n86|16\n86|47\n86|67\n86|23\n86|46\n86|12\n59|92\n59|16\n59|12\n59|83\n59|31\n59|14\n59|25\n59|74\n59|33\n59|28\n59|15\n59|24\n59|94\n59|27\n59|87\n59|58\n59|89\n59|19\n59|54\n59|42\n59|77\n59|13\n59|47\n59|71\n46|16\n46|47\n46|89\n46|74\n46|67\n46|14\n46|19\n46|92\n46|25\n46|94\n46|81\n46|15\n46|71\n46|83\n46|12\n46|28\n46|78\n46|69\n46|58\n46|33\n46|27\n46|77\n46|87\n46|59\n24|79\n24|21\n24|93\n24|78\n24|52\n24|46\n24|17\n24|39\n24|84\n24|67\n24|86\n24|97\n24|53\n24|95\n24|81\n24|22\n24|57\n24|35\n24|75\n24|54\n24|37\n24|99\n24|23\n24|41\n19|42\n19|87\n19|28\n19|39\n19|24\n19|14\n19|54\n19|21\n19|99\n19|31\n19|84\n19|53\n19|95\n19|79\n19|52\n19|17\n19|92\n19|35\n19|33\n19|58\n19|13\n19|71\n19|22\n19|27\n83|42\n83|87\n83|89\n83|53\n83|24\n83|16\n83|52\n83|58\n83|95\n83|54\n83|14\n83|28\n83|31\n83|22\n83|92\n83|74\n83|15\n83|33\n83|19\n83|13\n83|71\n83|17\n83|27\n97|12\n97|19\n97|89\n97|87\n97|75\n97|15\n97|74\n97|81\n97|16\n97|69\n97|47\n97|14\n97|78\n97|46\n97|27\n97|67\n97|94\n97|37\n97|77\n97|83\n97|25\n97|93\n35|77\n35|93\n35|23\n35|78\n35|39\n35|86\n35|89\n35|99\n35|83\n35|46\n35|69\n35|12\n35|57\n35|59\n35|75\n35|67\n35|47\n35|97\n35|81\n35|25\n35|37\n92|53\n92|95\n92|24\n92|42\n92|39\n92|13\n92|79\n92|21\n92|86\n92|58\n92|54\n92|35\n92|33\n92|37\n92|84\n92|99\n92|52\n92|31\n92|17\n92|28\n89|19\n89|24\n89|52\n89|16\n89|15\n89|71\n89|33\n89|27\n89|42\n89|21\n89|53\n89|31\n89|28\n89|58\n89|92\n89|87\n89|13\n89|54\n89|22\n52|77\n52|69\n52|75\n52|86\n52|23\n52|93\n52|46\n52|57\n52|41\n52|84\n52|21\n52|67\n52|25\n52|35\n52|79\n52|99\n52|47\n52|59\n87|39\n87|92\n87|22\n87|54\n87|79\n87|71\n87|84\n87|33\n87|86\n87|95\n87|57\n87|42\n87|99\n87|17\n87|24\n87|28\n87|31\n93|81\n93|25\n93|19\n93|15\n93|92\n93|67\n93|87\n93|27\n93|41\n93|75\n93|89\n93|78\n93|46\n93|59\n93|47\n93|14\n69|15\n69|24\n69|13\n69|14\n69|59\n69|12\n69|25\n69|33\n69|16\n69|58\n69|71\n69|19\n69|87\n69|74\n69|89\n42|39\n42|99\n42|46\n42|57\n42|31\n42|24\n42|17\n42|97\n42|93\n42|95\n42|52\n42|84\n42|22\n42|35\n25|83\n25|89\n25|14\n25|28\n25|87\n25|15\n25|74\n25|16\n25|27\n25|42\n25|33\n25|24\n25|54\n94|19\n94|31\n94|21\n94|42\n94|33\n94|71\n94|58\n94|28\n94|13\n94|53\n94|16\n94|74\n14|42\n14|52\n14|92\n14|58\n14|31\n14|57\n14|95\n14|22\n14|71\n14|17\n14|28\n57|59\n57|12\n57|25\n57|94\n57|47\n57|41\n57|75\n57|89\n57|69\n57|23\n99|69\n99|47\n99|25\n99|57\n99|39\n99|93\n99|37\n99|12\n99|75\n58|79\n58|41\n58|35\n58|17\n58|23\n58|57\n58|24\n58|84\n31|41\n31|54\n31|39\n31|52\n31|17\n31|37\n31|75\n37|69\n37|93\n37|83\n37|25\n37|77\n37|27\n79|25\n79|83\n79|93\n79|23\n79|74\n74|14\n74|99\n74|53\n74|16\n22|93\n22|21\n22|39\n84|57\n84|83\n12|89\n\n13,42,54,22,37\n19,24,74,71,22,53,16,94,95,33,27,15,54,14,87,31,13,17,89\n89,15,74,16,27,14,33,58,13,42,24,54,95,22,52\n15,94,74,19,92,58,13,42,24,54,95,17,53,22,21\n78,69,59,77,47,25,12,83,89,94,74,16,19,27,87,14,71,92,28,33,58,13,42\n67,86,41,69,35,59,39,83,47,37,25,57,97\n99,39,57,86,23,97,37,75,41,46,67,69,59,83,89\n81,77,47,12,94,16,19,28,58\n53,22,21,35,99,39,79,57,86,23,97,93,75,46,67,78,77\n25,12,83,89,15,74,19,27,87,14,92,33,58\n22,53,57,52,95,79,24,97,39,81,46,41,84,93,35,54,23,67,21,17,99,37,75\n81,24,57,17,54,23,35,99,37,31,22,84,46\n95,53,22,52,39,23,97,37,93,75,46,81,67,78,69\n52,21,35,57,86,23,97,37,75,46,67,78,69,47,25\n81,59,78,75,89,57,67,25,83,12,41,69,16,74,97,94,93,37,15,23,46,77,86\n12,83,23,69,75,99,93,97,41,67,89,79,86\n21,79,24,22,39,28,95,13,33,35,86,84,31\n14,28,58,95,52,21,35,39,86\n54,46,84,57,78,21,37,39,99\n39,46,67,77,81,59,57,97,69,37,99,84,53,52,41,78,22,79,35,86,75,23,21\n92,28,33,58,42,31,24,54,95,17,52,21,35,99,84,39,79\n16,87,13,31,33,19,21,17,52,42,28,15,71,74,58,94,54,95,24\n37,93,81,67,59,74,16,27,87\n87,58,31,54,99,84,57\n39,42,53,93,31\n21,57,23,22,92,39,52,97,79,31,28,17,33,86,42\n37,77,84,79,52,22,67,97,78,47,75,93,39,57,81\n95,52,35,99,84,79,97,41,46,81,67,78,69\n67,46,81,78,47,94,79,15,93,25,97,12,23,39,75\n23,97,37,93,75,41,46,81,67,78,59,77,47,25,12,83,89,15,94,74,16,19,27\n46,39,59,47,75,69,86,57,21,37,12,41,23,35,99,77,81,79,97,78,25\n19,13,16,74,95,92,27,89,14,15,31,71,58,17,87,54,12,33,42,83,28\n13,12,19,92,16,94,83,47,87,59,42,27,78\n54,17,53,52,79,86,97,93,41,46,78\n97,84,69,86,81,23,21,52,47,37,78,75,59,41,22,57,67,99,35,39,46\n28,53,13,95,99,17,37\n94,74,16,19,27,87,14,71,92,33,58,13,42,31,54,95,53,22,52,21,35\n12,15,74,71,58,87,28,16,27,53,92\n93,94,12,71,87,83,77,47,41\n92,99,14,21,16,54,19,42,71,87,24,84,35,52,28,53,95,27,13,58,17,33,31\n46,47,93,16,59,97,83,27,37,69,87,25,12,78,67\n71,92,33,42,24,17,52,21,84,79,86\n22,86,69,59,47,41,75\n97,86,83,81,67,12,77,23,59,37,89,25,47\n19,27,28,42,52,99,39\n27,87,14,71,92,28,33,58,13,42,31,24,54,95,17,53,22,21,35,99,84,39,79\n15,94,74,16,19,27,14,71,92,28,33,58,13,42,31,24,54,95,17,53,22,52,21\n21,39,23,46,77,47,12\n93,75,81,67,78,69,77,47,25,12,83,89,15,94,74,19,27,87,14\n39,79,57,86,23,97,93,75,41,46,67,78,69,59,77,25,83,89,94\n52,58,19,28,27,94,95,92,89,13,31,87,33,42,15\n46,78,93,17,52,21,95,41,57\n19,71,33,54,95,53,84\n67,78,69,59,47,12,83,89,15,94,74,19,28,58,13\n22,52,35,99,79,97,37,75,41,78,59\n99,84,39,79,57,86,23,97,37,93,75,41,46,81,67,78,69,59,77,47,25,83,89\n78,69,59,47,25,12,83,89,15,74,16,27,87,14,92,28,33,58,42\n57,86,23,37,93,75,41,46,81,67,78,59,77,47,25,12,83,89,15,74,16\n81,39,95,21,99,67,78,41,23\n37,12,59,83,79,75,99,57,41,86,25,77,78,35,67\n15,28,95,42,83,33,14,19,24,12,53\n84,81,41,86,97,67,57,35,46,52,23\n23,33,17,84,22,71,52,42,39\n17,53,22,52,35,84,39,79,57,86,23,97,37,93,75,81,67,78,59\n46,78,81,41,71,89,19,67,92,28,15,27,77,47,94,14,25,16,12\n37,93,46,78,77,87,14\n92,16,46,69,14,89,87,74,81,19,15,47,94,12,67,25,83,33,28,78,27,77,59\n86,79,52,21,69,78,67,39,81,23,99,77,84,41,59,35,47,37,97,46,93,25,57\n94,74,19,27,87,14,28,33,58,13,42,31,24,54,95,17,53,22,52,21,35\n94,74,19,27,14,71,92,28,33,58,42,24,54,95,17,53,22,52,21\n15,14,25,31,12,94,33,16,27,69,77,42,13,47,59,74,28\n67,78,69,25,89,94,19,27,87,92,28,33,13\n41,46,67,47,83,19,27\n95,17,53,22,52,21,35,99,79,57,86,23,97,37,93,75,41,46,81,78,69\n89,87,92,58,31,71,33,42,15,25,28,24,59\n25,83,74,16,71,28,13,42,24,95,17\n52,58,92,87,71,24,39,17,84,19,28,13,21,14,35,99,54,31,95\n97,37,75,81,67,78,69,59,47,12,94,16,87\n92,28,33,13,42,24,95,17,53,22,52,21,35,99,39,57,86,23,97\n71,28,33,58,13,31,24,54,17,53,52,99,39,79,57,86,23\n23,97,39,58,52\n21,46,37,75,79,52,84,81,23,35,31\n31,24,54,21,35,99,39,79,86,23,97,37,41,46,81\n77,47,12,89,15,94,74,16,19,14,92,28,33,58,42,24,54\n93,75,78,69,77\n33,59,94,19,92,89,47,27,13\n83,89,94,74,27,71,58,42,17,53,22\n19,25,89,14,92,15,42,83,24,74,59,33,28,77,31,47,13,94,12,27,16\n79,23,37,31,86,17,95,39,75,35,58,54,84,42,97,22,53,21,57\n92,22,52,15,54,71,19,27,16,31,13\n12,83,74,28,33,58,53\n33,13,42,31,24,95,53,52,21,35,99,84,79,23,97,37,93\n77,83,15,27,28,33,42\n15,89,59,94,77,83,47,75,46,37,41,69,12,74,19,27,93,16,97,78,81,67,23\n22,21,35,99,39,23,37,41,46,81,67,78,69,77,47\n69,47,25,12,94,74,16,19,87,14,71,28,33,58,13,42,31\n39,86,97,93,41,46,69,77,47,12,89,15,94\n41,46,15,94,71,92,28\n87,78,27,94,12,14,16,33,28,47,19,15,69\n84,39,57,23,97,37,93,41,81,67,78,59,47,25,15\n79,89,77,67,74,94,12\n25,89,27,71,42,54,17\n24,21,31,87,28,33,71,52,74,27,17,22,42\n12,15,27,14,71,92,42,31,53\n93,23,46,75,37,67,17,99,84,35,57,52,95,86,54,53,81,79,78,41,97,21,39\n89,59,19,31,87,16,28,12,13,47,27,94,24,42,14,74,25\n84,57,59,69,93,23,21,12,78,41,25,77,35,99,75,47,67,97,86,37,39,81,46\n16,19,27,87,14,92,28,33,58,13,42,31,24,95,17,53,22\n77,15,74,16,14,92,28\n69,59,25,12,83,89,15,16,19,27,87,71,28,13,31\n84,37,47,59,93,46,41,69,25,57,21,78,12,75,77,81,79,97,23,39,67\n92,58,31,24,95,52,21,84,97\n16,37,41,14,27,59,77,81,75,83,74,47,15\n78,12,27,71,58,14,89,67,19,83,16,15,59,28,69,47,92,81,94\n57,86,23,97,37,93,75,41,46,81,67,78,69,59,77,47,12,83,89,15,94,74,16\n46,16,15,23,67,89,94,27,77,69,97,47,81\n52,84,79,57,97,67,25\n35,99,84,79,86,41,46,81,67,78,59,77,47,12,83\n14,71,33,42,54,21,99,84,86\n69,77,81,57,21,59,53,52,86\n16,27,14,71,92,58,13,42,22,21,84\n93,41,81,67,78,69,77,25,12,83,89,15,74,16,19,27,87,14,71\n84,17,31,92,99\n35,81,84,57,46,79,97,39,99,86,54,95,21,17,23,67,52,53,37,78,41,22,75\n22,52,99,39,79,57,86,23,97,37,93,75,41,46,67,78,69,59,47\n13,42,31,54,95,17,53,22,52,21,35,99,84,39,79,57,86,37,41\n74,16,19,71,92,28,33,58,13,42,31,24,54,95,17,52,21,35,99\n87,71,92,58,13,42,31,24,54,95,53,22,52,21,35,99,84,79,57\n78,69,59,77,83,89,15,94,16,19,87,14,71,28,58,13,42\n75,46,81,78,77,12,83,89,15,94,74,16,19,27,14\n54,94,13,53,83,87,12,71,33,15,14,58,74,24,17,42,95\n17,53,22,21,99,79,23,97,37,75,46,81,78,69,59\n41,22,93,99,84,23,67,46,39,79,81,75,37,35,57,17,24\n81,23,41,37,86,75,83,79,77,89,15,39,25,97,93\n17,52,54,37,75,41,97,42,46\n15,83,87,89,97,69,77,37,25\n86,22,53,75,93,95,99,31,35,23,46,37,81,54,21,57,79,97,52,39,84,41,17\n86,39,79,54,21,31,22,99,42,24,13,58,35,84,52,37,33,23,95\n24,84,79,41,46,81,67\n83,94,92,42,54\n24,54,53,52,21,99,84,79,57,86,97,41,67\n33,58,54,83,17,31,28,71,14,25,13\n13,42,31,54,95,53,52,21,35,99,39,79,86,23,37,75,41\n99,84,39,57,86,23,37,75,46,78,69,59,77,25,12\n86,23,97,93,75,41,78,59,77,47,12,83,15,16,19\n77,47,83,89,15,94,74,16,19,27,14,71,92,28,33,58,13,42,31,24,54\n47,25,12,83,89,94,74,16,19,27,87,14,71,92,28,58,13,42,31,24,95\n74,16,19,87,14,71,33,58,13,42,24,54,95,17,53,52,21,35,99\n46,87,14,92,15,59,69,33,77\n22,16,89,95,54,27,94,17,71,53,24,87,52,33,15\n75,41,46,81,69,59,77,47,25,12,89,15,94,74,16,19,27,71,92\n13,28,69,78,42,94,47,83,25\n86,54,33,42,35,22,71,57,17,13,14\n95,21,24,39,53,81,67,84,75,22,79,52,46\n75,86,93,78,69,46,81,22,23,97,39,52,35,95,57,21,79\n21,35,99,84,39,79,57,86,23,37,93,75,41,81,78,69,59,77,47,25,12\n58,24,15,95,22,28,54,92,42,52,87,53,16,14,33,13,94,19,27\n83,47,84,59,46\n14,71,92,28,58,13,42,24,54,95,17,22,52,21,99,84,39,79,86\n71,92,33,58,54,95,22,52,21,84,79\n58,13,42,54,95,53,22,21,35,79,23,93,75\n84,39,79,57,86,23,97,37,93,75,41,46,81,78,69,59,77,47,25,12,83\n67,84,46,39,78,41,47,79,23,86,75,59,57\n14,19,59,25,67,28,94,77,81,16,78,83,89,74,41,69,15,92,87,71,27,12,47\n52,35,99,39,79,86,97,37,93,75,41,81,78,69,59,47,25\n37,93,75,41,46,81,67,78,69,77,47,25,12,83,15,74,16,19,27,87,14\n92,33,58,13,95,17,53,22,52,21,84,39,79,57,97\n28,94,24,54,16,83,22,17,74\n13,57,86,21,39,42,53,24,41\n83,25,86,94,23,12,15,75,41,77,69,78,89,81,79,37,74\n53,22,37,93,75,46,81,67,78,69,77\n92,87,17,52,27,54,53,95,71,24,74,21,16,33,58,94,14,31,22,19,35,28,13\n31,79,22,17,53,41,42,75,84,86,97,54,93,23,21\n79,52,84,53,92,95,71,21,28,54,39,13,31,17,86\n27,42,25,28,95,92,47,33,16,71,12,87,58\n52,21,99,84,39,86,37,75,41,46,81,67,78,59,25\n27,12,24,19,92,16,74,14,31,94,87,54,47,15,95,33,83,42,89\n74,92,28,33,58,54,22\n53,35,84,57,86,97,93,75,41,81,78,59,77\n22,52,99,84,23,37,81\n31,54,81,79,22,97,21\n42,47,13,25,74,15,58,69,19\n92,33,58,42,31,24,17,53,22,35,99,84,39,86,97\n31,24,95,17,22,21,23,97,37\n41,75,78,81,99,21,52,79,53,69,59,77,39\n57,93,59,99,84,17,35,69,21\n92,31,25,24,58,59,71,87,27,94,16,14,15,28,12,47,89,19,33,13,77,74,42\n75,41,46,81,67,78,69,59,77,47,25,12,83,89,15,94,74,19,27,87,14,71,92\n75,46,67,78,69,59,77,47,83,89,15,16,27,87,14,71,92\n21,35,99,84,39,79,57,86,23,93,75,41,46,81,67,78,69,59,47,25,12\n35,86,75,46,67\n81,94,78,27,23,97,47,77,16,19,89\n81,67,78,69,59,77,47,25,83,89,15,94,74,16,27,87,14,71,92,33,58\n47,71,94,92,87,25,12,67,27,15,77,14,83,59,16,78,74,75,81,69,41,19,89\n35,99,84,79,97,37,93,75,78,69,47,12,83\n23,81,67,78,25,12,27\n86,17,54,35,81,52,31\n99,24,14,39,79,21,17,87,54,53,92,58,52,28,27\n52,21,35,99,39,79,93,69,25\n41,27,97,89,94,47,93,19,81,16,77,75,74,25,12,67,83,69,23,78,37\n"

Day5.part1(input) |> IO.inspect(label: :day5_part1)
Day5.part2(input) |> IO.inspect(label: :day5_part2)
```

```elixir
defmodule Day6 do
  import AOC

  def back({a, b}, {c, d}), do: {a - c, b - d}

  def go(m, p, d) do
    m = %{m | p => "X"}
    q = forward(p, d)
    r = right(d)
    case m[q] do
      nil -> Enum.count(for {_, "X"} <- m, do: 1)
      35 -> go(m, forward(p, r), r)
      _ -> go(m, q, d)
    end
  end

  def extend(m, p, d) do
    case m[p] do
      35 -> m
      nil -> m
      _ -> extend(%{m | p => d}, back(p, d), d)
    end
  end

  def toc({-1, 0}), do: ~c"^"
  def toc({0, 1}), do: ~c">"
  def toc({1, 0}), do: ~c"v"
  def toc({0, -1}), do: ~c"<"
  def toc(c), do: c

  def print(m) do
    {h, w} = Enum.max(Map.keys(m))
    for i <- 0..h, do: IO.puts(for(j <- 0..w, do: toc(m[{i, j}])) |> List.to_string())
  end

  def forward({i1, j1}, {i2, j2}), do: {i1 + i2, j1 + j2}

  def right({-1, 0}), do: {0, 1}
  def right({0, 1}), do: {1, 0}
  def right({1, 0}), do: {0, -1}
  def right({0, -1}), do: {-1, 0}

  def cycle4(m, p, d) do
    q = forward(p, d) # next position one step forward
    case {m[p], m[q]} do
      {^d, _} -> true # previous visited and same direction, cycle + 1
      {_, nil} -> false # out of bound, exit recursion
      {_, 35} -> cycle4(m, p, right(d)) # obstacle, direction turn to right, 35 == '#'
      _ -> cycle4(%{m | p => d}, q, d) # mark current position to be the direction
    end
  end

  def go4(m, p, d, cycles) do
    q = forward(p, d) # next position one step forward
    case m[q] do # value of position
      nil -> cycles # out of bound, exit recursion
      35 -> go4(m, p, right(d), cycles) # obstacle, direction turn to right, 35 == '#'
      46 ->
        cycles = case cycle4(%{m | q => 35}, p, d) do
          true -> [q | cycles]
          false -> cycles
        end # put obstacle in front and check cycle
        go4(%{m | p => d}, q, d, cycles) # mark current position to be the direction
      _ -> go4(%{m | p => d}, q, d, cycles) # mark current position to be the direction
    end
  end

  def part2(input) do
    m = input |> s2map()
    p = for({p, c} <- m, c == 94, reduce: nil, do: (_ -> p)) # start position 94 == '^'
    go4(m, p, {-1, 0}, [])
    |> Enum.uniq()
    |> Enum.sort()
    |> length()
  end

  def part1(input) do
    m = input |> s2map()
    p = for {p, c} <- m, c == 94, reduce: nil, do: (_ -> p)
    go(m, p, {-1, 0})
  end
end

input = "..#.....##......#............#..................................#.....#..............#................#.........................#.\n..........................................................................................................#..........#...#.......#\n..................#....................#.......................................#.....#....#............#.......#..................\n......#...#..##....................................................................#...#.......#..........#..#.....#..............\n..#..#.#.............#.#.........#.........##..................#..............#..........................#........................\n#..........#.................#..........#...............................#..#.................#.......##..##..#.#..................\n......................#......................................................#........................#......................#....\n........................#.#.....................................#..............................#.......#.............#.....#......\n#.................#...#......#..........#.......#.....#............................................#...........##.........#.....#.\n...........................................#.....#............##...............#..............................#...................\n.....#..............#......................................#..........#............#..................##...............#......###.\n..............#..#.....................................##................#............................#............#......#.......\n#........#...................................................#..........................................#.........................\n.................................................................................#................................#....#..#..#....\n.............................#.###.........#.#...............#..........................................##........................\n......................................................................................................................#.........#.\n...............#............#............#...#.........#............#.............................#.#........................#....\n........................#...............#...............#........#.........#................#....#.#....................#.........\n........#...............#...........................................................................................#.............\n.................#..........................................................#.....................................................\n........#.#.#...................#..#.......#...........#..#............#......#.....................#.....#.........#..#..........\n..#.......#..................................................................................................#......#.............\n................##...##......................#....................................................#..............................#\n............#......................................#...........................#.#...#...............#.....................##.....\n..........#...................#.....................#...........................................##................................\n.#.......................#...............................................................#........................................\n...................................................................#..#................#.....#....................#...............\n...........#...........................................................#..........................................................\n.....#....#..#..........................................................#..................#.....................##...............\n...#................................#.....#...................#...............##...........#..............#.......................\n.......##.....#.............#..#.......................................................................#......................#...\n......................................#....#.............................................#...#....................#...............\n.......#.......#...............#..#.....#..............................#.#......#...............#.................................\n......................#.......#.......#..........................................................#................#...........#...\n..............................#........................#.......#..#...............................#...............................\n...........................#..........#..##.......................#................#..............................................\n..............#............#...##........#.................................#................#....#........................#..#....\n..............#.........#............................................#.............#......#......#.#....#.........................\n.......................#.................................#..#..#..#..............................................#................\n........................###..#...............................................................#.........#................#......#..\n#........................................................................................#........................................\n........................................#..............................##.....#.........................#...........#.............\n.............#.........#...#................#..#..........#.....#...........................................................#.....\n.......................................#......#.............................#.........#................#..........................\n..........................................................#......................#...........#...#.......#........................\n#.....................................#.#...#.............................................................#...........#........#..\n............................#..................................................................................#............#.....\n#.................#.................................................................#..............#...................#..........\n........#...................................................................#...............................................#.....\n.................#...#..................#.............................................................#.......#...................\n...#.....#.................................................................................................#..........#...........\n..........#...................................#....#................#......#........................................#.......#.....\n.....................................#...............#................................................................#...........\n.#............#................................................................#.............................................#....\n...........#.........#.....................#...........#^.......................#.....................#..........#................\n.....#........#.................................................................................................#.......#.........\n..........#..........................#.......#......................#..............................#....#......................#..\n...#.........................#.................#....#........#....................................................................\n...............#...#........................................#................................#....#........................#.#....\n...........#.......................................#......#....#.......................................................#.......#..\n#.........#...............#..#..#..........#..............#...........................#...........#.....................#.........\n...................#.......................................................#......................................................\n.............#..............................................#.......................................#.........#...........#......#\n....#......#...#.................................#.....#......#.................................#.................................\n...............#...............#......................................................................#...........................\n.......................#.........................................................................................................#\n.............................#............................................................................#.......................\n...................#..#.........#...........................#......#...............#......#.......................................\n...#....................................#...................#..#...........................#............#...............#........#\n...................#................................................................#............##...............................\n........................#.#...................#.....................................................................#...#.........\n...................#......#.......#.#......................................................#...............#......................\n....#...........................#................#.............................#..#....................#........##.....#..........\n.........................#......................................................#.#......................................#........\n.........#.............#.................#........................................................................................\n.#.#.......#..#....#.......#...#..#......................................................................#.#......................\n..#.................#............................................................................#................................\n.#................................#...............................................................................................\n..........#............#..............................................#...#...............##...............#..................#...\n................................#.........................#.......................................................................\n........................................................##.......#........................#.....................#.................\n......#......................................................#......#.........#........................................#.......#..\n...........................................................#............#....#......#.............................................\n..................................#...................................................#.................................#...#.....\n.......#...#..........#............#.......#........................................#..#.................#........................\n....................#........................................#........#...........................................................\n.................................##..#............#.................................#.............#..................#....#.......\n.#.................#..........#.....#...........#.......................................................#...................#.....\n........................#.........................................................................................................\n...#..........................................#...........................#.................................#.....................\n............#......................................................#.................................#.........#..............#...\n.............#........##.........#..................#...#.............#......#....##................#................#............\n..................#...........................................................................................#.................#.\n.....................#..#..#....................#........................#.........#................................#.............\n..............................................#...................#............................#..............................#...\n.......................#.#...................................#.............................#...................................#..\n................................#...........#.............................#.............#.........#..............................#\n...........................#................................#...................................................#.....#...........\n..........#..........#.....#..........#..#............#..........#.................#.......#.......#........................#....#\n...#.......#...#..............................................................................................#......#......#.....\n...........#......................#..#.................#......#.........#.....#.............#............##................#....#.\n.......#...........................................#..................#...............#.............................#.............\n....#.......#.................................#..................................................................#................\n..#..................................#...#............................#.........#....#..........#............................#....\n....................................................#.................#...........................................#...............\n............#......................................#.........#..................#.....#.#.#.#..#..................................\n#..............#.......#...#.#..............#.....#.#.............................................................................\n...........#.#.................................#...#........................................#................#.........#....#.....\n......#.........................................#.........................#...........................................#...........\n...#......#.................................#......#............................................................................#.\n...#.................#....##................#...........................................#.........#....#..........................\n...........#...#...#..................#...................................#......................................#......#.....#.#.\n...................................#....................#................#..................................................#.....\n................#.....................................#...........#......#........................................................\n..............................#......#..#..............................................##........#......#......................#.#\n#...........................#....#....##.....#...........................##..#...................#.....#........#.................\n..........#....#.#..................#..........#..#................#.................#..................................##.......#\n...................#.....................#......#...........................................................#..........#..........\n........#.....#.............................#..............................................#......................................\n......#............#.#.................................................................................................#..#.......\n.#.........#..................................................................................#....#...........#.................#\n........#.....#.......................#.........................................#...........................................#.....\n...................#.......#..#......#.................##......................................#...................#..............\n.............................#.................................#........#.......#..................................#.........#....\n....#....#..........#....###..#...................................................#...#................................#.......#..\n...................#...................................................#.......#....#........................#....................\n...#................#...........#.......................#.....................................#...#......#......#.................\n.......#........................#.........#.............................................................#...#...#.................\n....................#.........#..............................#..........................#....................#..#.................\n..#..........................#.#...................................#..................#..........#................#...............\n"

_input = ~S"""
....#.....
.........#
..........
..#.......
.......#..
..........
.#..^.....
........#.
#.........
......#...
"""

_input = """
.#..
#..#
#...
#...
#...
#...
.^..
..#.
"""

#Day6.part1(input) |> IO.inspect(label: :day6_part1)
#Day6.part2(input) |> IO.inspect(label: :day6_part2)
```

```elixir
defmodule Day7 do
  import AOC

  def eval1(g, [], r), do: g == r
  def eval1(g, [h | t], r) do
    with false <- eval1(g, t, r + h),
         false <- eval1(g, t, r * h), do: false
  end

  #def con1(r, h), do: int("#{r}#{h}") # slower
  def con2(r, h), do: r * 10 ** ceil(:math.log10(h) + 0.0001) + h

  def eval2(g, [], r), do: g == r
  def eval2(g, _, r) when r > g, do: false
  def eval2(g, [h | t], r) do
    with false <- eval2(g, t, r + h),
         false <- eval2(g, t, r * h),
         false <- eval2(g, t, con2(r, h)), do: false
  end

  def solve(s, eval), do: Enum.sum(for [g, h | t] <- int2d(s), eval.(g, t, h), do: g)
  def part1(s), do: solve(s, &eval1/3)
  def part2(s), do: solve(s, &eval2/3)
end

input = "187418: 8 1 32 1 3 7 700 2 6 8 9 9\n51480079: 88 650 9 8 1\n45694842: 2 9 227 6 1 5 4 382 1 5 2\n324153: 4 6 165 26 2 8 9 3 50 9\n28501243947: 66 18 84 68 6 926 78 7\n20763: 8 9 7 123 308 2 2 709\n1275: 40 5 6 75 1\n769249: 1 47 4 4 3 9 49\n464700680640: 94 7 26 7 917 9 6 5 392\n501133472: 3 901 3 9 3 979 557 15\n1408080699: 2 93 35 12 4 5 87 48 64\n257184: 4 68 8 6 116 72\n381878965: 727 5 1 56 28 6 67\n625: 79 5 41 488 13\n1382535550: 8 91 1 5 66 931 4 470\n543135657: 7 649 5 9 7 71 979 7\n69632: 7 51 8 2 963 8 6 3 701 9\n4087: 1 3 576 2 7 7 10 6 9 592\n6351: 21 298 4 2 84 3\n15702: 7 1 419 36 366\n89661885: 8 112 1 585 25 8 84\n266450902950: 65 7 59 2 57 968 9 9 71\n194394: 194 366 28\n972: 6 29 546 1 390\n1833720: 1 6 4 6 4 9 6 4 4 2 777 5\n7263349: 9 84 780 93 4 9\n94534: 781 12 8 9 797\n258695989: 582 14 4 246 129 421\n1371: 187 9 440 9 726\n1403130963: 45 547 2 6 4 8 70 22 2\n5172: 1 28 3 88 3 4 94 642 6\n240988525: 5 865 441 5 21 382 3 2\n212541850: 6 4 84 927 5 3 813 73\n9096239: 890 67 4 1 9 95 84\n482781: 635 1 1 95 8 5 8 5 7 58 7\n4540643307: 5 4 5 898 5 5 92 9 9 8 3 6\n46738900180: 976 706 17 58 57 4 70\n259616: 312 207 6 314 4\n174270594: 544 745 4 43 21 1\n23194043: 773 3 3 9 1 43\n2838182357: 28 381 81 1 1 357\n557952: 9 62 80 9 62 6 36 7 3 7 8\n82653627132: 8 507 7 6 565 6 5 6 7 6 3\n917397714: 9 173 97 71 4\n63564: 846 1 75 48 65 1\n16152750: 714 7 795 99 26 5 1 99\n64418: 6 86 4 4 92 7 18\n96932098: 5 46 19 320 98\n412070765: 318 3 4 69 5 313 3 2\n1986: 990 3 2\n10295: 6 3 940 826 687 322\n143356: 3 98 4 9 7 6\n264829968: 293 12 106 7 543 9 3 3\n73800979: 10 5 3 1 46 8 9 28 4 6 9 8\n2804772: 6 600 892 39 9 8 8 2 4 6\n300031: 8 3 55 545 31\n20008369743: 8 330 6 82 4 2 5 6 4 7 5 6\n13396057557: 8 76 91 17 220 4 4 7 7\n116812844776: 96 59 477 3 7 982 85\n1197286087823: 9 829 9 3 3 2 87 3 4 2 9 7\n288934843: 4 13 212 33 43\n12097735: 1 120 884 93 35\n2323: 4 7 129 250 654\n4452928: 18 97 1 472 24 82\n3693500: 9 825 56 494 4 89\n230650225261: 863 1 96 8 4 87 3 5 8 5 9\n6471: 76 73 898 8 17\n1137: 5 2 47 297 786\n368741: 8 458 113 2 1 3 7 1 90 2\n347319: 447 9 69 816 259\n6153742: 8 4 2 9 7 5 1 344 7 1 71 2\n2300212040: 6 7 7 7 55 15 727 15 56\n217743931: 24 3 234 718 18 379\n1143073502: 216 84 7 167 9\n1447474: 516 7 4 9 165 6 3 7 839\n24175: 481 3 8 49 70\n1198210: 69 633 7 2 845\n3200: 8 50 8\n7529214347: 376 46 5 34 9 40 387\n23264072: 279 730 556 4 83\n58517605: 959 305 61\n3694797: 647 68 9 47 51\n98762746: 7 980 6 27 46\n675: 3 6 4 7 15 30\n3302: 7 94 25 93 47 1 630 6\n50372628: 7 943 16 9 92 2 9 9 5 4 4\n546760284: 60 9 134 67 84\n48336753: 69 24 90 33 175 3\n327848: 6 607 90 8 60\n1099845: 461 9 60 39 45\n2913111: 5 726 190 8 761\n215712: 1 9 9 8 7 7 3 8 7 8 225 7\n187980: 2 9 32 2 23 78 2\n28105: 1 373 3 74 207\n13669642: 17 8 6 964 2\n7519900: 695 56 98 99 1\n52373979: 62 253 34 7 9 543\n244520658: 8 39 1 922 3 7 9 8 5 2 4 4\n761166846259: 702 80 5 73 375 271 9\n1710191: 6 84 90 95 27 164\n108219300: 6 669 5 3 4 8 96 3 7 2 7 5\n83418128640: 752 9 3 2 3 6 8 99 9 4 4 9\n31892804: 39 3 73 81 67 4\n42680000: 4 268 4 50 50\n23479827: 4 984 35 679 7\n210060261: 206 3 21 84 73 7 289 1\n3177: 47 3 71 5 457\n902503660: 6 44 763 56 93 6 254 7\n30198724521: 7 8 9 2 9 47 2 379 45 2 2\n2163: 746 2 19 85 518 49\n954304: 2 1 2 3 2 40 3 7 950 52 8\n5835456294: 30 7 48 396 292 2\n43320718: 456 95 2 8 4 434\n3308760: 5 302 5 42 52\n5796: 9 92 7\n25910231829: 3 67 706 3 1 832\n878427678805: 92 26 1 1 81 50 952 6\n1473321: 71 2 635 30 5 2 6 4 1\n8400848504: 9 6 96 56 84 8 2 3 100 4\n49322159387: 13 2 8 92 7 3 5 8 6 7 8 7\n684519833: 7 61 4 519 836\n191600640: 8 8 540 528 42\n311237: 631 9 486 9 8 15 165\n951160: 9 3 983 5 9 1 77 8 7 5 2 5\n59041208704: 98 4 6 11 987 99 9 6 8\n354018: 72 3 1 59 124 118 3 7\n35886127: 3 87 3 92 2 1 5 4 603 9\n701625: 77 9 8 62 3\n136802924: 958 425 7 7 2 3 2 47 1 4\n71282596: 6 54 22 259 6\n245520: 385 71 4 5 528\n3517169040: 8 5 5 8 125 7 530 7 9 76\n7792441765301: 778 7 2 7 9 2 365 9 4 14\n607622809527: 5 6 48 8 36 730 9 52 5 2\n842: 9 22 5 2 7 9 4 43 3 8 1 30\n1173375: 7 4 2 3 225 7\n3650074: 2 84 12 328 977\n3812606: 9 8 8 23 28 151 2 7 8 86\n17360: 3 820 1 7 3 18 3 4 1 7 1 2\n12405: 16 1 9 86 20 1\n66919866641: 211 8 6 44 5 9 8 7 9 1 4 1\n8013364: 58 157 88 8 4\n185974: 7 48 4 54 8 59 1 3\n565292571: 896 29 33 123 590\n471460: 556 24 7 116 500\n9804900: 24 54 270 87 70 46 7\n425: 2 9 6 25\n512403750: 9 91 84 6 625\n7303840435: 730 383 36 68 35\n44385941654: 45 63 8 215 364 2 1 50\n17793072: 1 86 3 2 406 28 517 9 4\n68567808019: 6 2 192 8 370 19 16 3\n16224908: 4 970 9 7 596\n9437: 5 938 7\n386334417: 696 6 94 59 3 2 3 4\n4935770786: 4 7 52 8 9 8 1 49 5 1 7 86\n926168190738: 9 260 7 7 2 26 1 90 738\n1086806: 7 5 51 5 656 80 6\n2131: 274 7 96 46 71\n3560: 20 70 840 60 591\n545: 4 11 9 379 79 1 63\n4101: 3 1 6 5 352 574 8 2 2 3 2\n40731: 93 86 503 991 690 4 3\n16841473152: 94 52 4 96 763 47\n404950: 71 83 419 77 623\n3500596447460: 1 323 6 7 7 58 2 9 7 46 2\n199362631126: 7 7 56 28 4 1 26 31 126\n1298121: 6 8 781 3 7 5 1 5 309 7 5\n33750: 30 3 34 90 57 33 3\n1048524: 29 69 524\n28241257580297: 713 5 978 5 81 802 97\n688232: 60 2 8 2 598 9 5 4 79 9\n4970: 9 1 8 1 7 2 60 8 5 460 3 7\n38071: 791 368 7 79 30 721\n20128402: 2 48 2 6 482 80 9 59 23\n97596756600: 435 466 95 724 7\n6525364319935: 3 684 636 863 987 5\n437787903: 8 114 4 4 91 9 9 3 8 9 1 3\n1457: 3 3 44 4 1\n293090: 5 241 283 6 53\n619297: 52 9 92 9 4\n962292: 765 10 95 31 478 4\n648387: 36 28 83 2 3 3 34\n466433: 424 110 3 3 1\n6967: 4 102 1 8 6 9 8\n3396540: 242 61 140\n3561767: 12 400 7 99 726 11\n979543: 1 8 7 250 87 260 3 6 2 5\n27988800000: 5 25 700 4 952 4 21\n133389: 241 6 54 3 6\n9533672: 89 631 25 479 69 514\n24714: 1 86 26 507 3 9\n9455893049: 28 5 7 7 888 6 3 4 2 4 1 9\n1224: 4 8 36 485 671\n2058747: 4 7 378 1 9 524 2 4 8 1 1\n8122: 5 47 60 205 2\n23657723657: 6 32 183 51 94 23 63 8\n1238563682: 618 2 4 5 32 6 5 9 4 6 82\n7039053: 9 367 213 366 3\n144999092: 8 8 31 41 2 9 96 87 2 9 9\n3416010: 400 854 2 2 5\n307549178: 782 6 9 5 5 963 3 3 683\n344179424889: 46 2 5 737 4 2 48 8 8 1\n55345590: 366 120 7 1 20 710 9\n38358188702684: 9 5 89 8 4 3 7 740 537 5\n7063729304401: 569 183 973 77 881\n12816555: 762 92 2 3 3 10 1 410 5\n9621: 94 2 21\n70948948: 6 4 1 9 8 178 1 4 6 264 2\n411358: 423 97 791 36 2\n3369019540: 56 617 2 975 7 38 41\n1504080630: 39 5 62 1 207 601\n779137845564: 37 101 8 21 3 1 5 564\n5800032: 309 677 4 6 98\n4168816845: 6 78 89 36 160 8 4 5\n2911: 4 5 56 2 255 31 385\n1142856906: 8 1 5 4 3 1 6 8 55 1 900 6\n5823576: 56 604 34 86 2\n6608969236: 5 5 6 2 86 3 3 1 3 9 236\n1328554651: 4 1 324 74 80 648\n4947149: 9 3 4 102 43 9 71 9 5 6 3\n239760188: 6 2 2 2 40 6 6 92 3 4 9 92\n1891987951: 4 2 82 465 5 33 968 7\n933744: 42 445 9 3 71 158 7\n15774: 556 3 578 7 5 44 3\n2945: 2 9 716 4 28 9\n392802448878: 6 98 5 5 4 4 1 70 4 1 93 6\n5644947: 3 26 1 2 80 40 9 112 35\n1490: 1 7 638 69 2 5 41 8 5 1 1\n210990: 8 63 99 4 30\n121980885: 3 27 1 271 5 9 3 9 1 9 5 3\n7300117: 79 8 15 13 769\n108410439: 542 2 10 1 350 89\n5184867: 948 53 94 103 53\n1127: 6 74 638 2 399 8\n455827: 91 5 827\n61760955: 9 49 4 4 2 71 80 5 433\n191368: 7 5 2 8 5 7 791 7 3 4 2 2\n567544412088: 963 9 736 76 39 8 88\n12146752: 709 2 3 8 76 1 28 5 9 7 6\n885889: 8 42 9 347 3\n1106: 43 67 6\n7202952: 405 8 5 355 2\n20562: 284 610 23 1\n191497654329: 824 50 83 9 1 7 28 2 9\n2808193: 767 4 1 61 5 1 3 52 3\n133955535: 3 8 2 601 818 1 2 7 645\n6752263840: 5 4 6 4 8 5 314 7 8 5 7 4\n313500: 469 4 56 11 6\n1110: 14 1 74\n15488: 95 4 1 26 2 6 7 3 5\n35418: 11 723 47 5 915\n391535: 7 403 953 1 486 319\n1388084: 724 71 27 92 65 7 3 9 1\n44009264785064: 55 137 833 73 813 3 8\n18867200: 3 4 99 7 6 8 383 51 8 16\n9612421: 6 2 34 6 553 7 362 959\n8117920: 267 4 11 691 52\n294154650: 29 409 6 46 49\n189788268: 3 18 4 6 65 6 38 1 6 5 6 3\n1676757: 75 4 69 81 51 6\n605176: 7 34 61 506 4\n539081638393: 33 146 33 974 506\n419239: 610 9 245 8 73\n21401: 7 5 57 5 26\n240460: 9 74 2 15 4 6 29 221 55\n153678511980: 7 204 810 542 237 7\n16223812320: 7 7 6 279 7 597 57 80\n175564935: 2 84 8 14 11 38 9 5 403\n6048: 5 2 7 29 91 4\n675100: 61 8 11 316 628\n1155949124: 477 411 8 76 737\n94353: 31 58 52 857\n1128071: 393 5 8 6 6 59 333 248\n4621214: 2 639 901 1 79 31 2 4 6\n26092259600: 53 195 2 981 280 50\n182162: 11 253 91 7 1 6 99 5 2\n4452230: 138 6 7 8 9 12 1 8 29 2 7\n314085244: 9 88 419 166 946\n2291933389799: 5 472 3 7 47 72 3 831 2\n1637032: 433 52 912 646 1 68\n8505: 3 6 929 96 31 17\n1051: 4 5 75 352 24\n53861: 91 51 712 33 1\n12176325: 6 3 773 9 5 35\n53550: 414 9 99 7 2\n76978: 2 84 50 8 4 44 66\n166020482: 73 1 8 684 41 2\n2994024: 19 816 8 3 56 5 8\n531: 9 2 39 7 89 6\n534784472: 2 3 1 9 95 9 60 58 3 4 72\n584932732319: 29 31 89 6 5 65 1 72 19\n4514: 9 35 11 58 45\n49509809: 76 41 91 983 2 87 21 2\n1404717811: 8 8 16 4 2 756 717 811\n2687382: 3 10 4 4 90 2 91 6 863\n339914973856: 713 68 41 37 26 7 435\n296058: 3 4 3 1 5 33 8 2 8 38 1 7\n67488804: 89 745 8 6 94\n1252695: 9 92 6 9 5 8 8 1 2 4 63 3\n27424: 8 47 60 8 925 1 99\n1943363853992: 1 200 2 46 8 5 159 88\n6294075553: 2 892 5 1 34 5 191 5 7 3\n9476: 1 2 37 338 23\n5001673: 4 2 2 3 5 9 8 2 7 991 4 92\n19: 10 1 1 4 5\n465093: 75 2 74 94 7 9 9 2 4 8 5 9\n1369373: 898 471 3 73 1\n1525: 23 2 61\n41257: 4 1 1 2 57\n6264: 30 96 7 7 6 84\n321300: 3 435 1 7 31 6 1 5 7\n1368: 98 57 2 6 4 9 971 68\n784450040: 9 76 199 62 2 374\n6835209: 9 1 436 905 2 8 6 5 206\n362124546: 88 29 796 7 8 9 2 2 9 2 3\n126885: 5 9 63 72 7 19 3\n5676536: 3 3 945 44 664\n29555174: 875 281 36 5 6 710 4\n1809145007: 289 626 497 3 7\n64764: 7 8 2 3 2 7 7 5 5 676 86 6\n327240: 12 594 3 9 1 20\n3945066: 9 73 5 6 65\n86424: 4 5 567 848 2 731 24\n52286469: 3 1 489 9 82 4 4 9 637 8\n4251579: 457 7 556 2 64 65 59\n229770: 65 60 874 46 5\n2700: 1 7 96 3 3\n198787972: 4 3 5 6 68 5 2 45 4 2 5 2\n10115: 77 5 231 5 5\n4303635: 1 14 782 9 69 595\n2678: 20 9 7 81 1\n145017912744: 99 4 783 107 9 47 93 9\n13034369: 5 7 43 6 5 3 375 49 4 73\n989: 84 92 8 5 687 94 7 8 4\n53545060811: 80 4 85 84 8 99 7 4\n230081372: 8 2 49 651 7 6 4 1 4 9 7 2\n58091386: 56 5 1 7 3 222 4 8 3 158\n48204: 3 461 91 333 47 26\n58448887252: 7 175 22 66 486 52\n197235: 410 9 48\n22386781689439: 956 7 65 6 2 8 6 943 9\n119340: 9 5 52 51\n563562323: 8 5 7 903 79 5 79 14 9\n52547762: 724 8 9 2 6 7 29 4 2 6 6 8\n227057993908: 99 6 26 82 199 192 52\n2700292479: 1 925 1 9 50 3 84 383 3\n119784: 7 3 2 79 7 6 6 6 20 53 1 5\n217977480: 91 3 6 8 2 980 81\n9559: 828 56 65 3 66\n134739247559: 10 8 4 6 4 9 1 3 9 675 59\n1284754815: 594 56 590 8 5 2 9 335\n6090685515: 2 60 2 758 9 8 4 5 87 9 5\n1352574963: 1 69 69 17 7 97 1 843 9\n2936812726: 42 4 6 174 317 2 716 7\n21: 2 7 4 2 6\n166409: 6 2 268 24 9\n322: 122 9 4 143 44\n4538: 450 1 33 4\n1862003: 2 9 302 215 610 449\n86940: 85 9 10 3 8\n38072: 6 613 4 15 4 692\n99725486: 6 12 6 6 6 6 65 25 478 8\n13750: 53 2 439 27 412\n7038816: 57 6 65 7 80 9 3 454 8\n2855136: 6 620 8 570 543 33\n146592: 84 7 160 2 67 924\n569936: 7 5 621 4 4\n740: 20 53 1 7 659\n70911: 5 2 8 66 2 9 1 4 8 1 4 511\n64728: 3 66 6 93\n265592: 440 6 7 2 545 6 967 2\n1497366612: 2 53 9 78 513 63 7 404\n61277: 150 5 1 2 9 5 2 48 8 1 7 5\n3346539: 8 82 5 42 7 3 59\n3365893552180: 12 995 7 28 7 37 180\n1009: 6 15 53 50 885\n127008: 83 7 894 37 84\n562032713741: 3 869 174 21 199 59\n987527: 34 61 3 9 385\n19712100: 735 4 530 84 25\n26901: 303 117 1 4 3 63\n15116264: 9 8 75 48 25 2 457 7 68\n204191226: 3 89 1 2 4 2 8 8 3 9 327 6\n5198984: 8 3 8 6 9 72 994 4 526 7\n11382: 759 1 164 7 868 6 594\n504391: 852 73 848 8 39\n530085603: 30 558 984 5 9 2 5\n624: 9 2 136 475 2\n3629563236: 359 2 247 54 379\n395873445: 9 227 47 8 9 3 2 2 5 687\n552102: 5 77 20 567 4 18 8 551\n76000078085: 47 2 33 7 7 2 156 5 85\n132685: 9 46 2 386 7 96 7 6 4 9\n10372: 3 5 1 9 47 189 2 2\n20543565: 978 2 65 3 7\n1472385558: 5 7 6 340 794 7\n14144491524: 44 2 64 983 5 24\n2692998: 48 1 19 63 638\n1252924947: 9 5 869 534 7 1 6 697\n4716: 12 98 1 3 4\n2496938: 3 41 7 725 9 4 2\n1235912: 7 3 99 4 217 49 92 76\n2481026: 30 810 510 18 8\n287777439: 74 83 411 2 3 1 57\n6343360: 2 6 7 72 76 688\n77516: 1 1 75 479 37\n3030894: 8 7 6 1 2 4 71 29 4 2 6 40\n5048088466: 80 631 8 765 7 71 6 30\n359727: 897 80 5 923 4\n74387040000: 50 52 80 5 13 393 7 2\n220838337605: 65 48 56 44 760 1 76 5\n25607876: 595 532 43\n33263: 524 4 63\n2233205: 956 6 4 389 348\n49713: 115 54 9 4 4 86 2 5 864\n6057554870011: 931 7 9 189 8 55 903 1\n933697: 3 833 1 93 913 4 3 42\n10924942: 780 353 14\n284929536: 3 4 4 3 98 94 861 92 6\n6695: 7 914 191 1 7 3 86 9\n6245883: 9 989 85 62 6\n30: 7 3 9\n10155582722: 755 6 35 8 3 2 4 2 30 8 4\n10213731200: 5 4 576 94 262 88 80\n234673837: 41 81 31 4 7 5 831 6\n324941866: 7 8 7 7 365 27 2 6 1 81\n145341868: 995 4 961 6 38\n2637745: 8 2 828 7 199\n17982455851: 64 2 4 2 9 222 5 7 4 6 1\n9608793: 574 956 628 4 8 381\n719687: 71 9 6 80 7\n48985815113: 85 571 450 8 151 11\n4889892: 8 3 15 9 3 428 1 8 7 4 1 7\n1505669220: 88 648 947 77 8 9 6 30\n2127186: 818 91 468 3 9 5 8 58\n4029145071: 15 562 37 64 45 3 287\n79038: 48 661 1 2 707 2 981 9\n50824: 50 7 1 2 4\n3007: 79 29 5 6 2 9 8 778 72 7\n97461: 25 779 5 81 5\n72103770: 6 1 827 5 378 66 7 8 9 9\n10958: 307 747 41 7 1\n20287324856: 7 5 97 1 79 3 6 92 1 9 5 4\n169639: 2 68 2 1 83 8 95 5 154\n4596255180: 1 67 6 67 55 1 8 3\n95786: 425 259 28 5 26\n42269125: 80 6 331 22 4\n293888: 4 2 4 2 821 54 425 4 7 8\n5203652120: 2 260 36 52 120\n214028823995: 9 7 889 2 670 7 1 9 9 5\n46785931: 9 5 104 6 7 59 8 5 32 8 3\n1249: 3 183 78 584 38\n39642467328: 73 27 10 3 3 984 667\n33264275: 22 782 2 3 5 73\n138424899: 9 68 143 89 9\n70342494: 195 958 61 9 447 47\n194789: 83 3 782 50 21\n183549: 6 40 399 7 2\n68052: 6 51 553 9 649 5 2 9 53\n14620480: 6 7 1 905 1 6 8 8 369 8 8\n3453258: 89 388 58\n17724262883: 35 92 24 1 8 2 8 688 1\n10296335: 7 22 23 9 62 57\n930: 913 11 6\n1528389206: 198 7 907 4 822 218\n684211: 6 9 76 7 596 6 570 23\n3953055575502: 7 6 7 10 4 7 3 860 4 476\n235864: 2 35 864\n342199842: 46 6 70 4 41 37 6 6 2 3\n38875005: 620 627 6 94 5\n47902: 717 6 2 40 13 432 8 4\n3437568326: 2 4 8 2 9 373 10 4 8 6\n71911489: 7 5 38 258 633 233\n116689560: 681 2 5 571 6\n13336633: 66 535 516 3 33 43 97\n2561353: 1 5 2 472 41\n7100813: 998 73 78 85 83\n9016487158: 1 915 3 3 9 3 8 94 49 5 8\n231873894863: 2 98 42 2 777 863\n17802929988398: 456 79 167 49 972 49\n205498: 8 9 2 3 56 48 4 3 3 3 622\n53767644: 537 673 5 4 290\n64823081: 4 8 1 546 742 390 5 4 7\n224054: 257 30 7 9 29\n4381459: 84 3 629 5 9\n156092264318: 26 60 92 264 319\n4835710: 112 7 5 2 9 521 1 9 6 5 7\n2097368646: 9 961 2 9 299 4 9 18 5 6\n5199015150: 4 1 529 40 234 15 7 6 5\n2263449: 7 236 8 2 9 8 8 3 245 9\n17923542: 2 12 2 91 92 702 44 2\n1822830370: 4 619 7 451 14 8 394 8\n787528: 423 7 8 9 44 3 1 1 667 2\n2861205060: 1 5 86 5 18 7 917 76 51\n2139301: 80 347 23 77 10\n78: 31 33 14\n1938: 1 1 1 68 101 7 2 9 6\n439607545: 6 29 378 3 1 904 1 481\n21129: 704 3 9\n1581: 848 1 21 649 1 62\n2662: 68 3 62 2\n3026494946287: 8 57 4 1 57 8 189 9 86\n146835081730: 339 7 1 96 2 20 9 2 6 9 9\n54568804: 1 65 99 848 4\n344196191: 65 802 3 62 78 22 75\n6009142314: 4 852 1 77 5 533 7 654\n2293044: 902 37 6 407 6\n66217250: 8 327 12 68 256 9 242\n7449: 10 105 7 23 76\n713: 73 50 586 1 3\n8396761070: 691 9 821 3 5 9 9 5 8 56\n84093834: 76 226 4 612 59 3 3 2 8\n8021: 24 3 293 87 23\n4588059: 8 55 5 8 547 1 6 4 2 27 3\n896: 3 6 96 7 8\n203856: 117 9 49 83 2 2 6\n1755: 5 5 6 56 19\n94983133313: 91 4 9 6 9 2 71 611 3\n36501584: 421 59 200 84 76\n2739260160: 83 8 78 3 60 67 32\n11431577: 4 85 4 54 86 8 74 57\n3904975: 762 183 28 451 36\n1061781890400: 1 90 712 99 797 210\n104260: 218 2 8 71 451 26\n12831: 231 3 479 96 793 8 8 7\n1867: 249 621 9 9 24 955\n2736990: 52 56 9 19 3 930\n7372456: 13 3 9 5 55 158 676 41\n13995957291847: 87 86 655 4 838 852 7\n262752: 7 755 9 180 6 8\n116756: 60 85 8 86 665 5\n21520534503978: 2 25 8 1 883 953 4 978\n20702160: 65 72 7 8 45\n47451357: 15 6 1 3 4 4 603 108 9 3\n90184: 892 1 6 91 4\n522977087: 6 8 8 35 75 5 5 9 76 6 5 3\n19773: 938 46 2 9 3\n591448: 96 8 611\n151932: 9 6 8 7 300 6 997 7 3 2 6\n677133: 55 94 96 7 17 8 15\n62605459434: 236 75 5 33 5 4 2 6 609\n1134716637: 5 134 4 814 576 8 51\n203685: 138 7 885 22 3 8 3 5 5\n411259430463: 7 60 4 988 2 7 384 7 6 3\n69479410: 6 28 93 7 8 23 711 631\n36480513: 747 4 5 10 488 73\n6529930114: 98 37 398 638 110 1\n3158302: 8 32 7 4 688 78 3 1\n1329: 956 213 6 95 59\n103528339432: 4 38 9 5 1 5 6 9 887 536\n26058526: 86 1 69 6 3 7 155 75 3\n16637174616501: 60 5 9 577 2 88 3 4 3 52\n496403648: 24 10 1 419 8 617 8\n70983429060: 234 1 5 20 1 6 8 5 8 5 60\n18430386766: 7 5 42 7 776 198 55 34\n4336513875: 7 869 534 1 3 15 89\n146733: 2 179 8 8 6 300 99 15\n719431: 1 418 7 4 4 7 4 5 8 35 6\n123489453: 1 235 650 2 9 89 47 87\n1817054297589: 6 40 395 5 4 297 592\n28112657546: 48 73 71 58 113 6\n3698184: 79 871 389 268 4\n33904566: 8 359 3 95 2 97 9 4 3 6\n3749036750: 37 4 903 6 750\n9653520: 2 28 2 5 57 584\n64502825: 7 9 20 171 8 60 5 65 5\n258198671: 2 6 840 55 551 7 1\n7876133: 9 9 32 46 963 718\n795924: 8 31 3 51 873 48\n25961153: 58 89 55 630 17 9 2 6 5\n7689010: 83 6 602 699 9\n37694322: 5 57 3 329 134 775 17\n370720500: 7 6 371 8 767 1 14 606\n396636777: 67 6 965 6 4 7 3 29 7\n683362696: 68 33 62 6 96\n176659289957: 8 2 3 57 824 8 899 57\n942096: 6 830 74 2 5 4 2 1 93 6\n139897: 50 6 4 5 466 3 86 8\n25310524: 842 9 835 4 4\n284646313: 7 2 858 677 4 623 5 4 7\n182325: 361 418 3 75 7 6 6 75\n55: 3 2 9 35 5\n2383002: 384 31 62 73 207\n5783478945: 61 2 9 15 7 14 8 351\n6822681600: 8 840 490 56 37\n4081902: 9 88 7 5 2 10 7 506\n499758: 1 27 41 426 326\n129: 53 7 61 3 5\n4093163: 940 75 4 8 3 8 7 5 6 317\n1735787709: 4 7 39 10 8 4 8 5 35 5 1 9\n1466379: 6 8 8 1 4 3 6 5 625 6 25 9\n1132930: 2 44 81 8 2 3 19 2 6 6 2 8\n813082430: 2 9 2 27 72 5 616 486 5\n39761608992: 8 3 1 5 9 4 7 9 942 476 4\n183663: 3 17 407 9\n290472: 52 7 798\n26524378336980: 2 7 808 977 3 92 8 980\n130466560295040: 778 533 9 98 816 190\n4905495936: 4 11 17 93 808 99 8\n593640: 492 5 5 1 2 3 39 9 6 30\n6233: 9 12 68 7 6 2 1 5 3 16 41\n36038: 9 476 863 7 9\n128815: 1 2 88 15\n1864323072: 202 292 9 128 8\n9950315: 52 4 938 51 3 8\n501726: 5 476 303 187 5\n92280: 922 27 2 9 42\n76472: 661 208 88\n61014: 1 97 1 629 1\n17078477400: 1 44 4 5 128 308 2 5 3 8\n376022848: 21 760 1 4 224 6 56 8\n6639080646: 945 3 2 7 7 99 881 643\n116944: 4 3 7 38 81 6 3 8 1 441 7\n230277087093: 319 430 9 801 93\n1043119420033: 4 31 6 1 4 341 2 350 35\n17346278: 6 45 69 9 157 545 18\n2901672: 2 287 1 16 72\n117015525: 5 1 8 594 4 9 97 6 3 3 55\n48944038: 539 9 71 608 5 703 26\n51469483: 113 965 472 217 26\n35344593648: 7 54 7 822 238 549 78\n9385011: 938 493 5 9 22\n8666140861: 5 6 6 1 4 44 60 6 6 1 8 5\n5300472946: 692 5 31 762 948\n25608: 87 4 3 24 552\n308240474597: 770 6 5 8 429 45 5 9 2 5\n16439885: 2 8 822 3 50 651 5 77\n544500: 8 22 253 37 26 4 2\n30379565: 3 903 1 5 323 1 9 565\n41656: 144 47 794 31 41\n24807: 48 7 63 7 552\n3485: 499 4 74 6 23\n839060: 1 27 1 35 5 7 9 3 7 6 1 25\n23088: 9 9 33 42 148\n9154663: 4 817 311 8 7 91 6 63 1\n90682288496: 7 577 8 5 20 1 6 748 6\n43937079: 5 770 7 89 91 4\n29472: 614 6 8\n11561778226: 2 6 6 4 34 9 9 963 2 2 2 6\n117144416: 317 8 8 6 6 8 39 8 1 956\n2462640: 3 8 15 2 9 7 5 8 4 7 930 8\n6991816: 6 2 867 3 4 5 7 8 1 35 4 9\n10813: 12 76 14 37 576\n5764467: 90 94 9 8 5 2 68 92 9 4 2\n20995047250: 5 814 4 6 7 9 4 4 7 9 2 50\n340676: 492 32 5 92 7\n460049: 9 8 839 39 5 69 4 8 2 7 8\n39360102: 46 101 5 7 845 2\n632489040: 632 48 896 1 73 6\n4515: 73 1 4 5 15\n22440: 4 8 21 663 561\n34573: 26 2 65 77 3\n1205424: 3 48 930 2 4 1 4 2 4 1 9\n2288024: 4 6 411 9 92 7 5 56 6 8\n7166740: 5 62 4 980 103\n43925184: 68 7 767 23 8 8 1 2 6 2 8\n73957520: 8 4 6 1 3 4 440 67 560\n4497072: 449 6 858 3 211\n379852098: 65 68 68 3 29 7 9 6 1 2 6\n7039622942269: 7 491 357 4 6 9 683 84\n59297832: 83 895 586 9 11 8\n3222143: 98 427 77 4 1\n2706396: 2 7 4 9 9 8 5 5 8 3 85 609\n54899: 9 40 5 8 99\n15470567600: 423 6 737 988 9 1 6 4 4\n414459045: 640 8 468 369 3 13 35\n28680: 286 73 7\n148225337: 5 63 394 6 5 4 4 922 7\n1548: 8 9 20 83 25\n52488: 55 4 5 8 81\n309758831546: 7 4 3 4 39 7 4 3 145 1 8 8\n45710059: 2 77 5 38 5 17 26 89 7 8\n110968: 3 8 9 4 5 435 3 4 32 1 1 5\n296175877: 2 3 124 9 3 2 46 71 6 55\n183182295: 3 6 31 82 295\n18032285875: 733 246 26 459 875\n2252773168103: 6 690 743 91 370 3\n208683: 90 1 303 531\n5905: 5 83 9 4 59 3\n2547957588: 2 135 6 7 9 4 5 57 5 87\n864108: 10 525 233 204 889\n2632797169: 9 5 78 52 578 3 5 71 2 2\n3861135: 17 94 6 330 91 42\n279877248: 98 69 966 503 72\n4321455138000: 567 4 611 20 75 693 3\n109506168: 771 73 43 3 9 5 8 896 9\n131686680949: 2 344 6 55 3 632 1 950\n11285568: 42 3 622 48 3\n7429: 6 7 35 15 5 4\n1344632850: 6 81 825 986 19\n1349: 12 9 23 866\n135629: 52 4 5 3 5 6 17 4 6 39 65\n109541641: 772 1 665 3 705 71\n36454: 32 11 847 33\n18256000: 79 4 792 326 64\n634608: 9 784 13 13 8\n2149222: 391 7 54 21 1\n1020512181: 8 89 9 3 3 4 40 80 1 8 9 3\n778156485: 6 21 5 4 2 7 23 663 9 5 3\n4983272739052: 280 5 530 11 920 4 73\n4161: 72 44 925 60 8\n2507022432: 4 489 6 9 8 2 8 8 90 2 8 2\n650605: 9 12 629 60 5\n2092992: 85 1 3 991 24\n26902: 9 2 3 74 6 5 42 9 8 123 2\n15599: 4 151 98 1\n41225189: 8 16 1 91 44 429 5\n1473989040: 7 228 6 1 30 32 920\n61866: 20 28 934 3 21\n570190125: 471 99 1 90 128\n16235927: 6 26 35 731 992 855\n21528: 565 2 1 2 1 8 1 9 6 66 6\n43993993848: 6 2 8 95 805 62 28 5 1\n26706275149: 4 60 451 2 58 6 5 42 8\n1011: 52 7 635 6 6\n299093: 9 8 2 4 7 8 4 9 4 5 5 867\n833382: 6 3 6 23 671\n14505768: 2 97 268 3 93\n4923890: 93 61 526 4\n48105: 751 4 16 3 38\n1414794: 70 38 16 61 251 11 6 3\n38616996: 4 79 68 791 2 3 6 999\n1904796000: 39 8 606 4 9 546 999\n147334: 9 732 65 44 22\n34232: 7 31 598 42 2\n12270967818: 27 722 9 885 5 2 3 8 8\n9264135: 3 451 441 25 6 4 13 5\n45507450163: 45 496 11 450 163\n91440: 4 41 6 916 5 48\n88344832: 882 4 8 38 8 41\n287671639: 985 29 202 1 1 56 7 2 4\n507668: 911 8 804 90 4 70 20 8\n394114: 19 837 51 434 7 469\n77382: 5 9 5 55 29 4 9 3 3 7 30 8\n9957630062: 56 9 310 73 2 291 7 3 2\n10296: 7 98 3 1 6 84 3 735 9\n295260: 7 2 18 9 84 1 39 3 19 6 7\n4701: 20 57 34 2 2 2 1\n3848560: 28 4 8 7 72 8 359 20 4\n16949608: 7 1 3 413 8 6 3 42 8 2 5 8\n31453576: 53 1 2 33 580 21 77 8\n314611: 33 9 24 86 773\n15245: 6 2 1 2 5 5 4 6 89 9 853 5\n7265: 1 7 7 6 8 1 7 669 3 4 6 63\n548073: 9 88 282 20 669 324\n62260835: 2 971 916 9 35\n835164: 30 4 3 513 44\n19800544: 440 45 1 136 407\n33392435588: 73 829 54 739 9 746\n9119277: 4 1 433 39 2 6 1 1 2 5 9\n2473338468: 2 4 24 446 155 3 3\n3391904: 5 42 291 248 8\n4854: 89 310 738 77 4\n7990517: 1 659 3 2 747 8 6 61 5\n27168: 195 80 8 6 16\n356592: 9 7 6 9 7 152 11 45 57\n803: 3 2 792 3 2\n7324966325691: 7 8 327 4 12 3 814 2 3 4\n4348464: 87 238 35 34 6\n78: 1 31 1 46\n2333: 395 903 8 93 9 2 923\n17413920: 1 730 95 8 2 580 2 9\n121371: 6 2 1 1 7 693 57 1 8 35 3\n52915920: 201 2 263 2 54 66\n4205: 1 6 82 9 6 722 4 3 5 3 5\n102938: 2 8 7 70 62 1 157 73 8\n64212990: 15 423 269 5 109\n2891: 2 24 4 15 11\n7707154: 411 954 4 1 7 1 3 6 7 94\n83830: 1 40 2 3 27 7 24 2 6 62\n342729: 7 83 272 14 9\n55247775: 541 851 8 16 41 15\n4259: 5 73 7 5 4 5\n13394887: 4 7 2 2 6 5 58 783 7 6 2 7\n904: 4 2 727 80 91\n7641038: 485 1 8 860 516 6 18 2\n2359540874: 2 546 3 8 6 36 71\n833: 42 62 1 14 7\n1581: 4 60 857 1 1 7 477\n225893352782: 225 893 35 278 2\n19077: 40 9 28 247 58\n1026671144: 5 46 3 74 8 359 8 7 69 3\n398072: 44 3 635 56 3\n15469480: 409 1 539 35 90 2\n1809270: 8 331 48 85 55 45\n2627552: 4 7 26 3 6 25 2 2 8 7 5 2\n6983: 1 950 1 70 6 9 4 844 1\n864439333: 8 98 80 439 330\n7739: 857 9 14 4 8\n527424: 5 19 6 32 67\n178358491551: 242 66 42 758 968 3 1\n23466: 4 60 4 1 2 1 166 8 5 379\n8865: 1 788 193 3 9 3\n25531136601: 2 55 311 36 601\n1435774: 8 84 27 578 18 4\n6228: 4 878 7 7 5\n1642: 3 8 3 4 2\n38584000: 8 6 4 2 41 6 95 2 4 8 875\n24723940: 209 31 477 9 8 4\n2116117: 697 3 2 6 7 23 425 36 6\n3124451126: 26 3 11 12 78 4 6\n86185: 879 9 4 4 6 66 8 9 1 853\n35383157110: 2 1 792 31 43 730 7\n1658134437620: 7 3 5 233 465 44 2 485\n43437081675: 5 713 216 2 176 77\n800998632: 7 3 214 4 54 246 378\n5200: 8 9 463 9 8 377\n33760: 67 2 3 2 5\n1120091: 63 5 55 37 344 8 11 16\n140: 1 47 92\n5721882: 42 49 29 2 469 82\n34206: 37 6 77 9 2\n121: 29 3 76 9 4\n4941531369: 91 54 22 5 53 137 1\n3463558642: 28 13 87 971 1 63 8 4\n31093720: 66 7 5 73 6 1 4 910 840\n52280: 5 1 75 7 847 8 8 62 40\n3272268: 59 5 644 459 701 4\n35454732: 7 7 984 5 32 3 9 69 37 2\n450758928: 51 4 59 2 8 8 4 195 2 24\n36492: 364 1 86 1 6\n34656285942: 83 93 1 51 2 9 3 54 223\n326592350: 8 36 5 81 40 5 70\n3808350: 6 3 623 19 8 8 675\n611496: 9 626 28 3 36\n415429: 373 436 513 1 412\n6713332057: 97 3 884 5 46 57\n3383861896801: 1 81 38 1 955 5 6 9 77 1\n140384: 3 5 5 970 47 3 33 761\n1916: 5 6 4 4 9 7 2 1 4 342 2\n17252: 5 11 140 63 3 5 76\n10500: 5 35 2 1 30\n1593745: 54 868 34 1 2 2 92\n307311: 8 376 8 68 2 42\n60696: 89 75 61 8 9\n76288046546: 13 6 4 9 5 7 303 6 1 2 14\n9273613: 92 73 613\n335922: 331 2 2 37 3 84 50 9 51\n17043713: 44 220 1 98 132 8 64\n1755720677: 48 77 180 2 677\n763: 42 250 7 1 463\n4841686083: 60 23 90 24 88 90\n7945523600154: 895 166 1 764 70 15 4\n292513: 2 25 91 64 1 852 460\n44328197: 73 877 3 29 962 2 3 12\n4732438201: 5 87 4 2 77 2 6 700\n1690422050730: 2 600 86 8 216 76 2 5 7\n73303: 35 74 8 31 1 1 9 3 9 1 52\n2929506: 1 9 186 175 6\n"

Day7.part1(input) |> IO.inspect(label: :day7_part1)
Day7.part2(input) |> IO.inspect(label: :day7_part2)
```

```elixir
defmodule Day8 do
  def shift({{i1, j1}, {i2, j2}}), do: {{2 * i1 - i2, 2 * j1 - j2}, {i1, j1}}

  def solve(s, g), do: Enum.count for(
    m <- [AOC.s2map s], {ch, ps} <- Enum.group_by(m, &elem(&1, 1), &elem(&1, 0)), ch != ?.,
    p <- ps, q <- ps, p != q, t <- g.({p, q}) |> Enum.take_while(&m[&1]), into: %MapSet{}, do: t)

  def part1(s), do: solve(s, &[shift(&1) |> elem(0)])
  def part2(s), do: solve(s, &Stream.unfold(&1, fn {p, q} -> {p, shift({p, q})} end))
end

input = "....................8.D.........Y...........c.....\n....f.............D......O...........Y............\n.......z..........7.N..........g..................\n..........h...........9g.7....................Y...\n.............8...............................c....\n...9..8...............L........D....O.....l.......\n..........f.9.......h.........................l...\n...z...B..........................................\n.................M.....C.....OR7.Y..g..........l..\n........................M.......N.................\n...............h..................TD....H.........\n......z......M........C8.......N.......m.T........\n......O.......................................A...\n...........a...........h..........................\n................B..................j..............\n..............v..f..........g.....................\n.......N..........s.M.........n..............Q....\n...............s.........j.......................A\n......................a......................T...b\n........s....v......H..c..............j..i....m...\n.......................a........2H.......m..V.....\n................n.B..........o.....H......2.......\n.....3.......s.B..............x......S..K.........\n.3.G..................J................V...l.x..T.\n....3.......................E..................V..\n3..........................E..........V...i.......\n...............v.......n.E...................2.i..\n..F.........r.e......n....E...........A..Q.....K..\n..z................................A....Q.........\n.................................b..Q...d.Sw......\n..G...0..e............v.......Z...j.....m...b.....\n..y.............0.a.............................K.\n.............Gp....Z.................4......S.....\n....oJ....G........e.........Z............b.X.....\nC........o.r........WL..1.......X........K.....d..\n..................Z1.....r...............F........\n............L.4................1.6..............tF\n...y...............L......1............26.t.......\n......e.k......y........I......x......d........t.R\n.......0.........k...............d.........tWR..x.\n..........q.....r......J..................F..P..w.\n..........................5..........XwW..........\n...........0....y.............J.............6p....\n..q...k.......................I.....4........SR...\n.........q..o.......P................W............\n.............q.IP..............................p..\n.....k...................w.............X.......f..\n.............P...............4..................p.\n.................I..........5.....................\n.C.................................5...6..........\n"

Day8.part1(input) |> IO.inspect(label: :day8_part1)
Day8.part2(input) |> IO.inspect(label: :day8_part2)
```

```elixir
defmodule Day9 do
  def dup(x, n), do: for(_ <- 1..n//1, do: x)

  def rsplit(a, f) do
    case Enum.reverse(a) |> Enum.split_while(&!f.(&1)) do
      {_, []} -> nil
      {r, [h|t]} -> {Enum.reverse(t), h, Enum.reverse(r)}
    end
  end

  def split(a, f) do
    case a |> Enum.split_while(&!f.(&1)) do
      {_, []} -> nil
      {l, [h|t]} -> {l, h, t}
    end
  end

  def pp(a) do
    List.flatten(a)
    |> Enum.map(fn {i, n} -> dup("#{i || "."}", n) end)
    |> Enum.join()
  end

  def dfg4([], pre, suf), do: [pre, suf] |> List.flatten()
  def dfg4([{i, _}=file | rest], pre, suf) when i != nil, do: dfg4(rest, [pre, file], suf)
  def dfg4(p0, pre, suf) do
    #IO.inspect({:l0, pp(pre), pp(p0), pp(suf)})
    with {p1, {_id, n}=t1, s1}=q1 <- rsplit(p0, fn {i, _} -> i end) || :q1,
         #IO.inspect({:l1, pp(pre), pp(p1), {pp([t1])}, pp(s1), pp(suf)}),
         {p2, {nil, m}=t2, s2}=_q2 <- split(p1, fn {j, m} -> !j and m >= n end) || {:q2, q1}
    do
      #IO.inspect({:l2, pp(pre), pp(p2), {pp([t2])}, pp(s2), {pp([t1])}, pp(s1), pp(suf)})
      case {p2, m} do
        {[{nil, _} | _], ^n} -> dfg4(p2 ++ [t1 | s2], pre, [t2, s1, suf])
        {[{nil, _} | _], _m} -> dfg4(p2 ++ [t1, {nil, m - n} | s2], pre, [{nil, n}, s1, suf])
        {_, ^n} -> dfg4(s2, [pre, p2, t1], [t2, s1, suf])
        {_, _m} -> dfg4([{nil, m - n} | s2], [pre, p2, t1], [{nil, n}, s1, suf])
      end
    else
      :q1 -> dfg4([], pre, [p0, suf])
      {:q2, {p1, t1, s1}} -> dfg4(p1, pre, [t1, s1, suf])
    end
  end

  def solve(input, gen) do
    input
    |> String.to_charlist()
    |> Enum.map(&List.to_integer([&1]))
    |> Enum.chunk_every(2, 2, [0])
    |> Enum.with_index(fn [f, s], i -> gen.(i, f, s) end)
    |> List.flatten()
    |> dfg4([], [])
    |> Enum.flat_map(fn {i, n} -> dup(i, n) end)
    |> Enum.with_index(fn x, i -> (x || 0) * i end)
    |> Enum.sum()
  end

  def part1(input), do: solve(input, fn i, f, s -> [dup({i, 1}, f), dup({nil, 1}, s)] end)
  def part2(input), do: solve(input, fn i, f, s -> [{i, f}, {nil, s}] end)
end

input = "5553244557716930487729269980742158786547371147184059483617907290977496829456278733147979141536998663985716308856901469977663717996349780535438309461114643921035239035331312884033278988497280136172378266542673253613497798799315483473419152454412942029531334475110966565412429194621724174576525668632512631893910162913938118746656373422445482752439981515876266117281508310117361469719601089948675967154539074447810192486636146311114133051941478927056849830263463152438833047432744549034651426766654984069896066284297776790738288992626526116719727448314929610641480228768648447558022469927449045548625356285378018976496866798968481176463903736957119403359789251545932706069468310821910146960616423897565926625743399147677292259753230799442409748302223145346654586135740414728482225965257334659547497988033159551616528474499647730937198293280544045327374611790761678417820317038905051378176286054959747127615585133683988198325354176333964174293978464936762855465671573617356771440392050693559503176366561513181383314136128353158385317154040113374945228781046601369917925457345483582317183872292767578141255267844388593852843844997586458956193807212598527402456904116469971193027679334146810418292412786852557593454728322994915915931941112438765677463654844272854603158249072755417827481411767557030656920522825623954748128663651227672656684503728448893406242718844788721217382213369739580465531824356583165667760199530139952549970761241232483833031427533302672327989228319638281193277829056766310113612286569793981249499911590788829723488178243356770415952909344884126113933747977745564422343374257457284949124627071952663749481284877454182317259481671586662163115114588748197473564959385553246778880968278461486796274946243964496476814854271639657795799287844145884635471639782187280953751527151278743158621437557937546171525308947476824139879435683742125603651369519698872318856351677216888312242671210891724901175234351642967288255261872349755718713984765111560997471415718292479625219739723671362119676437847374420996111878282212350545416439563667061982584943667707931271390788749508646196091683618938375385344283842852871172337232155417891734751201841829619466544892245506579155071774371454812123189508689385816176317821873115144798055227757564134615142263310697198898287177470529270857373712844827428693693682077665072212319631790838573459824608967348157371253134163688145988479609417904327205213138363504719698390249659489289194091872455683337605075899543891347325759307634223133546032736761898541408357983569991622751281284976665864753065139166723627169265736866189979667084999839478195999572661826196589986155985825925892342822782743996369941931744590143762452744315831754269227771168555833924502711454625755521583436575242125024466183712493943492677326736427694734516057854835212847173631701683883251392129845711133118154738448837126261228364734522322964899211536687853998232387577078585381422392173658706072753168266241356358954830296728207189465988874360229620356772297510134937506049658311686714766330302314504928123278168265883192107957127345756130952081996282679884732160101319738237313235595773984839441024645860239041417785243966848174783651386587222123985713569882488140166174646373172881916682501672126878969456881767209961498148974772835573775247892869881535364755579688993919306949517799703285135596299681561365485123991289469037637891228420678089569479849433426713995327162129824291603725946316286993738487604416306292304062247214608428215615219027604935895167837223429464347299714885593356579828184754196467338577382782363184438769895424717694277217646277641592745797837776501858846677291631138356899776472466487890448191954799856469613359644130989083606440769447405446931927475353134097726332784035382833157534595325182595822593368452889868559592606534138286994178769994102682163471273322569423806596393219345021322054976681723022918441396664979299955085555161512893234541666879631185451199661697911432704810296099807244753383887931258614999421187131641114676268201371766272771971387717163736193078471587717762277192146492489463475362556914866610721320134343893667542189828474179352992982789388694683596119179243603194668625752471241771211328668591354977609786295650747464848828443692464516607377597148549489471164412979744975162295543089803566634617379270132487828611386551602689597953222156686042412943863799137660457390525089622437327073331749564851147980673667547074862013186494884748762989944180386211677368831427575841294033406079813087791912647442774155294354683430397514933225117528156194341469191180477612751912982619429952903485866584497435995317322559602362961596782031849270107369681566112496322322825089819573593319576089759952184163667168325879495411204044531180862067959113447192352891959922594310526360985663402439612996745719754489901852678812155881782793581859321339145443145186772148469851335298533182743235395372997763644863539796197212227213718789827031363492172569964895557675911258169960437847761787776397145753854194232513127754902383696645425672561785627189746435431350565244852689298342719243205433663094995650323974329569209891133749105734995913222333573176928227727816794618873242368983267820206384433362688686228855395641379328755953452555376435802481983029432016747665949326213981342969966179459697905413815678397471595772462528246227151268602492984954962341661834732770229619125490731191769668278837264962758123581316121035563114423384492131512946884224493547561862901075514967831473199810489350127122473253167370548489774539438610182978298586151793364515795374602019117629319447187732618430898487967021281142635733357669949291111967606277798235805090153025126885314775229588507030839093707363476397342591781059397273722035695669999782692460778939941069677752511944117424274566748783297091335553847249979319688913115219878287196347811659766549448713148824276522439685811069376684529550933260524012203336381413414361682473803691829948666662928788516266818636406021806824358667458221109285362083845691237263926781939687655673187824575943243589673522431144841332909889958949299574277111189996349291975742374477884295213878258240499533962122599490477120953895262472997817366664691537346933682798749412177928461314312478986823627126503269768752863851358387346537396222524599418213205817828092786857149365718444714124319347215897309094766394678165515133465949899527483237473527544544836467999856344543364279558767736398722656894278653852272051494621218247965854919419662682227229405289146427748412293418703329563624438055524765438070746474106391649298756017176164285778714996851083813261658258507479587484952938636113925920346481773740421056669277997421423884944943191276914480633160892697614019402156399122547810243661706352821940875117496889904591512854786163146018815958563393449114359496257349437178141272386421184363264442148581836411747985375058494680783236581971104235286327848538706098566569405129927225429736447194788645771315674837578225269312369743452548221888514069437249277633934598101853603049945970111022505379543050697152417883538319535269466919467094657153348643294032444522984975676678405424352281439927988942648567497148259598303244756523775864667455716171328664807180294774169189875928925611657997441378414635693433339757613337361729627164381283235728237247249777685689729157238876683546543740964335327285688944181471712492329187718592564152532322195618458622112811583188437719622276741626913374324946792090151043713146212385138050863882151768806573904513177226189313427112476216863890814079436753809038301335586574508989985118729997405087405596612425646442654820236966221662495827399710534187822375623776218575884277311029798778765712748134122963505632285391543939789379916441779748897111661531822788647669228756165169762867712744591513636491313525448062632759253840536318647737519285109248825235219327112467694633933097375985183954749677524736421671392539809782526645666319127777125880126946374281896562721454824859177831599560507121285563342591934884432698551230694181491127924662471449196093108610438727461180984361188535722278372669727397265786197933404732658268851830177880664916887431654578377042727542176346614796832320845953215698345998916968198284893453626464683846608884368145778355411978528395547285933292265336807225815595286363568757385187197848537846774517984764105058416118134475306378159777892087981854302578202245783665953087114421571953375958499847236132269359789659452324187782507439953475709453201753594740204396158052545646407072552855443098572999964299712334728071483821139761638251701274183712414748113534286246438170141240265849939232867434581074687369507868322573281649554034266972948731939985235832744849275438802761677814916740807978444113843583829252967286652319396065634238879262601326144967637874427091652340549853765721926210239770991475409880721865146486957545244441637587736750253446393442246120556188309318226422678437139246394449735063166154517184186814668428818715898737604919383810502370307345808979395276804727285713725379505068738185948489589763204457395334983565466952145438887086871690474559141858648428726035334149762632507797787768735827826489226061512959986047396544316938731466255930839870644630563531788163301025468340383670897823868230183321208169557199144097208777695852556848233131371536401911275655423878687172406476764841643091284474736067996531709215897629337350789414162326167191882744359722713060955286975430609834371564148479229064774757228027835073759178226374658452299864557151221535621896458730102977966538725399146561614986591737454671165753887289496423664725833772917637369412105417406953625655641419424870181466888850619292919783768291465752281810245546178769207357187662857243549359797614345610365445403522368926564587436531488266533845989327592034393295602718391550767082362387196241318523828080248782159121172990311963884762395030503814674681606485909092888842729328302833133159124434718866253138606016643085888687372488262581533446173728783796918525104222928974336846783547257947478340428775901129291144355756727490479545687162817173442778332273519735216648701957156170209465858537875947534580777481747371701922353681241942633462883049804756708130994552928090404864237413778313168256764328721363273988383478924690351455202488875778541075554955313618479285884380736153398517786991727126283532574838272614184968817468462520706312927084991368552746163136975588803080508112433296935354121317415398791461116034459856876491521740673685953444952044957860801046161698877969773746904552849062506671506375225948682258315980272398547813754469783172827535319788634037212619326746196110683076592589801015518159735721672756945033116825669390414559373391943127469538493576589969932484907138703441695074196232947096932377908117178264868318484440729911759863458233699357298041696780198012494720308578552641862552643876671528133228441869174747833095523589837546617859363318257247361098591462675034847866472564355557205790451048658480326890411179752474228373723266915393591359113277519320367393904927542685578564517996584137179231672170716191712793452842255437474882167644159575887017859875626810673557997794296615358280228575457393223381129698501194623215696361966042656666433853284533159757545193167530209836178526319557648484279646985477135897719443352648279127138174427484294192104970709952164193567931392711391889285338853141733836616511457030254051668368857487779312478869796153794314505153824255634313338831185659107013107794255070781963866273591913303122733699123582537049889122726131772274548951198151643838624262913522649612643544345547725977418457115398525463516892887577375224593783873161557977126771312542838250121336435573195077733929691130618718138128484124119378898750803397684371744785231225606068949210707428371962983748862474627621548365464695518598263362304344966979742568645317334410398525316883639565745841307245376871951085231316153391387463171320463172765624214354538937903978586111134096579756644872347637497233272142285017492287692019518948718913275455577428355022147365166252934587267562832484864534907289462769929491931333974568535510509430765011424490536181482769417545173026585328174796748087929441473115673179729165328573935923712458108546972446501084367527696258213960366566759865193671125078665336357545227844608114219521469947273548616629597086769237375460952928439952796628334857137152665579855226527260832552562826209986296031707882744167249346111246932469811117208778628869954618881976489531407540368127876037781552547832688038847695434583526541976821508167341078298518723883197197579172928833249714921636711829744141364834425228584983238140361811511829501558566790876129718118979496249741333346105432608482608947819795749382902621767344892978949074826176171956159799626030431373738683451598881924746590336639107632687835648936281533613812899869425478174652175349728955451271784463499092651837764466992273803015904647846473807547738194147599937241835050142093394282661478175846586125738994127815126196165132661746737644899892211842591463684092821160402983301448687859217163795473663384224971729243391641883189915426483163517414836597179227801387834594528333301621213658873228813725737274941650679061161450308489447722662983128672288181934338389144251571985012232553511838103693428539587768155586133982818821203529837374436234385023163472748732697992412387823016968663752915858647786858433386982366266585703488338137207228245918935150957596929612201524359717438364205694916123122413273622941669762814753896407223807534335182837374513392419860333377611135914598545073791048163445833265375918405418476863321467891523149946158435934116466894772280146591611710334667235573924884177160276671465686853132701935931546432628489936586626182784148538935594262920814977613262699446242754351795458414327487183293335069773089974053332839171498167477941338838216322439613830945787576726603992558139707154719267711666162383154891409927144667232175593348786739648540434517433050148637291987152826268646277664604273281925859363123649266521315279478799851472271163185398995216349452437826129093245550897554669083657361763110249249134971854779183553881835931659432911464732614811521825102455452395467915942944341429912345316919388776353799436685972444507499567751156493505111959981271130319535363780362637266429995839844388801637704447375296766760121795634017797666355136376152703569387788531360529752772565232075904233784921912890684116541835747178579641976628649134124174244495419895992571765336599322445053417662877926776337238121788314216539615785812785585342197425314174178455599063664456451194977979669515273896394848894120907937254162978649103298198299246743746694252013348532484975922826122160921073742354179861538332404417885561561923247012758936442673466915782552203630648652251739708357477096434378553818396423574842501912793930117288524666183060599355337943646743721284673054617186812477578344464043109160973120928690836512689356269854732775462353978755273619432197133875105788232053153040768358876936516679956525745846533841549452567481831523428118514739693241604088197846677681158481914135371518345234483537174762202755132385158310596453457488949875394149957627552760349458436544553992759480882347846620912350116561637155296039617134973838669644707998206126705820703543329929547677984410255837192632482577774850589469348251786192297490896110457428561129245480299898112664849264281046335022686161794059563987947978732312941229571873444856746047167996809037717861219544538398266847833076254851537181303775834444799562833891547735414160532590882656657143165776637634231558863587739187261719231548396454415339254453446756626623522953584092189314122012485263825093349553315438383647573337468656899378673384546866106226358761774176404881358064587711297338992334246568685673402074939736139637356922442739806228535110353523502990953420143851988422833930944764617927711059523996299814824542431153655298957375802278493249848536725342662792786957501473149615354751831293776392879821744174849456733136891030541996152484199590185528339293643517818429574092792678617093106325868242681798448876437659545815304449308297837257983942678928358657135282859135588534472724809053996821605065119757782296303133625867823954245234191239828646887753408393128757274594597320783132679135555057986695531363923691102192915619174850491539928349412289522672813517112821871421568843158354387329191946553816429340759631674875611413217021668172854075823488338329458615878095482786423983896239847489643085675317904887422550737985849612673366767137836944217319293035567613325237523626186622874224131112758762991587915761973424681235498274863459699624197218828211304873815971315051468238699965178795992025656717841299539167166094846583792783494090689759571771981060861532369686816049412890495749715759791123882540655280698971131124172238812838334520601591725661674949439354373742663887961396191121477211895814797274636146869951594642767069874069475850456018735913746926475987971792528711858269238275146414813894501375559520654348288922785751654225533293758435273523813027749291975745573617677455644476525129697781169972389366494047922036758171325270593892219960656082931873206883721451388757298818546410294254912490928230277025878280466951629249459085341268941691256344892219855636441758913796435715798280164214742869521179842677863976866739225411329848247023735939168925148415387353755750238112321219473373371142842522129911635238387296664240301069758788224326376987987145872177107564712551588831444433248559351140289284614953428614554834155267258725639965985223333540882026657554387115272080141774312896684679853785192148343898817033778164401835875026421345331238134353729372575690267871253439331095585111899553313369852374982572666952618772665922741845114160236990584962416334528927633096574120619045701587447117517629209656682737869497372672668721828760931416599169547212266936645020626085535112557217527521728584962549249089543160955727176127374629843767492316768530417224383819532678719635708252718172437788102364249645991838444841965952954499326458277573697979637814451368814140779529269733829386758664868513756287456188442436519034152964234837819313753267273887891749188532302627273235986595394977252951369118917442174862493461232617156393774811596880565738314019254556231763814060838414225751739755657992433644859436224763577896451995165242542212445838995424504446574088941968927163464265983179943067247462592433766553701647202974921931447288247781972318684491927773248219533223731325494071429581451792254014151146692295273324308557954633319439691753629489432375736532354882393242599228855151742410536139538999654720569263361899212986318056933960203083124462779764693130899582964660854259296647696927118920367254761545851253285995877958661931627396688930183284781432439862803943269127764414304750735488722493562444186999548371989999243847871485123165357037605650783748496192859381256088968873131766422757798171759598657189844895506742221112828953218759793298632644682051633075274087986290897974932047474222157223177485116550905782118933125625134884447958223338631843679596206873256085634142863841533389249567667317656074989747981397483982114586524669613346253322682573367043109689595895785776175368766046644579849321561568825080287263529173394147107061313516891187606553715032248095929289932443976910326960589875935314638950171684713156799221269753875059809443557081734410708285846439547753934398584955738182471139315828249089253910551857159117492214514584846671169483278384764172305621235999652486183717744324429929557596251877297080299069709159256578341661331117165094742961464130413540179146425369421858248436285188172726927792274354587132159034854754661563301166227734904078909469568544116340441228258210957773208392176780918383803643515796411582213938317969254239216979438387195997483371334073493025576914542682917316113254497576111950798277265838624899788338323494466550674414243349315884129435167345871090132680691722995862507295429047209649597261412675179627522111495122218039495311857757964311626591984352381855376585975540373597931479661158411636159184565190262983574784218711446062111958359674417764303131369836496974301882364472959035657761304423882586553433794475231995296"

input = sample_input = "2333133121414131402"

Day9.part1(input) |> IO.inspect(label: :day9_part1)
Day9.part2(input) |> IO.inspect(label: :day9_part2)
```

```elixir
defmodule Day10 do
  def move({i, j}), do: [{i + 1, j}, {i, j + 1}, {i - 1, j}, {i, j - 1}]

  def dfs1(p, m), do: Enum.uniq for(q <- move(p), m[q] == m[p] + 1,
                                    g <- m[q] == ?9 && [q] || dfs1(q, m), do: g)

  def dfs2(p, m), do: Enum.sum for(q <- move(p), m[q] == m[p] + 1,
                                   do: m[q] == ?9 && 1 || dfs2(q, m))

  def part1(s), do: Enum.sum for(m <- [AOC.s2map s], {p, ?0} <- m, do: length dfs1(p, m))
  def part2(s), do: Enum.sum for(m <- [AOC.s2map s], {p, ?0} <- m, do: dfs2(p, m))
end

input = "987672345210988321089487678943210101985430123012901212349876\n890581876347809451276596521058923432876543276529874301236765\n081490932156918760345603430667898943109801983434565321245125\n112387893045329654565012348766087652234712123403125430104034\n201236794532134503456983289632128141045623010512036765295543\n310145687621032012987674108543459031012654107696543894387654\n498456546001221093474565432432569122101965298787645976578761\n567307632120332387565478901201678233212874345676534589469450\n569218986787454456010785832178876544589012321201225676354321\n478123678796561234521896541069987235678987430390310101256910\n312054569657320899634567892454100124017986543485436543267871\n203765012348210798749656876363211345623477012576567654106565\n104894343239345687658775965278901210786568943689658987265430\n985787210101012210343189034107349809894329876756567456892121\n276321895696523421221076121001256756765018549843498305743012\n123450734789434322834565432890162125321567678732565214654012\n043545643298545618965436901781878034450410589721056543204323\n652634102187656709878927801652989876567323434874347890116454\n701783214074327812567213452343567865018430128965236921327985\n879898543265018903450102169603498984329543012340121023438876\n930569856104345676543221078712321075655432121050123214589565\n321478987645430189876330789610165034746583043269874303678456\n430326786554321234565445698543278129837895650178965452102365\n545415898545210765676324582344569100121298782348766567801476\n696504305676905894889213001053213256780367091059654321945987\n787413218789876103990102128967104345091452187768345670236896\n898310129650145212850167034878545432187873677851210980167345\n790101212341232101763258949889436782106924578960102398798201\n889212303216987232654345656776521093345014467017681432120132\n974322454307896342363214780345810894214323454178590541098743\n865401965416787651654303291236989765201412963289487672347652\n765432876545619650189432100387870652106507875670343781656761\n765410987814308761276541087498761543017890124501289890967890\n898321678903216654365650196501252102120987033215670767856981\n456912565214327612984787767102343256761856144256781056743234\n367803454323438703673298898234358543892349856105892343212101\n219804456554549654560143567895569212876548761234987454101234\n008512367567632103067654410766978103975432810125676655670543\n127601898458903452198103328957860198786901912089985765781632\n234534567321012560198712367046043245697850105678789854398701\n103421673450523871237601452132154032106543214543210710239678\n011210982567658964321546543012965124321432343058988720106549\n320125671098576545690037012129876765010541012167349634218932\n430134040123489836789128903456745895432672123453234545347451\n549232132123498721654100190109832106701089098500104456956320\n678943433001567890193289283254108987892128987612245437875410\n217654456712346521089374374363201076985434376543336521056587\n103450349809454434678765465478912345876548985965447899867898\n212761212778765894501250104567656210230123476876534038769876\n429843203989987765410343215698567340145696545123410125612345\n343456117801256784320354210785458756968787034014567234501654\n652107006901343098901235341812329647879674123456798012612703\n567898215414332187612356756901410138984565012343898543563812\n238987312323278076543349867812567221345694321032187623438910\n109813408954109189801210789003498210210782107153098018542123\n216701567867898276764325650101567367823473498544567129656034\n345652101210567345123434543234989456910565567639875678798945\n456543458325430410089545696545678321045876543320564549567876\n434567869450321523679656787230109878236905452011254235650165\n321018978761234334578765698101234569107812301232340123543234\n"

Day10.part1(input) |> IO.inspect(label: :day10_part1)
Day10.part2(input) |> IO.inspect(label: :day10_part2)
```

```elixir
defmodule Day11 do
  import AOC, only: [int: 1, str: 1, divmod: 2, cache: 2]

  def blink(i), do: blink(i, divmod(byte_size(str i), 2))
  def blink(i, {m, 0}), do: for([s] <- Regex.scan(~r/.{#{m}}/, str i), do: int s)
  def blink(i, _), do: [max(1, i * 2024)]

  def dp(i, n), do: cache({i, n}, do: n < 1 && 1 || Enum.sum(for j <- blink(i), do: dp(j, n - 1)))

  def solve(input, n), do: Enum.sum(for s <- String.split(input), do: dp(int(s), n))
  def part1(input), do: solve(input, 25)
  def part2(input), do: solve(input, 75)
end

input = "4610211 4 0 59 3907 201586 929 33750"

Day11.part1(input) |> IO.inspect(label: :day11_part1)
#Day11.part2(input) |> IO.inspect(label: :day11_part2)
```

```elixir
defmodule Day12 do
  import AOC

  def regions([p | ps], m, r \\ [], rs \\ []) do
    with {:q1, []} <- {:q1, for(q <- move(p), m[q] == m[p], q not in ps, do: q) ++ ps},
         {:q2, nil} <- {:q2, Enum.find(Map.delete(m, p), & &1)} do [[p | r] | rs]
    else {:q1, qs} -> regions(qs, Map.delete(m, p), [p | r], rs)
         {:q2, {q, _}} -> regions([q], Map.delete(m, p), [], [[p | r] | rs]) end
  end

  def peri1(r) do
    Enum.count for p <- r, q <- move(p), q not in set(r), into: set(), do: {p, q}
  end

  def peri2(r) do
    es = for p <- r, q <- move(p), q not in set(r), into: set(), do: {p, q}
    Enum.count es, fn {p, q} -> !Enum.any? for d <- [{-1, 0}, {0, -1}],
                                               do: {add2(p, d), add2(q, d)} in es end
  end

  def solve(s, f) do
    for m <- [s2map(s)], r <- regions([{0, 0}], m), reduce: 0, do: (a -> a + length(r) * f.(r))
  end

  def part1(input), do: solve(input, &peri1/1)
  def part2(input), do: solve(input, &peri2/1)
end

input = "UUUKKKKZZZZZZEEEEEEEEEEEEEEEOOOOOOOOOOOOOOHHHHYYYYYYYYYYYYYEYYOOMNNMUUUUUUUUUYGYYYYYGGGGGZSSSSSSSSOOOOOOOOOOOOOOOODDDDDDDDDDAAAAAAJJJJJJJJJJ\nUUKKKKKZZZZZZEEEEEEEEEEEEEEEOOOOOOOOOOOOOOOHHHYYYYYYYYYYYYYYYYOOMMMMUUUUUUUUUYYYYYYYGGGGZZZSSSSSSSOOOOOOOOOOOOOOOWDDDDDDDDDAAAAAAAJJJJJJJJJJ\nUUKKKKKKKZZZZZEEEEEJEEEEEEEOOOOOOOOOOOOOOOHHYYYYYYYYYYYYYYYYYYMMMMMMMUUUUUUUUYYYYYYYYZZZZZZZSSSSSSOOOOOOOOOOOOOOODDDDDDDDDAAAAAAAHJJJHJJJJJJ\nUUKKKKKKKKKZZZEEEEJJEEEETTEOOOOOOOOOOOOOOOHHYYYYYYYYYYYYYYYKYYYMMMMMUUUUUUUUUUUYYYYYYDDZZZZZZSSSSSOCOOOOOOOOOOOOOTDDFFFDDUAAAAAAHHHJHHJJJJJJ\nKKKKKKKKKKKKZEEEEEJEEJEETTTOOOOOOOOOOOOPORYHYYYYYYYYYYYYYQKKKKMMMMMMMUUUUUUUUUUYYYYYDDZZZZZZZZSSOOOOOOOOOOOOOOOOOODDFFFFAAAAAAAHHHHJHHHJJJJJ\nKKKKKKKKKKKKZZEEEJJJJJJJTTTOOOOOOOOOOOPPPYYYYYYYYYYYYYKYUKKKKMMMMMMMMMUDDDUDDDDDDDYDDZZZZZZZZZSSOOOOKOOOOOOOFOOOOOOFFFFFAAAAAHHHHHHHHHJJJJJJ\nKKKKKKKKKKZZZZEEEEJJJJJJTTTOOOOOOOOOOOOPPPPPPPPPYYYYYYKKKKKKXXMMMMMMMMUDDDDDDDDDDDDDDZZZZZZZZSSSSOOOOOOOOOOOFOOOOOFFFFFAAGAAHHHHHHHHHHHJJJJJ\nNNKKKKKKKZZZZZEEZJJJJJJJJTOOOOOOOOOOOOOPPPPPPPPPPPYYYKKKKKKKKMMMMMMMMMUDDDDDDDDDDDDNZZJJJZZZZZZZZOOOOOTTOOOOFFFAOOFFFFFAGGGAGHHHHHHHHHJJJJJJ\nNNKKKKKKYZZZZZZZZJJJJJJJJJJOOOOOOOOOGGXPPPPPPPPPPYYYYKKKKKKKMMMMMMMMMUUDDDDDDDDDDDMMMMJJJZZZZOOOOOOOOOETOOFFFFFFFFFFFFVVVGGGGHHHHHHHHHHHJJJJ\nNNNNKKKKYZZZZZZZJJJJJJJJJJJMDDOOOOOOOXXPPPPPPPPPPPPPYYKKKKKKKOMMMMMMMUUDDDDDDDDDDDDMMMMJJZZOOOOOOOOODDTTTTTFFFFFFFFFFFVVGGGGHHHHHHHHHJJJJJJJ\nNNNNNNKYYYZYZZZJJJJJJJJJJJMMMDDOODXXXXXXPPPPPPPKKKKKKKKKKKKGGGMMMMMMUUDDDDDDDDDDDDDMMMQQJJZOOOOOOOOONDTTTTTTFFFFFFFFFFVVGGGGHHGHHHHJJJJJJJJJ\nNNNNNNNYYYYYZZZZZJJJJJJJJJMMDDDDDDXXXXXXXXPPPPPKKKKKKKKKKKGGGGUMUUUMUUUDDDDDDDDDDDDBBBQQAAAAOOOOOONNNDDTTTTTFFFFFFFFFNNNNNNNNGGGHKHJJJJJJJJJ\nNNNNNNYYYYYYYZZZJJJJJJJJJJMDDDDDDDXXXXXXXXXXXPPKKKKKKKKKKKKUGUUUUUUUUDDDDDCCDDCCDCDBBQQQAAAAQQOONNNNNDDTTTDTFFFFFNNNNNNNNNNNNGGGGYHYJYYJJJYY\nNNNNNNYYYYYYZZYZZJJJJJJJJJDDDDDDDDDDXXXXXXXXXXXKKKKKKKKKKKKUUUUUUUUUDDDDDCCCCCCCCCCQQQQQAAAAAAONNNNNNDDTDDDDFFFFNNNNNNNNNNNNNGGGGYNYYYYYYYYY\nNNNNNYYYYYYYYYYYJJJJJJJJJDDDDDDDDDDQXXXXXXXXXXXXKKKKKKKKKKKKKUUUUUUUUDDDDDCCCCCCCCCCCQQQAAAAAAOONNNNNDDDDDDDDDDFNNNNNNNNNNNNNGGGGYNYYYYYYYYY\nNNNNYYYYYYYYYYSYYJJJJDDDDDDDDDDDDDDQQXXXXXXXXXXXXXKKKKKKKKKKUUUUUUUUUTTTTCCCCCCCCCCCCQQQQQQAAAQOONNNDDDDDDDDDDDDNNNNNNNNNNNNNGGGYYNNYYYYYYYY\nNNNNNNYYYYYYYYYYYJJJJJJDDDDDDDDDDDDQQXXXXXXXXXXXXKKKKKKKKKKKKMLLLLULLLTCCCCCCCCCCCCCCCQQQQQAAAQQOONNDDDDDDDEDDDDNNNNNNNNNNNNNGGGYYYYYYYYYYYY\nNNNNNYYYYYYYYYYYYJJJJJDDDDDDDDDDIIDQXXXXXXXXXXXXXKKDKKKUKKKKKMMMLLLLLLLCCUUUUCCCCCCQQQQQQQQAAAQOOOONNDDDEEEEEDNNNNNNNNNNNNNNNGGGYYYMYYYYYYYY\nNNNNNYYYYYYYYYYYYJJJDDDDDDDDDDDDDDDDXXXXXXXXXXXXXDDDDKKKKKKKKEEELLLLLLLLELCCCCCQCCCCQQQQQQQQZZZOODDDDDDEEEEEEXNNNNNNNNNNNNNNNSGGYYMMYYYYYYYY\nNNNNNNYYYYYYYYYYYYZZZZDDDDDDDDDDDDDDDXFFXXXFFXFXXFFFDKKKEEEEKEEELLLLLLLLLLJJJJCCCCCCQQQQQQQQZZZZDDDDDDEEEEEEEENNNNNNNNNNXXXGGSSSSMMYYYYYYYYY\nNNNNNNNNYYYYYYYYYZZZZZDZDZDDDDDDDDDFFFFFXFFFFXFFFFFFFKEEEEEEEEEEEELLLLLLLLJJJJJQQQQQQQQQQQQQZZZZZZDDDDEEEEEEEENNNNNNNNNNXXXGGGSSSMMYYYYYYYYY\nNNNNNNNYYYYYYYYYYZZZZZZZZZZZDDDDDDDFFFFFFFFFFFFFFFFFKKEEEEEEEEEEEEEELLLLLLJJJJJJQQQQQQQQQQZZZZZZZZZZZLLLEEELEENNNNNNNNNNXGGGSSKSSSMYYYYYYYYY\nNNNNNNNNYYYYYYHHZZZZZZZZZZZZDDDHBBDDFFFFFFFFFFFFFFFFFKEEEEEEEEEEEEEEELLLLLJJJJJJQQQQZQQQQQQZZZZZZZZLLLLLLLELEENNNNNNNNNNNNNGSSKSSSMMYYYYYYYY\nNNNNNNNNNYYYRHHHZZZZZZZZZZZDDDDHBBBBBFFFFFFFFFFFFFFFFEEEEEEEEEEEEEELLLLLJCCJJJJJJQQQZQQQQQZSZZZZZZZLLLLLLLLLEENNNNNNNNNNNNNSSSSSSSMMYYYYYYYY\nNNNNNNNNYYTTHHHHHHHHZZZZSSZZZDPBBBBBBBFFFFFFFFFFFFKKEEEEEEEEEEEEEEEELLLLJJJJJJJJQQZZZQQQQQZZZZZZZZZZLLLLLLLLEYNNNNNNNNNNNNSSSSSSSMMYYYYYYYYY\nNNNNNNNNNNTTHHHHHHHZHZZZSSSSZDPBBBBBBBAAFFFFFFFFFFFFEEEEBBEBBEEEEEEELLLLLJJJJJJZZZZZQQQQQQQZZZZZZZZZLLLLLLRLEYNNNNNNNNNNNNASSSSSSMMMYAYYYYYS\nNNNNNNNNNNTTHHHHHHHHHHHZSSYSSDPBBBBBBBBAAFFFMFFFMFIIIEEEEBBBBEBEEEELLLLLLJJJJJJZZZZZQQQQQZZZZZZZZZZYZLLLRRRYYYQNNNNNNNNNNQQQSSSSSMMMSSSYYYSS\nNNNNNNNNNNNHHHHHHHHHHHHZHSSSSPPPBBBBOBBAFFFFMMMMMFIIIEEEBBBBBBBEELLLLLLLLJJJJZJZZZZZZZZZZHYZZZZZZZZZZZLLRRYYYYYNNNNNNNNNNQSSSSSSSSSSSSSYYYSS\nLNNNNNNWWWNWHHHHHHHHHHHHHSSSSPPPBBJBOBBBMFFFMMMMFFIIIEEEBBBBBBBBBBLLLLJJJJJJJZZZZZZZZZZZHHHZZZZZZZZZLLLLYYYYYYYYQQQQQQQQQQQSSSSSSSGSSSSSSYSS\nLLLNNNNWWWWWHWHHHHHHHHHHHSKKKKKKKJJJMMMMMMFMMMMMEFIIYPEBBBBBBBBBBBBLLLLJJJJJZZZZZZZZZZZZHHZZZZZZZZZYYYYYYYYYYYQQQQQQQQQQQQSSSSSSSSSSSSSSSSSS\nLLLLWWNWWWWHHWHHHHHHHHHHSSKKKKKKJJJJMMMMMMMMMMMMMMIYYYYYBBBBBBBBBBBLLLLJJJJLLZZZZZZZZZZXXXZZZQQVVZZYYYYYYYYYYYQQQQQQQQQQQSSSSSSSSSSSSSSSSSSS\nLLLLWWWWWWWHWWHHHHHHHHSHSSKKKKKKJJJJJMMMMMMMMMMMMMYYYXBBBBBBBJJBBBFFLLAJJJJTLZZZZZZZZZZUUULQQQQVYYYYYYYYYYYYYYYQQQQQQQQSSSSSTSSSSSSSSSSSSSSS\nLLLLLWWWWNWWWWSHHHHHHSSSSSKBKKKKKKJJMMMMMMMMMMMMMMMMMXBBBBBBBJJBBBBFBAATTDDTTZZZZZZZZZZUUUUQQQVVYYYYYYYYYYYYYYYYQQQQQQQQSSQSTTSSSSSSSSSSSSSS\nLLLLLLWWWNNWNSSSHSHSSSSSSSKKKKKKKDMMMMMMMMMMMMMMXXXXXXXBBXBBJJJBBBBBBTTTTTTTTZZZZZZZZUUUUUUUUQVYYYYYYYYYYYYYYYYYQQQQQQQQQQQQFTSSSSSSSSSSSSSS\nLLLLLLWWWNNNNSSSSSSSSSSSKKKKKKKKKKMZZMMMMMMMMMMMXXXXXXXXXXBJJJBBBBBBYTTTTTTTTVZZZNZZZUUUUUUUUVVVVYYYYYYYYYNYYYNSSSQQQQQQQQQFFTFSSSSSSSSSSSSS\nLXXGWWWWNNNNNSSSSSSSSSSSKKKKKKKPFOFFZZMMMMMMMMMMMXXXXXXXXXBBBBBBBBYYYTTTTTTTVVNZNNNZZZUUUUUUUVVVYYYYYYYYYYNNNNNNSSQQQQQQFQFFFFFSSSSSSSSSSSSS\nXXXGWWWNNNNNNNNSSSSSSSSSKKKKSFFFFFFFFFMMMMMMMMMMMMXXXXXXXXBBBBBBCBFYTTTTTTDDNNNNNNJZZZIUUUUUUWWWHYYYYYYYNNNNNNNNNSSQQGQFFFFFFFFSSSSFSSSSSSSS\nAXXGWWWWYYNNNNNNSSSSSZSSKSKSSSFFFFFFFFMMMMMMMMMMMXXXXXXXFFFFFFFBFFFTTTTTTTNDNNNNNNJJZZUUUUUUWWWWWWYYYYYYNNNNNNNNNQQQQGQQQQFFFFFSSSSFSSSSSSSS\nAXGGGSSYYYNNNNNNNSSSSZZSSSSSSFFFFFFFFFFMMMMUMMMMMMNXXXXFKFFFFFFFFFFPTTTTTTNNNNNNNJJJZJUUUUUWWWWWWWYYYYYNNNNNNNNNNQQQQQQQQQQQFFFFSSSFFSSSSSUU\nSSSSSSTNNNNNNNZNNZSSSZZSSSSSSFFFFFFFFFFFMMUUAANNMNNFFFXFFFFFFFFFFFFTTTTNNNNNNNNNJJJJJJUQUUUMMWWWWWWWWYYNNNNNNNQQNNNQQQQQQQQQQQFFFFUUFSUSUUUU\nSSSSSSTNNNNNNNZNNZZZZZZZSSSFFFFFFFFFFFFFMUUUAANNNNTFFFFFFFFFFFFFFFFQQTTTQNNNNNNNJJJJJJJMMMMMMMWWWWWWWYFNNNNNNNNQQQQQQQQQQQQQQQFFFFUUUFUUUUUU\nSSSSSNNNNNNNNNZNNZZZZZZZSSSFFFFFFFFFFWFFMUUUUAAAAATTTFFFFFFFFFFFFFFQQQQQQQQQQQNNJJJJJQQMMMMMMMWWWWWWWFFFYNNNNNNQFQQQQQQQQQQQQQQFFFFUUUUUUUUU\nPSSSSSSNNNNNNNZZNZZZZZZZZZSFFFFFFFFFFFFFFUUUUUAAAATTTZZZFFFFFFFFFFFFQQQQQQQQQNNJJJJQQQMMMMMMMMWWWWWFWWFFYNNNNNNFFQQQQQQQQQQQQQFFFUUUUUUUUUUU\nSSSSSNNNNNNNNNNZZZZZZZZZZRRFFFFFFFFFUFFFFUUUUAAAATTTTZZZZFFFFFFFFFFFQQQQQQQQQWNNJJJQQQMMMMMMMMWWWWWFWWWFNNNNFFFFFQFFFQQQQQQQFFFUUUUUUUUUUUUU\nSSSSSSNNCCCCCCCCCCZZZZZZRRFFFFFFFFFFUUUUUUUUUAAAATTTTZZZZFFFFFFFFFFFQQQQQQQQQJJOOOOOOOMMMMMMMMWWWWWFFFFFNNFFFFFFFFFFFQQQQQQQQFFFUUUUUUUUUUUU\nSSSSSSSFCCCCCCCCCCCZZZZZRRFFFFFFFFFFUUUUUUUUUAAATTTTTTZZZFFFFFFFFFQQQQQQQQQRJJJOOOOOOOJMMLLLMMMMMWFFFFFFFNFFFFFFFFFFGFFUCQQAQFHFUUUUUUUUUUUU\nSSSSSSSSCCCCCCCCCCCZZZZZRRFFFFFFFFFFUUUUUUUUUAAAAZZTZZZZZFFFFFFFQQQQQXQQJJJJJJJOOOOOOOJLLLOOOOLMMWWJFFFFFFFFFFFFFFFFFFUUCCQAAHHHUUUUUUUUUUUU\nESSSSSSECCCCCCCCCCCZZZZZRFFFFFFFRFFUUUUUUUUUUAAAAAZZZVVVVFFFAFFFFQQQQXQQQJJJJJJOOOOOOOLLLLOOOOLMMJJJFFFFFFFFFFFFFFFFFUUUCCCHAAHHUUUUUUUUUUUU\nEESSSCCCCCCCCCCCCCCZZZZRRRRRFFRFRRFUUUUUUUUUUUAAAUZZZVVVVVVFFVVVFQQQXXXQQQAJJJJOOOOOOOLLLLOOOOLMMJJJJJFFFFFFFFFFXFFFFUUUHHHHHHHHHHCUHUHUUUUU\nEEEEECCCCCCCCCCCCCCZRRRRRRRRFFRRRRRUUUUUUUUUUUUUUUZZXXXVVVVVVVVVVQQQQXXXQQQQQTTOOOOOOOLLLNOOOOJJJJJJJJJFFFFFFMMFFFFFFUUUHHHHHHHHHHHHHHHHHUUU\nCCCCCCCCCCCCCCCCCCCZRRRRRRRRFFRRRUUUUUUUUUUUUUUUUZZZXXXXXVVVVVVVVVVQXXXXQQQQQTTOOOOOOOLENNOOOOZZZJJJJJFFFFFFFMMFFFFFFUUUHHHHHHHHHHHHHHHHUUUU\nCCCCCCCCCCCEECCCCCCZRRRRRRRRRRRRRRUUUUUUUUUUUUUUUUXXXXXXXVVVVVVVVVVVXXXOOOOOOOOOOOOOOOOOOOOOOOZZZJJJJJJJFJJJMMMMFFFFUUUHHHHHHHHHHHHHHHUUUUUU\nCCCCCCCCCCCCCCCCCCCRRRRRRRRRRRRHHRHUUUHHHUUUUUUCUXXXXXXXVVVVVVVVVVVVVTTOOOOOOOOOOOOOOOOOOOOOOOZZZZJJJJJJJJMMMMMUUFUUUUUUUHHHHHHHHHUUUUUUUUUU\nEEEEECCCCCCCCCCCCCCRRRRRRRRRHRRHHHHHHHHHHUUUUUUCCXXXXXXXXVVVVVVKKKKVVTTOOOOOOOOOOOOOOOOOOOOOOOZZJJJJJJJJJJMMMMMUUUUUUUUUUHHHHHHHHHHUUUUUUUUU\nEEPPPCCCCCCCCCCRZRZRRRRRRRRHHHHHHHHHHHHHHHHUUUCCCCXXXXXXXVVVVVVKKKKKKTTOOOOOOOOOTTTTTOOOOOOOOOZZJJIIJJJJMJMMMMMMMUUUUUUUUHHHHHHHHHTTTUUUUUUU\nRPPPPCCCCCCCCCCRRRRRRRRRRRRRHHHHHHHHHHHHHUUUCUCFFXXXXXXXXVVVVVVVKKKKKTTOOOOOOOOOTTTTNOOOOOOOZZZZIIIJJJMMMMMMMMMMUUUUUUUUHHHHHHHHHTTWTTWWWUUU\nPPPPPCCCCCCCCCCARRRRRRRRRRRRROHHHHHHHHHHHHHHFFCFFQQXXXXXVVVVVVVKKKKKKKTTTTTTTTTTTTTNNOOOOOOOEZZZIIIIJMMMMMMMMMMMMUUUUUCCCCHHHHHHHHHWWWWWWWWU\nPPPPPPPPEECCCCCARRRRRRRRRRRRROHHHHHHHHHHHHFFFFFFFFQQXXVXVVVVVKKKKKKKKKKTTPTPPTTTTTTNNOOOOOOOEZEIIIIIISSMMMMMMMMMMUUUUCCCKCMHHHHHHRWWWWWWWDDD\nPPPPPPPPJJCCCCCUZZZRRURRRRRRRRHHHHHHHHHHHHFFFFFFFFFFFVVVVVVVVKKKKKKKKKKKKPPPPPPTTTTTNTOOOOOOEEEIIIIIIIIMMMMMMMMMMMMMCCCCCCHHHHHHHWWWWWWWWWDD\nPPPPPPRJJJCCCCCUZZRRUURRRURUUUUHHHHHHHHHHFFFFFFFFFFFFVVVVVVVTTDKKKKKKKKKKUPPPPPPPTTTTTOOOOOOEEIIIIIIIIIMMMMMMMMMMCCCCCCCCCHYYYHHHWWWWWWWWDDD\nPPPPPPRRJUCCCCCUZZZUURRRRUUUUUUHHHHHHHHHKFFFFFFFFFFFVVVVVVVTTTKKKKKKKKKKKKKPPPPPPPPTKKOOOOOOEEIIIISIIIIZMMMMMMMMMCCCCCCCCCYYYYYYHWWWWWWWWWDD\nPRRPRRRRRRUUUUZZZZZUUUUUUUUUUUUUHHJHHHHHFFFFFFFFFFFVVVVVVVVTTTTKTTKKKKKKKXXPPPPPPPPCCKOOOOOOEIIIIISUUIUMMMMMVMMTMCCCCCCCCDYYYYYYWWWWNWWWWWDD\nERRRRRRRRUUUUUUUZZUUUUUUUUUUUUUUHSSSHHHHFFFFFFFFFFFVVVVVVVVTTTTTTTKKKKKKKXXPPPPPPPPKKKOOOOOOESISISSUUUUUMMMMMMMTMCCCCCCCCCCCCCCDDWWDWWWWWDDD\nEERRRRRRJUUUUUUUZZZZUUUUUUUUUUUSSSSSSHHFFFFFFFFRFFFVVVVVZTTTTTTTTTKKKKKKXXXPPPPPPPPKKKKBEEESSSSSSSSSUUUUMMMMMMMTDCCCCCCCCCCCCCCDDDDDDDDDDDDD\nEERRRRRRRUUUUUUUZZZZZUUUUUUUUUUSSSSGSHHHFFFFFFFFFFVVVVVVZTTTTTTTTTKKKKKKKXXPPPPPPPXKKKKBBEEESSSSSSSSSSUUUUMMMMMMDCCCCCCCCCCCCCCDDDDDDDDDDDDD\nEERRRRRRRRUUUUUUUZZUUUUUUUUUUUUSSSSGGGGHDFFFFFFFFFMMVVVRTTTTTTTTTTKRRKKKXXXXPMPPPPXXKBBBQDEVSNSSSSSSSUUUUUUUUUUJDDDDDDCCCCCCCCCHHDDDDDDDDDDD\nERRRRRRRRRUUUAAAAAZZUUTUWUUUUUUUSSGGGGFFFFFFFFFFFFVVVVRRRRRRTDTTTTTRTXXXXXXXXPPPPXXQMQBQQQVVSSSSSSSSSUUUUUUUUUUDDDDDDDCCCCCCCCCHHHDDDDDDDDDD\nEERRRRRRRRRUAAAAAAAAAATTWWUUUUUUSSGGGGGFFFFFFFFFFRRRVVRRRRRRRTTTTTTTTXEXXXXXXXXXXXXQQQQQQQQVSSSSSSSSSUUUUUUUUUUDDDDDDDCCCCCCCCCHHDDDDDDDDDDD\nVVARRRRURRUUUAAAAAAAAWWWWWWUUUUUSFGGGGGFFFFFFFFFFRRRRRRRRRRRTTTTTTTTTEEXXXXXXXXXXXQQQQQQQQQSSSSSSSSSUUUUUUUUUUUDDDDDDDCCCCCCCCCHHHDDDDDDDDDD\nVVVKRRUUUUUUUAAJAAAAAWWWWWWUUUUUFFGGGGFFFFFFFFFFJRRRRRRRRRRRRRRTTTTEEEEXXXJXXXXXXXQQQQQQQQQRRSSSSSSSUUUUUUUUUUUUDDDDDDCCCCCCCCCHHHHDDDDDDDDD\nVDVKRRUUUUUUUAAAAAAAWWWWWWZUUUUFFFFGGGFFGFFFTTFJJJRFRRRRRRRRRRSTTTEEEEEEJJJJJXJXXXXQQQQQQQSSSSSSSSSUUUUUUUUUUUUUUDDDDCCCCCCCCCCHHUUHDDDDDDDD\nVDVVRUUUUUUUUAUAWAAAWWWWWWWWUUFFFFFFGGGGGFGGGJJJJJRRRRRRRRRREEEEEEEEEEEJJJJJJJJXXXXQQQQQQQQQSSSSSSSSUUUUUUUUUUUUGDDDDCCCCCCCCCCHHHHHDDDDDDDD\nVVVVUUUUUUUUUUUWWAAAWWWWWWWWUUUUFFFFFFGGGGGGGGJJJJRRRRRRRREEEEEEEEEEEEEJJJJJJJJXXXXQQQQQQQQQQSSSSSSSSUUUUAUUUUUGGGDDDCCCCCCHHHHHHHHHDHDDDDDD\nVVVVUUUVUDUUDDDDWWAWWWWWWWWWUUUFFFFFZZFGGGGGGGGJJJRRRRRRRRREEEEEEEEEEEEJJJJJJJJJJJQQQYYYYYZQQSSSSSSUUUUAUAUUUUGGGGDDDCCCCCCHHHHHHHHHHHDDDDDD\nVVVVUVUVUDDDDDDDWWWWWWWWWWWWUUUFFFFFZFFGFFGGGGGJJJJRRRRRRRRESEEEEEEEEEEJJJJJJJJJJJJJJYYYYYYYYSSSSSSUSUAAAAAUUUGGEGDDDCCCCCCHHHHHHHHHHHDDDDDD\nVVVVVVVVDDDDDDDDWWWWWWWWWWWWUUFFFFFFFFFFFFFGGGGGJJJJRRRRRRREEEEEEEEEEEEEJJJJJJJJJJJJJYYYYYYYYYSSSSSSSUAAAAAUUGGGGGDDDCCCCCCHHHHHHHHHHHHHDDDD\nVVVVVVDVDDDDDDDDWWWWWKKKWWWWWGTFFFFFFFFFFFFFFFGJJJJJRRRRREEEEEEEEEEEEEEJJJJJJJJJJJJJJJYYYYYYYYYYSCSCSUAAAAUUGGGGGGGGDCCCCCCHHHHHHHHHHHHHPDDD\nVVVVVVVDDDDDDDDDWWKWWKKKWWWWWGFFFFFFFFFFFFFFFFJJJJJJHLHRRQEEEEEEEEEEEEEJJJJJJJJJJJJJJYYYYYYYYYYYYCCCCKKKAAUUUUGGGGDDDCCCCCCHHPKHHHHHHHHHHDVD\nVVVVMVVMDDDDDDDDKKKKKKKKKKWKGGGFFFFFFFFFFFFFGFJJJJJHHHHRRQEEEEEEEEEEEEJJJJJJJJJJJJXJJYYYYYYYYYYYYCCCCKKKDUUUUUGGGGGDDDCCCCPPYPPHHHQHQQVHHDDD\nVVVMMVMMMDDDDDDDDKKKKKKKKKKKKGGFFFFFFFZZZZVGGGJJJJJHHHHHZHEEPEEEMMEMMJJJJJJJJJJJJJJJJYYYYYYYYYYCCCCCCCKKDDCUUUGGGGGDDDCCCCPPPPPPQFQQQVVVDDID\nVMMMMMMMMDDDDDDDDKKKKKKKKKKKGGGGGGGFFFVVVVVGGGJJJJHHHHHHHHHEPEEEIMMMMYYYJJJJJJJJJQJJJYYYYYYYYYYYCCCCCCKKCCCUUUUGYGGDDDCCCCPPPPPPQFQQQQVQIIII\nVMMMMMMNDDDDDDDDKKKKKKKKKKKKKGGGGGGFZZVVVVVVBGJJJHHHHHHHHHHHPPPEMMMQMMMMPJJJXJJJJJJWWYYYYYYYYYYYYCCCCCCKCCCCCCCYYGYDNNNNNNPPPPPOQQQQQQQQIIII\nMMMMNNNNDDDDDDDDDNKKKKKKKKKKKKGGGGGGGVVVVVVVBBBBBBHHHHHHHHHHPPMMMMMMMMMMMMMJJHHHHHJJWYYYYYYYYYYYYCCCCICCCCCCCCCYYYYLNNNOOPPPPPOOQQQQQQQQQQII\nMMMMMNNNNNDDDDDDDDKKKKKKKKKKKKGGGGGGGPUVVVVBBBBBBBBHHHHHHHHHHMMMMMMMMMMMMMMJHHHHHHHHHYYYYYYYYYYYCCCCIICCCCCCCCLLLLLLNNNOOKXXKKQQQQQQQQQQQIII\nMMMNNNNNNNNDDDDDDKKKKKKKKKKKKKGGGGGRRUUVVVBBBBBBBBBHHHHHHHHHMMMMMMMMMMMMMMUUUUUUUUKHKYYYYYYYYYTYCIIIIICCCCCCCCLLLILOOOOOOXXOXKKKQQQQQQQQQIII\nMMNNNNNNNNNNDDDDDKDJKKKKKKKEKGGGGGUUUUUQVVBBBBBBBBBBHHHHHHHHHMMMMMMMMMMMUUUUUUUUUUKKKYYYYYYYTTTTIILIIIIICCCCCILOOILOOOOOQXXXXXXQQQQQQQQQIIII\nMMNNNNNNNNNDDDDDDDDDYKKKPKPZZZGGGUUUUUUBBVBKBBBBBBBBHHHHHHHHHHEMMMMMMMMMMUUUUUUUUUKKKYYYYTTTTTTTIIIIIIIIICCIIIIOOOLOOOOOQQXXXXXXQQQQQQQIIIII\nMMNNNNNNNNNNDDDDDDDDDEKPPPPZZGGGGUUUUUUUBBBBBBBBBBBBHHHHHHHHEEEDDDDDDDMMMUUUUUUUQUKKKQYYYTTTTTTIIIIIIIIIINCIOIOOOOOOOOOOQOXXXXXXMQRRQQQIIIII\nNNNNNNNNNNDDDDDDDDDDDXPPPPPZZZGGUUUUUUUUUBBBBBBBBBOOHHHHHHHHHEEDDDDDDDMMMMUUUUUUQUKQRQFYTTTTTTTTTIIIIIIIIIIIOOOOOOOOOOOOOOOXXXXXQQXQQQQILIII\nNNNNNNNNNRRRDDIDDDDDDXXXXXXZZZZZUUUUUUUUUBBBBBBBBBOHHHHHHHHDDDDDDDDDDDMMMMUUUUUUQQZQQQQYTYYTTTTTTTIIIIIIIIIIOOOOOOOOOOOOOOXXXXXXXXXXQQQQLLII\nNNNNNNNNRRRRRRDZDDXXXXXXXXEZZZZZZXZUUUUUUUUBBBBOBOOOHHHHHHHDDDDDDDDDDDMMMUUUUUUUQQQQQQOYYYYYTTTTTTJJJJJJJJIIIIUIIOOOOOOOOOOXXXXXXLLLLQLLLLLU\nMMMNNNNNNRRRRDDDDDXXXXXXXXEZZZZZZZZUUUUUUUUUUUUOOOOOHHHHHHHDDDDDDDDDDDMMUUUUUUUUQQQQQQOYYYYYYTYTIIJJJJJJJJIIIIIIIOOOOOOOOOOOXXXXLLLNLLLLLLLU\nNNNNNNNNNRRRRRRLDOOOXXXXXXEZZZZZZZZQQUUUUUUUUUUUUVVVEEEHHHEDDDDDDDDDDDMUUUUUUUUUUUQQQQQYYYYYYYYTTTJJJJJJJJIIIIIIIOOOOOOOOXXXXXXXLLLLLLLLLLLU\nPNNNNNNNRRRRRRRLOOOOOXXXXXZZZZZZZZZZQUUUUUUUUUUUUUVEEEEEHHEDDDDDDDDDDDMUUUUUUUQQQQQQQQQYYYYYYYYYTIJJJJJJJJIEIIIIIOKOOOGKKXXXXXXXXLLLLLLLLUUU\nPNNNNNNNRRRRRODOOOOOOXXXXXIZZZZZZZZQQUJZUUUUUUUUUVVVVEEEEEEDDDDDDDDDDDUUUUUPUQQFFQQQQQQYYYYYYYYYYYJJJJJJJJIIIIIIOOKKKKKKKBBXXIXXXLLLLLLLLUUS\nPZNNNNNRRRRRNOOROOOOOXXXXIIIIZZZZZZQQQZZUUUUUUUUUUVVVEEEEEEDDDDDGGGGUUUUUUUUUUUHHQHHQYYYYYYYYYYYYYJJJJJJJJJJWWWWIKKKKKKKNKXXXIXLLLLLLLLLLSUS\nPZDNNNNZZZZZOOOOOOOOOOXXIIIIIZZZZZZQQZZZUUUUUUUUUUMBBEEEBBEDDDDDHHHHUUUUUUUUUUUHHHHHQYYYYYYYYYYYWWJJJJJJJJJJWWWWWKKKKKKKKKKXOXXGGGZLLLLLLSSS\nZZDDNNNZZZZZOOOOOOOOOOOXXIIIQZZZZZZQZZZZZZZZRUUUUUUBBBBBBEEDDDDDHHHHHHHGUUUUUHHHHHHHQYYYYYYYYYYYWWWWWIIIIJJJWWWWWKKKKKKKKKKOOXGGGGZLZZSSSSSS\nZZZZZZZZZZZZZOOOOOOOOOOTOOIIQZZZQQQQQQQZZZZZZZUUUWWBBBBBBEEEEEEHHHHHHUHHOOHHHHHHHHHHYYYYYYYYYYYYWWWWWIIIIJJJWWWWWKKKKKKKMMKOOOMGGZZZZZSSSSSS\nGZZOZZZZZZZZOIOZOOOOYOOOOOOQQQQQQQQQQQZZZZZZZZUUUWBBBBOBBEEEHEEEHHHHXHUOOOOOHHHHHHHHYYYYYYYYYYYUXXWWWIIIIIJJWWWWWWKKKKKQQMMMMMMMZZZZZZSSSSSS\nZZZZZZZZZZZOOOOOAOOYYOMMMMQQQQQQQQQZZZZZZZZZZJJJWWWOOOOOBEHEHHHHHHHHHHHOOOOHHHHHHHHHHHYYYYYYYYYYXXXXXXXXXXJJWWWWWWWWKKQQMMMMMMMZZZZZZTSOSSSS\nZZZZZZZZZZZOOOOOOXOOOOMMMMMQQQQQQQQZKZZZZZZZJJJJJJWWOOOOEEHHHHHHHHOOHHOOOOOHHHHHHHHHHHYYDDYYYNYFXXXXXXXXXXJJWWWWWWNNRRNNNMMMMMMMZZZZZZSSSSSS\nZZZZZZZZZZPOOOORRMMJOMMMMMQQQQQQQQQQZZZZZZJZJJJJJJJWOOOOOHHHHHHHHHOOOOOOOOYHHHHHHHHHHHHDDDYYYYFFXXXXXXXXXXXXWWWWNWNNNNNNMMMMMMMZZZZZZUSSSHSS\nZZZZZZZZZZZDDDOOOMMMMMMQQQQQQQQQQQQQXXZZJJJJJJJJJJJWOOOOOHHHHHHHHHHHOOOOOOOHHHHHHHHHLHDDDDYYYWXXXXXXXXXXXXXXWWWWNNNNNNNNMMMMMMZZZZZZZZSHHHHH\nZZZZZZZZZZDDDDDMMMMMMMMQQMPPQQQQQQQFQQAAJJJJJJJJJJOOOOOOHHHHHHHHHHHHOOOOOOVHHHHHHHHHHDDDDDYWWWAXXAXXXXXXXXXXWWWWWNNNNNNLMMMMMMMZZZZZZPSHHHHH\nZZZZZZZZZDDDDDDDMMMMMMMMMMMMQQQQQQQQQAAAJJJJJJJJJJUUOOOOHHHHHHHHHHHHOOOOOOVHHHHHHHHHHHHDDDAAAAAAAAXXXXXXXXXXXXWWWNNNNNNLMMMMMMMZDZZZZSSSHHHH\nZZZZZZZZTZZZDDDMMMMMMMMMMMMTQQQQQQQQQAAAJJJJJUJJUUUUOOOOAHHHHHHHHHHHOOOOOOVVHHHHHHHHHEEEDDDAAAAAAAXXXXXXXXXXXXWWWWWNNNNWMMMMMMWDDDZZZZHHHHHH\nZZZZZZZZZZZZDDDMMMMMMMMMMMMMQQQQQQQQQNAAJJUUUUUUUUUUOOOHHHHHHHHHWWWWWWOOOOOOHHHHHHHEEEEEDAAAAAAAAAXXXXXXXDEXXXWWWWWWWWWWWMMFDDDDDDYZDDDDHHHH\nZZZZZZZZZZDDDDDMMMMMMMMMMMJRRQQQQQQQQNNNJUUUUUUTUUTOOOOHHHHHHHHHWWWWWWOOOOOHHHHEEEEEEEEEDDDAAAAAAAXXXXXXDDDWWWWWWWWWRWWWWFFFDDDDDDYDDDDHHHHH\nZZZZZZZZZZZDMMDMMMMJJJJJJMJRRRQQBBBBQCNNJJUUUUTTTTTOOOTHHHWHHHHHWWWWWWOOOOOHHEEEEEEEEEEEDDDAAAASAAXXXDXXDDWWWWWWWWWWRRWFFFFFFDDDDDDDDDDHHHHH\nZZZZZZZZZZZMMMMMMMMMKJJJJMJQQQQQBBBNNNNNNNUUUUTTTTTOBTTTHWWQHHHHWWWWWWOJJOJJEEEEEEEEEEEECCCAASASXXXXXDDDDDDWWDWWWWWRRRFFFFDFDDDDDDDDDDDDHHHH\nZZZZZZZZQQQQQEQMMMMJJJJJJJJJKBBBBBNNNNNNNNNUUUTTTTTBBBTTTQQQNHNHWWWWWWXXJJJJJJJJEEEEEEEEECCASSSSSSSXIDDDDDDDDDWWWRWWRRRFFFDDDDDDDDDDDDDAHHHH\nZZZZZZZZRQQQQQQZZZZJOJJJJJJJJJJBBBNNNNNNNNNTTTTTTTTTBBBTTQQQNNNWWWWWWWNXXXJJXXXXXEEEEEECCCCASSSSSSTTDNDDDDDDDDWWWRRWRRRRRFDDDDDDDDDDDDDAHHHH\nZZZZZZZRRQQQQQQZZZZJJJJJJBBBBBBBBBBBNNNNNNNTTTTTTTTTTTTTTTQQNNNWWWWWWWNXXXXXXXXXXXEECCCCCCCCCCCSSSDDDDDDDDDDDDDWRRRRRRRFFFDDDDDDDDDDDDDDTTHH\nUUUZZUQQQQQQQQQZZZZJJJJJJBBBBBBBBMBNNNNNNNNTTTTTTTTTTTTTTQQQNNNWWWWWWWNNXXXXXXXXEEEEECCCCCCCCCCRSSDDDDDDDDDDDDDDRRRRRRRRRFDDDDDDDDDDDDTTTTTH\nUUUUUUSQQQQQQQQZBZZJJJJJBBBBBBBBMMMNNNNNNNNTTTDDTTTTTTTTTTQQQNQWWWWWWWXXXXXMMMMMMMEEEERCCCCCCSRRKDDDDDDDDDDDDDDDRRRRRRRFFFFDDDDDDDDDDTTTTTTT\nUUUUUSSQQQQQQQYBBZBBYYJBBBBBBBBMMMMNNNNNNNNDDDDTTTYTTTTTTTQQQQQQQQQQIIXXXXXMMMMMMMEEERRCCCCCCSRKKKGGDDDDDDDDDDRRRRRRRRRRRRFFDDDDDDDDDDTTTTTT\nUUUUSSSQQQQQQQBBBBBBBBBBBBBBBBMMMMMMNNNNNDDDDDDDDDTTTTTTTTQQQQQQQQQIIIXXMMMMMMMMMMEERRRRCCCCSSSKKKGKDKVDDDDDDCCRRRRRRRRRRRRFDUDDDDDDDDTTTTTT\nUUSSSSSQQQQQQQQBBEBBBBBBBBBBBBBMMMMMMMNNNTTTDDDSSSGGTSTTTQQQQQQQQQQIBBXXMMMMMMMMMMEERRRCCCSSSSSWKKKKKKVVDDDCDCCRRRRRRRRRRRFFFDDDNNNNDDDTTOOO\nUUSSSSQQQQQQQQQQBBBBBBBBBBBJJMMMMMMMMMTTTTTTTDDDSSSSSSSTTSSSQQQQQQQIIXXXMMMMMMMMMMWERRRCCCSSSSSWKSKKKKVVVDVCCCCCRRRERRRRFFFFFFDNNNNNDDTTOOOO\nSSSSSSQQQQQQQQQQBQQBBBBBBBBJJJJMMMMKMTTTTTTTTTDDSSSSSSSSSSSEEQQQQQIIIXXXMMMMMMMMMMWERERCCCCSSSSSKSKKKVVVVVVCCCCRRRRRRRRFFFFFFNNNNNNNNNOOOOOO\nSSSSSSSSQQQQQQQQQQQBBBBBBBBJJJJMMMMMMMTTTTTTTTDDSSSSSSSSSSSEEEQQQIIIIIXXMMMMMMMMMMEEEECCCCSSSSSSSSSSKKVVVVVVVCRRRRRRJJRFFFFNNNNNNNNNNNHOOOOO\nSSSSSSSSQQQQQQQQQQZBBBBBRRJJJJJJJJMMPPTTTSSSSSODSSSSSSSSSSSEEEQQQJEEIIXXMMMMMMMMMMEEEECCCCSSSSSSSSSKKKVVVVVVCCCCCRJJJJJFFFFFFFNNWNNNNNNNOOOP\nSSSSSSSSQQQUUQQQQQQBRRRRRRJJJJJJJJJMPPTTSSSSSSOOOSSSSSSSSEEEEQQQQEEMMMMMMMMMMMMMMEEEECCCCSSSSSSSSSSKKVVVVVSVDDDDDAJJJJJFFFFFFNNNNNNNNNNHHHHP\nSSSSSSSQQQUUUUUUQQQQRRRRRRJJJJVJVVJJPTTTTSSSSSOOSSSSSSSSSSEEEEEQEEEMMMMMMMMMMMMMEEEEEECEESESSSSSSKKKKKKVDDDSSDDDDDDJJJJFFFFFFMANNNNNNNHHHHHP\nSSSSSSSQUUUUUUURRQRRRRRRRJJJJJVVVVVVTTTSSSSSOOOOOOSSSSSSSEEEEEEEEEEMMMMMMMMMMMMMEEEEEEEEEEESSSSSKKKKKKKDDDDDDDDDDDJJJJJFFMMFMMMDMMMMNNUHHHHH\nSSSSSSSAAUUUUUURRRRRRRRRRJJJJJJVVVVVTTTTSSSSSOOOOOOKSSSSEEEEEEEEEEEMMMMMMMMMMMMMIEEEEEEEEEESYSKSSKKKKKKDDDDDDDDDDDJJJJFFFMMMMMMMMMMMHHHHHHHH\nSSSSSSAAAUUURRRRRRRRRRRRJJJJJVVVVVVVSVTSSSSSOOOOOOOKKSSOOEEEEEEEEEEMMMMMMMMMMMMMIIYEEEYYEEESHHKSKKKKKKKKKDDDDDDDDGGGGGMMMMMMMMMMMMMMHHHHHHHH\nSSSSSSSSAAAURERRRRRDDRRRRRRRJRVVVVVVVVVVSSSOOOOOOOOKKSOOOOOEEEEEEEEMMMMMMMMMMMMMIYYEEEYYEEEEHHHKKKKKKKKDDDDDDDDDDGGGGGMIMMMMMMMMMMMMHEHHHHHH\nSSSSSSSEAAAAEEEERRRDDDRDDDRRRRVVVVVVVVVVVSOOOOOOOOKKKKKKKOOBBEEEEEEMMMMMMMMMMMMMYYYYYYYYEEEHHHHHKKKHKKDDDDDDDDDDDDGGGMMMMMMMMMMMMMMMMHHHHHHH\nSSSSSSSEAEEAEEEEDDDDDDDDDRRRRRRVVVVVVVVVVVOOOOOOOOKKKKKKKBJBBEEEPEEMMMMMMMMIIYYYYYYYYYYYEEEHHHHHHHHHKKDDDDDDDDDDDDDDGGGGMMMMMMMMMMMMHHHHHHHH\nSSSSESSEEEEEEEVVDDDDDDDDDDRRRRRVVVVVVVVVVVOOOOOOKKKKKKBBBBBBEEEPPPIIIIIIIIIIIYYYYYYYYJJJEEHHHHHHHHHHHHDDDDDDDDDDDDDGGGMMMMMMMMMMMMMRHHHHHHHH\nSSEEEEEEEEEEEEDDDDDDDDDDDDDRVRVVVVVVVVVVVVMOMOMMMKKKBBBBBBBBEJEPPPIIIVIIIIIIIIYYYYYGYYYJJJHHHHHHHHHHHHDDDDDDDDDDDDDGCCCCMMMMMMMMMMMMHHHHHHHH\nSSSSEEEEEEEEEEWDDDDDDDDDDDDVVVVVVVVVVVVVVVMMMMMMKKKBBBBBBBBBBJJJPPJJIIIJIIIIJJYYYYYYYJJJJJHHHHHFHHHHDDDDPDDDDDDDDDDGCCCCSMMMMMMMMMHHHHHHHHHH\nSSSSEEEEEEEEEEWWDDDDDDDDDLDDYYYVVVVVVVVVVVMMMMMMKFHHBBBBBBBBZJJJJJXJIJJJJIIIJJYYYYYQYJJJJJJJZZZZZHHZZZDZDDDDZDDDCGGGCCCCSMMMMMMMMMHHHHHHHHHH\nSSSSSEEEEEEEEDDDDDDDDDDDDDYYYYYYVVVVVVVVVVMMMMMFFFHFBBNBBBBBJJJJJJJJJJJJJIIJJJYYJYYYJJJJJJJJZZZZZZZZZZZZZZDZZDAACCCCCCCCMMMMMMMHMMHHHHHHHHHH\nSSSSEEEEEEEEEEDDDDDDDDDDDYYYYYYVVVVVVVVXVVMMMMMMFFFFFBBBBBBJJJJJJJJJJJJJIIIJJJYJJJJJJJJJJJJJJZZZZZZZZZZZZZZZZZCCCCCCCCCCCMMMMMHHHHHHHHHHHHHH\nSSSEEEEEEEEEEEVDDDDDDDDDDYYYYYYYYVVVVVVVVVMMMMMMMFFFFFFFFFBJJJJJJJJJVJJJJIIIIJJJJJJJJJJJJJJZZZZZZZZZZZZZZZZZZZCZZCCCCCCCCCCMHMHHHHHHHHHHHHHH\nSSEEEEEEEWEEEEVVDDDDDDDYDYYYYYYYVVVVMMVVVMMMMMMMMMFFFFFFFFJJJJJJJJJJJJJJJJIIIJJJJJJJJJJJJJJJJZZZZZZZZZZZZZZZZZZZZCYCCCCCCCCCHHHHHHHHHHHHHHHH\nSSSEEEEEEWWWEVVVVVDDDDYYYYYYYYYYYVEVVMMMMMMMMMMMMMMFFFFFFFJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJZZZZZZZZZZZZZZZZZZZCYCCCCCCCCCCHHHHHHHHHHHHHHH\n"

#Day12.part1(input) |> IO.inspect(label: :day12_part1)
#Day12.part2(input) |> IO.inspect(label: :day12_part2)
```

```elixir
defmodule Day13 do
  import AOC, only: [int2d: 2, divmod: 2]

  def solve(input, offset) do
    for([[a1, a2], [b1, b2], [c1, c2]] <- input |> int2d(~r/[^0-9]+/) |> Enum.chunk_every(3),
        c1 = c1 + offset, c2 = c2 + offset,
        {a, r} = divmod(c1 * b2 - c2 * b1, a1 * b2 - a2 * b1), r == 0,
        {b, r} = divmod(c1 * a2 - c2 * a1, b1 * a2 - b2 * a1), r == 0,
        do: 3 * a + b) |> Enum.sum()
  end

  def part1(input), do: solve(input, 0)
  def part2(input), do: solve(input, 10000000000000)
end

input = "Button A: X+85, Y+71\nButton B: X+21, Y+84\nPrize: X=9947, Y=13426\n\nButton A: X+20, Y+62\nButton B: X+62, Y+27\nPrize: X=6092, Y=7618\n\nButton A: X+64, Y+14\nButton B: X+20, Y+48\nPrize: X=9128, Y=5754\n\nButton A: X+56, Y+12\nButton B: X+13, Y+49\nPrize: X=1136, Y=2092\n\nButton A: X+76, Y+51\nButton B: X+37, Y+97\nPrize: X=5111, Y=10286\n\nButton A: X+86, Y+24\nButton B: X+20, Y+22\nPrize: X=2154, Y=1734\n\nButton A: X+87, Y+96\nButton B: X+89, Y+13\nPrize: X=10425, Y=8436\n\nButton A: X+36, Y+35\nButton B: X+15, Y+88\nPrize: X=3270, Y=8612\n\nButton A: X+46, Y+82\nButton B: X+93, Y+24\nPrize: X=8545, Y=3748\n\nButton A: X+72, Y+21\nButton B: X+18, Y+60\nPrize: X=9494, Y=9626\n\nButton A: X+81, Y+25\nButton B: X+80, Y+91\nPrize: X=10929, Y=9142\n\nButton A: X+81, Y+18\nButton B: X+46, Y+67\nPrize: X=5003, Y=2588\n\nButton A: X+71, Y+34\nButton B: X+22, Y+35\nPrize: X=7247, Y=5134\n\nButton A: X+71, Y+12\nButton B: X+88, Y+86\nPrize: X=3459, Y=798\n\nButton A: X+96, Y+50\nButton B: X+54, Y+86\nPrize: X=9456, Y=6314\n\nButton A: X+49, Y+27\nButton B: X+13, Y+27\nPrize: X=4994, Y=2970\n\nButton A: X+44, Y+15\nButton B: X+27, Y+40\nPrize: X=5928, Y=4115\n\nButton A: X+25, Y+59\nButton B: X+60, Y+25\nPrize: X=16730, Y=332\n\nButton A: X+65, Y+15\nButton B: X+12, Y+33\nPrize: X=12944, Y=2786\n\nButton A: X+59, Y+57\nButton B: X+80, Y+15\nPrize: X=9585, Y=3405\n\nButton A: X+66, Y+22\nButton B: X+13, Y+66\nPrize: X=1717, Y=4334\n\nButton A: X+80, Y+81\nButton B: X+23, Y+96\nPrize: X=3227, Y=5376\n\nButton A: X+15, Y+39\nButton B: X+73, Y+39\nPrize: X=15440, Y=7868\n\nButton A: X+59, Y+22\nButton B: X+17, Y+44\nPrize: X=5609, Y=3146\n\nButton A: X+46, Y+21\nButton B: X+11, Y+32\nPrize: X=4973, Y=14627\n\nButton A: X+32, Y+64\nButton B: X+45, Y+14\nPrize: X=6683, Y=6178\n\nButton A: X+28, Y+42\nButton B: X+88, Y+29\nPrize: X=9068, Y=5774\n\nButton A: X+84, Y+63\nButton B: X+13, Y+31\nPrize: X=15406, Y=13732\n\nButton A: X+32, Y+60\nButton B: X+47, Y+17\nPrize: X=12321, Y=19487\n\nButton A: X+36, Y+19\nButton B: X+17, Y+34\nPrize: X=4005, Y=7269\n\nButton A: X+46, Y+17\nButton B: X+54, Y+77\nPrize: X=2284, Y=2042\n\nButton A: X+63, Y+26\nButton B: X+13, Y+38\nPrize: X=5021, Y=14566\n\nButton A: X+27, Y+77\nButton B: X+68, Y+18\nPrize: X=6392, Y=6442\n\nButton A: X+13, Y+52\nButton B: X+67, Y+31\nPrize: X=5103, Y=2637\n\nButton A: X+55, Y+73\nButton B: X+80, Y+13\nPrize: X=8415, Y=1944\n\nButton A: X+31, Y+62\nButton B: X+54, Y+29\nPrize: X=17003, Y=19155\n\nButton A: X+53, Y+22\nButton B: X+46, Y+66\nPrize: X=3732, Y=4598\n\nButton A: X+26, Y+57\nButton B: X+65, Y+31\nPrize: X=16058, Y=4996\n\nButton A: X+19, Y+50\nButton B: X+96, Y+18\nPrize: X=1105, Y=2204\n\nButton A: X+36, Y+83\nButton B: X+39, Y+16\nPrize: X=3477, Y=3951\n\nButton A: X+48, Y+31\nButton B: X+14, Y+43\nPrize: X=18770, Y=10200\n\nButton A: X+44, Y+12\nButton B: X+35, Y+81\nPrize: X=15232, Y=2192\n\nButton A: X+24, Y+51\nButton B: X+57, Y+25\nPrize: X=18914, Y=8198\n\nButton A: X+99, Y+18\nButton B: X+78, Y+85\nPrize: X=5712, Y=2809\n\nButton A: X+48, Y+30\nButton B: X+24, Y+49\nPrize: X=5048, Y=9409\n\nButton A: X+34, Y+85\nButton B: X+90, Y+14\nPrize: X=10194, Y=9238\n\nButton A: X+25, Y+72\nButton B: X+26, Y+18\nPrize: X=2107, Y=5670\n\nButton A: X+36, Y+53\nButton B: X+35, Y+14\nPrize: X=19164, Y=15240\n\nButton A: X+62, Y+42\nButton B: X+16, Y+77\nPrize: X=2350, Y=6951\n\nButton A: X+52, Y+26\nButton B: X+11, Y+20\nPrize: X=16911, Y=16316\n\nButton A: X+23, Y+57\nButton B: X+65, Y+24\nPrize: X=7618, Y=14318\n\nButton A: X+81, Y+19\nButton B: X+35, Y+56\nPrize: X=8572, Y=3540\n\nButton A: X+27, Y+61\nButton B: X+63, Y+22\nPrize: X=4238, Y=4516\n\nButton A: X+35, Y+15\nButton B: X+64, Y+99\nPrize: X=4489, Y=5574\n\nButton A: X+37, Y+56\nButton B: X+95, Y+30\nPrize: X=5412, Y=3526\n\nButton A: X+43, Y+77\nButton B: X+70, Y+33\nPrize: X=5902, Y=6413\n\nButton A: X+63, Y+24\nButton B: X+14, Y+63\nPrize: X=14599, Y=13073\n\nButton A: X+17, Y+44\nButton B: X+55, Y+26\nPrize: X=3109, Y=1126\n\nButton A: X+56, Y+99\nButton B: X+75, Y+16\nPrize: X=6353, Y=2487\n\nButton A: X+56, Y+81\nButton B: X+88, Y+28\nPrize: X=8328, Y=4103\n\nButton A: X+99, Y+59\nButton B: X+43, Y+95\nPrize: X=7598, Y=10078\n\nButton A: X+22, Y+62\nButton B: X+62, Y+13\nPrize: X=7828, Y=14184\n\nButton A: X+95, Y+14\nButton B: X+42, Y+94\nPrize: X=6248, Y=9614\n\nButton A: X+68, Y+50\nButton B: X+14, Y+69\nPrize: X=3108, Y=3342\n\nButton A: X+23, Y+13\nButton B: X+12, Y+30\nPrize: X=16675, Y=1299\n\nButton A: X+97, Y+39\nButton B: X+13, Y+95\nPrize: X=5860, Y=3972\n\nButton A: X+99, Y+21\nButton B: X+57, Y+87\nPrize: X=6249, Y=8367\n\nButton A: X+32, Y+68\nButton B: X+55, Y+19\nPrize: X=5915, Y=15959\n\nButton A: X+71, Y+41\nButton B: X+25, Y+56\nPrize: X=11725, Y=9873\n\nButton A: X+31, Y+48\nButton B: X+36, Y+17\nPrize: X=337, Y=5629\n\nButton A: X+84, Y+23\nButton B: X+11, Y+99\nPrize: X=5261, Y=5568\n\nButton A: X+90, Y+11\nButton B: X+65, Y+89\nPrize: X=8745, Y=1312\n\nButton A: X+25, Y+56\nButton B: X+53, Y+17\nPrize: X=7354, Y=10734\n\nButton A: X+73, Y+19\nButton B: X+47, Y+89\nPrize: X=668, Y=788\n\nButton A: X+22, Y+78\nButton B: X+62, Y+16\nPrize: X=2988, Y=5906\n\nButton A: X+16, Y+72\nButton B: X+39, Y+11\nPrize: X=17067, Y=7351\n\nButton A: X+15, Y+48\nButton B: X+48, Y+19\nPrize: X=11726, Y=1506\n\nButton A: X+68, Y+44\nButton B: X+34, Y+73\nPrize: X=7854, Y=6867\n\nButton A: X+64, Y+75\nButton B: X+77, Y+17\nPrize: X=11321, Y=6456\n\nButton A: X+65, Y+27\nButton B: X+13, Y+76\nPrize: X=1612, Y=4482\n\nButton A: X+12, Y+66\nButton B: X+16, Y+18\nPrize: X=2572, Y=7356\n\nButton A: X+58, Y+47\nButton B: X+16, Y+93\nPrize: X=1410, Y=4424\n\nButton A: X+39, Y+67\nButton B: X+37, Y+15\nPrize: X=11379, Y=11117\n\nButton A: X+11, Y+62\nButton B: X+58, Y+20\nPrize: X=14896, Y=12112\n\nButton A: X+59, Y+19\nButton B: X+22, Y+65\nPrize: X=2559, Y=8749\n\nButton A: X+25, Y+29\nButton B: X+93, Y+15\nPrize: X=10571, Y=3253\n\nButton A: X+38, Y+14\nButton B: X+11, Y+69\nPrize: X=2599, Y=2841\n\nButton A: X+61, Y+35\nButton B: X+29, Y+59\nPrize: X=16543, Y=13201\n\nButton A: X+92, Y+44\nButton B: X+32, Y+91\nPrize: X=9344, Y=10903\n\nButton A: X+21, Y+56\nButton B: X+40, Y+11\nPrize: X=9942, Y=5041\n\nButton A: X+15, Y+42\nButton B: X+44, Y+25\nPrize: X=9768, Y=12133\n\nButton A: X+67, Y+12\nButton B: X+37, Y+35\nPrize: X=4653, Y=2706\n\nButton A: X+21, Y+85\nButton B: X+85, Y+48\nPrize: X=8306, Y=5495\n\nButton A: X+20, Y+45\nButton B: X+64, Y+26\nPrize: X=12772, Y=15383\n\nButton A: X+65, Y+12\nButton B: X+22, Y+85\nPrize: X=6724, Y=3458\n\nButton A: X+19, Y+41\nButton B: X+30, Y+14\nPrize: X=16402, Y=10018\n\nButton A: X+17, Y+48\nButton B: X+48, Y+20\nPrize: X=13777, Y=12736\n\nButton A: X+71, Y+18\nButton B: X+52, Y+83\nPrize: X=10961, Y=9202\n\nButton A: X+36, Y+14\nButton B: X+19, Y+61\nPrize: X=10809, Y=12851\n\nButton A: X+19, Y+15\nButton B: X+15, Y+68\nPrize: X=2004, Y=6524\n\nButton A: X+69, Y+36\nButton B: X+30, Y+95\nPrize: X=5961, Y=9934\n\nButton A: X+30, Y+53\nButton B: X+54, Y+29\nPrize: X=14246, Y=18565\n\nButton A: X+25, Y+74\nButton B: X+63, Y+27\nPrize: X=5952, Y=5019\n\nButton A: X+18, Y+52\nButton B: X+63, Y+36\nPrize: X=15371, Y=14440\n\nButton A: X+17, Y+56\nButton B: X+68, Y+34\nPrize: X=17346, Y=5408\n\nButton A: X+11, Y+35\nButton B: X+62, Y+33\nPrize: X=890, Y=4689\n\nButton A: X+46, Y+24\nButton B: X+20, Y+37\nPrize: X=9402, Y=10611\n\nButton A: X+92, Y+12\nButton B: X+36, Y+64\nPrize: X=9708, Y=4528\n\nButton A: X+97, Y+75\nButton B: X+22, Y+63\nPrize: X=4335, Y=6939\n\nButton A: X+28, Y+48\nButton B: X+36, Y+17\nPrize: X=2640, Y=2916\n\nButton A: X+24, Y+65\nButton B: X+50, Y+16\nPrize: X=10692, Y=15010\n\nButton A: X+28, Y+58\nButton B: X+25, Y+13\nPrize: X=18299, Y=9035\n\nButton A: X+45, Y+15\nButton B: X+43, Y+79\nPrize: X=4024, Y=2182\n\nButton A: X+48, Y+92\nButton B: X+90, Y+13\nPrize: X=9336, Y=9600\n\nButton A: X+11, Y+85\nButton B: X+62, Y+14\nPrize: X=4059, Y=5785\n\nButton A: X+12, Y+41\nButton B: X+23, Y+13\nPrize: X=11105, Y=1262\n\nButton A: X+73, Y+29\nButton B: X+16, Y+65\nPrize: X=9268, Y=15090\n\nButton A: X+55, Y+12\nButton B: X+43, Y+86\nPrize: X=9944, Y=14158\n\nButton A: X+47, Y+67\nButton B: X+79, Y+36\nPrize: X=7070, Y=4179\n\nButton A: X+57, Y+14\nButton B: X+25, Y+80\nPrize: X=5581, Y=6622\n\nButton A: X+57, Y+37\nButton B: X+24, Y+94\nPrize: X=3456, Y=6086\n\nButton A: X+87, Y+20\nButton B: X+39, Y+60\nPrize: X=4485, Y=5420\n\nButton A: X+75, Y+16\nButton B: X+23, Y+83\nPrize: X=10499, Y=13180\n\nButton A: X+37, Y+50\nButton B: X+48, Y+17\nPrize: X=6090, Y=4592\n\nButton A: X+66, Y+36\nButton B: X+24, Y+49\nPrize: X=18632, Y=15872\n\nButton A: X+45, Y+26\nButton B: X+20, Y+35\nPrize: X=12485, Y=17298\n\nButton A: X+70, Y+13\nButton B: X+92, Y+99\nPrize: X=3000, Y=2605\n\nButton A: X+56, Y+16\nButton B: X+12, Y+64\nPrize: X=2036, Y=15792\n\nButton A: X+20, Y+12\nButton B: X+16, Y+35\nPrize: X=1412, Y=19297\n\nButton A: X+58, Y+20\nButton B: X+22, Y+56\nPrize: X=7762, Y=11796\n\nButton A: X+60, Y+41\nButton B: X+39, Y+86\nPrize: X=2973, Y=4821\n\nButton A: X+16, Y+69\nButton B: X+44, Y+11\nPrize: X=16120, Y=18160\n\nButton A: X+28, Y+65\nButton B: X+54, Y+21\nPrize: X=5684, Y=13076\n\nButton A: X+77, Y+21\nButton B: X+12, Y+55\nPrize: X=13594, Y=9291\n\nButton A: X+79, Y+76\nButton B: X+14, Y+72\nPrize: X=2314, Y=6616\n\nButton A: X+17, Y+38\nButton B: X+56, Y+19\nPrize: X=5724, Y=2571\n\nButton A: X+93, Y+15\nButton B: X+28, Y+40\nPrize: X=10183, Y=4765\n\nButton A: X+46, Y+22\nButton B: X+14, Y+37\nPrize: X=11324, Y=4821\n\nButton A: X+59, Y+60\nButton B: X+16, Y+88\nPrize: X=4381, Y=9548\n\nButton A: X+28, Y+49\nButton B: X+53, Y+19\nPrize: X=9050, Y=12610\n\nButton A: X+57, Y+19\nButton B: X+31, Y+61\nPrize: X=8787, Y=3921\n\nButton A: X+98, Y+35\nButton B: X+29, Y+43\nPrize: X=11035, Y=6324\n\nButton A: X+68, Y+14\nButton B: X+21, Y+66\nPrize: X=2087, Y=1178\n\nButton A: X+34, Y+94\nButton B: X+29, Y+17\nPrize: X=5335, Y=9127\n\nButton A: X+25, Y+90\nButton B: X+84, Y+54\nPrize: X=7831, Y=7326\n\nButton A: X+38, Y+85\nButton B: X+57, Y+12\nPrize: X=6352, Y=16470\n\nButton A: X+12, Y+37\nButton B: X+81, Y+57\nPrize: X=18107, Y=14954\n\nButton A: X+13, Y+78\nButton B: X+89, Y+24\nPrize: X=1935, Y=4470\n\nButton A: X+65, Y+37\nButton B: X+23, Y+46\nPrize: X=3654, Y=3495\n\nButton A: X+17, Y+20\nButton B: X+93, Y+20\nPrize: X=8090, Y=3080\n\nButton A: X+93, Y+30\nButton B: X+20, Y+28\nPrize: X=2432, Y=1000\n\nButton A: X+71, Y+84\nButton B: X+52, Y+15\nPrize: X=7516, Y=5217\n\nButton A: X+21, Y+54\nButton B: X+52, Y+16\nPrize: X=2147, Y=18242\n\nButton A: X+39, Y+16\nButton B: X+18, Y+46\nPrize: X=1902, Y=3020\n\nButton A: X+86, Y+33\nButton B: X+22, Y+35\nPrize: X=1794, Y=2335\n\nButton A: X+11, Y+30\nButton B: X+37, Y+20\nPrize: X=7470, Y=260\n\nButton A: X+16, Y+62\nButton B: X+58, Y+16\nPrize: X=18140, Y=7710\n\nButton A: X+82, Y+33\nButton B: X+15, Y+80\nPrize: X=8467, Y=8363\n\nButton A: X+69, Y+34\nButton B: X+20, Y+43\nPrize: X=3144, Y=18421\n\nButton A: X+62, Y+49\nButton B: X+28, Y+71\nPrize: X=4712, Y=5239\n\nButton A: X+62, Y+19\nButton B: X+15, Y+77\nPrize: X=6321, Y=9105\n\nButton A: X+26, Y+60\nButton B: X+38, Y+18\nPrize: X=12474, Y=14912\n\nButton A: X+70, Y+28\nButton B: X+33, Y+95\nPrize: X=4823, Y=9373\n\nButton A: X+64, Y+30\nButton B: X+12, Y+49\nPrize: X=5508, Y=2749\n\nButton A: X+18, Y+71\nButton B: X+37, Y+21\nPrize: X=1617, Y=4504\n\nButton A: X+79, Y+21\nButton B: X+17, Y+69\nPrize: X=19369, Y=5513\n\nButton A: X+30, Y+15\nButton B: X+20, Y+39\nPrize: X=16260, Y=9683\n\nButton A: X+97, Y+55\nButton B: X+27, Y+65\nPrize: X=5856, Y=6600\n\nButton A: X+11, Y+18\nButton B: X+93, Y+26\nPrize: X=9880, Y=4180\n\nButton A: X+18, Y+47\nButton B: X+63, Y+22\nPrize: X=5318, Y=10167\n\nButton A: X+12, Y+37\nButton B: X+71, Y+39\nPrize: X=15472, Y=8080\n\nButton A: X+52, Y+11\nButton B: X+12, Y+43\nPrize: X=9524, Y=7797\n\nButton A: X+14, Y+59\nButton B: X+68, Y+15\nPrize: X=9658, Y=2446\n\nButton A: X+34, Y+63\nButton B: X+49, Y+27\nPrize: X=15893, Y=881\n\nButton A: X+97, Y+52\nButton B: X+54, Y+89\nPrize: X=13925, Y=13350\n\nButton A: X+13, Y+58\nButton B: X+85, Y+15\nPrize: X=6564, Y=6339\n\nButton A: X+17, Y+35\nButton B: X+66, Y+31\nPrize: X=8789, Y=10213\n\nButton A: X+78, Y+32\nButton B: X+25, Y+80\nPrize: X=7141, Y=7184\n\nButton A: X+34, Y+13\nButton B: X+14, Y+61\nPrize: X=10584, Y=1026\n\nButton A: X+38, Y+65\nButton B: X+39, Y+13\nPrize: X=5996, Y=16032\n\nButton A: X+21, Y+11\nButton B: X+19, Y+52\nPrize: X=16972, Y=16513\n\nButton A: X+29, Y+63\nButton B: X+30, Y+15\nPrize: X=4874, Y=8783\n\nButton A: X+56, Y+21\nButton B: X+12, Y+63\nPrize: X=14744, Y=872\n\nButton A: X+25, Y+93\nButton B: X+21, Y+19\nPrize: X=1514, Y=5100\n\nButton A: X+66, Y+11\nButton B: X+16, Y+74\nPrize: X=8246, Y=18099\n\nButton A: X+45, Y+96\nButton B: X+88, Y+29\nPrize: X=8599, Y=4376\n\nButton A: X+40, Y+19\nButton B: X+26, Y+60\nPrize: X=4006, Y=15275\n\nButton A: X+50, Y+15\nButton B: X+39, Y+78\nPrize: X=12516, Y=8927\n\nButton A: X+29, Y+12\nButton B: X+12, Y+28\nPrize: X=8787, Y=4740\n\nButton A: X+54, Y+11\nButton B: X+15, Y+50\nPrize: X=15656, Y=6554\n\nButton A: X+78, Y+99\nButton B: X+97, Y+27\nPrize: X=10526, Y=5094\n\nButton A: X+32, Y+76\nButton B: X+91, Y+24\nPrize: X=3316, Y=2496\n\nButton A: X+31, Y+95\nButton B: X+94, Y+34\nPrize: X=2968, Y=3252\n\nButton A: X+50, Y+80\nButton B: X+54, Y+21\nPrize: X=5372, Y=2513\n\nButton A: X+85, Y+12\nButton B: X+47, Y+82\nPrize: X=8783, Y=4556\n\nButton A: X+12, Y+53\nButton B: X+85, Y+35\nPrize: X=18387, Y=7483\n\nButton A: X+14, Y+44\nButton B: X+94, Y+44\nPrize: X=5970, Y=5940\n\nButton A: X+38, Y+26\nButton B: X+13, Y+41\nPrize: X=4108, Y=5636\n\nButton A: X+51, Y+79\nButton B: X+77, Y+34\nPrize: X=6236, Y=2923\n\nButton A: X+82, Y+95\nButton B: X+89, Y+17\nPrize: X=10900, Y=8667\n\nButton A: X+14, Y+54\nButton B: X+76, Y+50\nPrize: X=3624, Y=4982\n\nButton A: X+67, Y+12\nButton B: X+23, Y+83\nPrize: X=10446, Y=4541\n\nButton A: X+24, Y+60\nButton B: X+63, Y+33\nPrize: X=17069, Y=15263\n\nButton A: X+20, Y+95\nButton B: X+43, Y+28\nPrize: X=1916, Y=6986\n\nButton A: X+50, Y+21\nButton B: X+25, Y+67\nPrize: X=14100, Y=18316\n\nButton A: X+40, Y+13\nButton B: X+39, Y+59\nPrize: X=13034, Y=11426\n\nButton A: X+38, Y+54\nButton B: X+33, Y+13\nPrize: X=8021, Y=11177\n\nButton A: X+13, Y+54\nButton B: X+77, Y+13\nPrize: X=9827, Y=10690\n\nButton A: X+50, Y+22\nButton B: X+16, Y+26\nPrize: X=11924, Y=7616\n\nButton A: X+23, Y+58\nButton B: X+60, Y+27\nPrize: X=5109, Y=2442\n\nButton A: X+38, Y+63\nButton B: X+44, Y+20\nPrize: X=7734, Y=12771\n\nButton A: X+52, Y+76\nButton B: X+47, Y+20\nPrize: X=5926, Y=6616\n\nButton A: X+24, Y+98\nButton B: X+73, Y+11\nPrize: X=5449, Y=8183\n\nButton A: X+56, Y+85\nButton B: X+68, Y+12\nPrize: X=4252, Y=3079\n\nButton A: X+19, Y+34\nButton B: X+47, Y+23\nPrize: X=839, Y=479\n\nButton A: X+20, Y+39\nButton B: X+43, Y+12\nPrize: X=6796, Y=3395\n\nButton A: X+65, Y+25\nButton B: X+23, Y+58\nPrize: X=11974, Y=11469\n\nButton A: X+17, Y+52\nButton B: X+57, Y+17\nPrize: X=461, Y=2091\n\nButton A: X+27, Y+53\nButton B: X+55, Y+29\nPrize: X=1810, Y=1342\n\nButton A: X+24, Y+78\nButton B: X+68, Y+11\nPrize: X=7508, Y=1271\n\nButton A: X+34, Y+94\nButton B: X+99, Y+25\nPrize: X=9055, Y=3397\n\nButton A: X+43, Y+20\nButton B: X+49, Y+76\nPrize: X=17870, Y=4136\n\nButton A: X+49, Y+16\nButton B: X+17, Y+29\nPrize: X=7755, Y=14760\n\nButton A: X+55, Y+25\nButton B: X+14, Y+66\nPrize: X=2621, Y=6499\n\nButton A: X+51, Y+58\nButton B: X+89, Y+24\nPrize: X=7560, Y=4428\n\nButton A: X+34, Y+95\nButton B: X+52, Y+30\nPrize: X=4234, Y=7795\n\nButton A: X+95, Y+11\nButton B: X+25, Y+99\nPrize: X=8155, Y=8921\n\nButton A: X+66, Y+59\nButton B: X+13, Y+57\nPrize: X=7405, Y=9660\n\nButton A: X+37, Y+54\nButton B: X+92, Y+18\nPrize: X=8410, Y=1926\n\nButton A: X+14, Y+33\nButton B: X+56, Y+23\nPrize: X=8152, Y=4602\n\nButton A: X+14, Y+34\nButton B: X+65, Y+20\nPrize: X=13444, Y=554\n\nButton A: X+21, Y+54\nButton B: X+78, Y+20\nPrize: X=6282, Y=4236\n\nButton A: X+40, Y+21\nButton B: X+13, Y+31\nPrize: X=3100, Y=5871\n\nButton A: X+37, Y+80\nButton B: X+43, Y+11\nPrize: X=7602, Y=14473\n\nButton A: X+86, Y+50\nButton B: X+20, Y+92\nPrize: X=5016, Y=7176\n\nButton A: X+38, Y+18\nButton B: X+13, Y+36\nPrize: X=2274, Y=2808\n\nButton A: X+21, Y+65\nButton B: X+44, Y+15\nPrize: X=3749, Y=2030\n\nButton A: X+53, Y+15\nButton B: X+22, Y+53\nPrize: X=15552, Y=2522\n\nButton A: X+72, Y+24\nButton B: X+25, Y+73\nPrize: X=15680, Y=2048\n\nButton A: X+37, Y+24\nButton B: X+12, Y+40\nPrize: X=4607, Y=5920\n\nButton A: X+73, Y+42\nButton B: X+26, Y+56\nPrize: X=16573, Y=14662\n\nButton A: X+68, Y+21\nButton B: X+18, Y+58\nPrize: X=5818, Y=3239\n\nButton A: X+16, Y+35\nButton B: X+72, Y+43\nPrize: X=6664, Y=6106\n\nButton A: X+84, Y+81\nButton B: X+16, Y+81\nPrize: X=5316, Y=11421\n\nButton A: X+29, Y+15\nButton B: X+27, Y+74\nPrize: X=2469, Y=2898\n\nButton A: X+15, Y+86\nButton B: X+75, Y+38\nPrize: X=2955, Y=5574\n\nButton A: X+74, Y+22\nButton B: X+19, Y+71\nPrize: X=8711, Y=2627\n\nButton A: X+16, Y+30\nButton B: X+48, Y+29\nPrize: X=5232, Y=13215\n\nButton A: X+12, Y+41\nButton B: X+79, Y+47\nPrize: X=8121, Y=5678\n\nButton A: X+20, Y+37\nButton B: X+38, Y+21\nPrize: X=14746, Y=1962\n\nButton A: X+35, Y+58\nButton B: X+80, Y+20\nPrize: X=3555, Y=1726\n\nButton A: X+59, Y+16\nButton B: X+13, Y+71\nPrize: X=8034, Y=5167\n\nButton A: X+22, Y+56\nButton B: X+73, Y+21\nPrize: X=8784, Y=7196\n\nButton A: X+73, Y+12\nButton B: X+25, Y+31\nPrize: X=3979, Y=3128\n\nButton A: X+72, Y+70\nButton B: X+11, Y+40\nPrize: X=7193, Y=9660\n\nButton A: X+41, Y+18\nButton B: X+30, Y+49\nPrize: X=16627, Y=2420\n\nButton A: X+51, Y+15\nButton B: X+11, Y+24\nPrize: X=4579, Y=1301\n\nButton A: X+50, Y+37\nButton B: X+24, Y+56\nPrize: X=3574, Y=3639\n\nButton A: X+17, Y+34\nButton B: X+52, Y+18\nPrize: X=2105, Y=15858\n\nButton A: X+40, Y+74\nButton B: X+98, Y+38\nPrize: X=1540, Y=1416\n\nButton A: X+80, Y+13\nButton B: X+41, Y+76\nPrize: X=5729, Y=7102\n\nButton A: X+18, Y+53\nButton B: X+64, Y+12\nPrize: X=18926, Y=2619\n\nButton A: X+28, Y+82\nButton B: X+72, Y+12\nPrize: X=7592, Y=3740\n\nButton A: X+46, Y+17\nButton B: X+39, Y+61\nPrize: X=11153, Y=7031\n\nButton A: X+88, Y+46\nButton B: X+43, Y+88\nPrize: X=7711, Y=9076\n\nButton A: X+97, Y+60\nButton B: X+33, Y+99\nPrize: X=6934, Y=6018\n\nButton A: X+30, Y+13\nButton B: X+51, Y+70\nPrize: X=5096, Y=903\n\nButton A: X+80, Y+40\nButton B: X+13, Y+48\nPrize: X=5087, Y=3712\n\nButton A: X+81, Y+43\nButton B: X+38, Y+79\nPrize: X=4714, Y=4032\n\nButton A: X+43, Y+17\nButton B: X+22, Y+34\nPrize: X=10335, Y=2029\n\nButton A: X+35, Y+15\nButton B: X+37, Y+60\nPrize: X=18072, Y=16940\n\nButton A: X+56, Y+17\nButton B: X+17, Y+47\nPrize: X=5477, Y=17402\n\nButton A: X+49, Y+24\nButton B: X+11, Y+32\nPrize: X=16331, Y=13400\n\nButton A: X+78, Y+82\nButton B: X+88, Y+19\nPrize: X=4818, Y=1757\n\nButton A: X+51, Y+11\nButton B: X+17, Y+39\nPrize: X=16088, Y=11070\n\nButton A: X+43, Y+25\nButton B: X+29, Y+56\nPrize: X=11532, Y=3270\n\nButton A: X+97, Y+23\nButton B: X+94, Y+92\nPrize: X=16932, Y=9522\n\nButton A: X+61, Y+24\nButton B: X+11, Y+30\nPrize: X=18123, Y=18320\n\nButton A: X+20, Y+38\nButton B: X+32, Y+14\nPrize: X=17300, Y=7256\n\nButton A: X+22, Y+80\nButton B: X+82, Y+16\nPrize: X=444, Y=768\n\nButton A: X+12, Y+61\nButton B: X+77, Y+23\nPrize: X=18198, Y=3897\n\nButton A: X+13, Y+93\nButton B: X+72, Y+50\nPrize: X=2887, Y=7631\n\nButton A: X+57, Y+20\nButton B: X+19, Y+44\nPrize: X=11615, Y=3772\n\nButton A: X+29, Y+55\nButton B: X+47, Y+20\nPrize: X=13874, Y=2240\n\nButton A: X+56, Y+32\nButton B: X+16, Y+30\nPrize: X=5560, Y=3782\n\nButton A: X+47, Y+15\nButton B: X+18, Y+41\nPrize: X=15886, Y=6408\n\nButton A: X+31, Y+67\nButton B: X+46, Y+17\nPrize: X=3716, Y=4817\n\nButton A: X+38, Y+13\nButton B: X+54, Y+76\nPrize: X=6854, Y=9010\n\nButton A: X+19, Y+60\nButton B: X+49, Y+12\nPrize: X=7644, Y=5576\n\nButton A: X+61, Y+18\nButton B: X+14, Y+54\nPrize: X=11432, Y=9926\n\nButton A: X+14, Y+56\nButton B: X+36, Y+17\nPrize: X=14644, Y=14881\n\nButton A: X+60, Y+21\nButton B: X+19, Y+47\nPrize: X=959, Y=13763\n\nButton A: X+64, Y+15\nButton B: X+16, Y+69\nPrize: X=11312, Y=8135\n\nButton A: X+13, Y+55\nButton B: X+81, Y+31\nPrize: X=4965, Y=10539\n\nButton A: X+12, Y+57\nButton B: X+79, Y+12\nPrize: X=13806, Y=19367\n\nButton A: X+31, Y+21\nButton B: X+16, Y+47\nPrize: X=3046, Y=4884\n\nButton A: X+69, Y+34\nButton B: X+18, Y+90\nPrize: X=2625, Y=9082\n\nButton A: X+11, Y+91\nButton B: X+94, Y+43\nPrize: X=6738, Y=6521\n\nButton A: X+42, Y+64\nButton B: X+41, Y+17\nPrize: X=14992, Y=19084\n\nButton A: X+26, Y+56\nButton B: X+55, Y+14\nPrize: X=9439, Y=19758\n\nButton A: X+31, Y+11\nButton B: X+12, Y+49\nPrize: X=12096, Y=439\n\nButton A: X+36, Y+13\nButton B: X+15, Y+94\nPrize: X=1818, Y=1188\n\nButton A: X+64, Y+13\nButton B: X+43, Y+97\nPrize: X=5574, Y=2721\n\nButton A: X+49, Y+35\nButton B: X+39, Y+97\nPrize: X=6430, Y=7566\n\nButton A: X+18, Y+78\nButton B: X+36, Y+18\nPrize: X=3078, Y=6714\n\nButton A: X+12, Y+30\nButton B: X+56, Y+33\nPrize: X=18052, Y=7343\n\nButton A: X+22, Y+70\nButton B: X+39, Y+11\nPrize: X=2986, Y=12450\n\nButton A: X+14, Y+59\nButton B: X+73, Y+16\nPrize: X=5132, Y=5489\n\nButton A: X+49, Y+16\nButton B: X+41, Y+68\nPrize: X=2601, Y=564\n\nButton A: X+63, Y+90\nButton B: X+84, Y+11\nPrize: X=12810, Y=8054\n\nButton A: X+41, Y+14\nButton B: X+27, Y+52\nPrize: X=2989, Y=18458\n\nButton A: X+20, Y+96\nButton B: X+78, Y+22\nPrize: X=3298, Y=8430\n\nButton A: X+33, Y+80\nButton B: X+56, Y+15\nPrize: X=4260, Y=5980\n\nButton A: X+76, Y+16\nButton B: X+14, Y+81\nPrize: X=4602, Y=7135\n\nButton A: X+49, Y+20\nButton B: X+18, Y+73\nPrize: X=3478, Y=2667\n\nButton A: X+42, Y+44\nButton B: X+17, Y+96\nPrize: X=3420, Y=4052\n\nButton A: X+11, Y+59\nButton B: X+58, Y+26\nPrize: X=7683, Y=7795\n\nButton A: X+85, Y+48\nButton B: X+13, Y+86\nPrize: X=8681, Y=7026\n\nButton A: X+18, Y+61\nButton B: X+43, Y+14\nPrize: X=9307, Y=14925\n\nButton A: X+31, Y+54\nButton B: X+33, Y+16\nPrize: X=11353, Y=508\n"

Day13.part1(input) |> IO.inspect(label: :day13_part1, charlists: :as_lists)
Day13.part2(input) |> IO.inspect(label: :day13_part2, charlists: :as_lists)
```

```elixir
defmodule Day14 do
  import AOC, only: [int2d: 2, mod: 2]

  def part1(input) do
    {w, h, n} = {101, 103, 100}
    for [x, y, u, v] <- int2d(input, ~r/[^\d-]+/), reduce: Map.from_keys([1, 2, 3, 4], 0) do
      acc ->
        case {mod(x + u * n, w), mod(y + v * n, h)} do
          {x, y} when x < div(w, 2) and y < div(h, 2) -> Map.update(acc, 1, 1, & &1 + 1)
          {x, y} when x > div(w, 2) and y < div(h, 2) -> Map.update(acc, 2, 1, & &1 + 1)
          {x, y} when x < div(w, 2) and y > div(h, 2) -> Map.update(acc, 3, 1, & &1 + 1)
          {x, y} when x > div(w, 2) and y > div(h, 2) -> Map.update(acc, 4, 1, & &1 + 1)
          _ -> acc
        end
    end |> Map.values() |> Enum.product()
  end

  def sim(ps, w, h, n) do
    for [x, y, u, v] <- ps, into: %{}, do: {{mod(x + u * n, w), mod(y + v * n, h)}, true}
  end

  def longest(m, w, h) do
    for y <- 0..h - 1, x <- 0..w - 1, reduce: {0, 0} do
      {acc, acc2} ->
          case {!!m[{x - 1, y}], !!m[{x, y}]} do
            {false, true} -> {1, acc2}
            {true, true} -> {acc + 1, max(acc + 1, acc2)}
            _ -> {acc, acc2}
          end
    end |> elem(1)
  end

  def loop(ps, w, h, n) do
    m = sim(ps, w, h, n)
    case longest(m, w, h) > 10 do
      true -> n
      _ -> loop(ps, w, h, n + 1)
    end
  end

  def print(m, w, h) do
    for y <- 0..h-1 do
      for x <- 0..w-1 do
        m[{x, y}] && "." || " "
      end |> Enum.join() |> IO.inspect()
    end
  end

  def part2(input) do
    {w, h} = {101, 103}
    ps = int2d(input, ~r/[^\d-]+/)
    loop(ps, w, h, 1)
    |> tap(fn n -> print(sim(ps, w, h, n), w, h) end)
  end
end

input = "p=67,43 v=80,86\np=47,24 v=-9,-96\np=6,38 v=10,81\np=73,92 v=36,-93\np=74,10 v=-35,19\np=57,59 v=-5,71\np=21,10 v=48,80\np=65,64 v=81,-36\np=79,65 v=-2,18\np=78,87 v=29,-98\np=97,66 v=-90,86\np=18,59 v=72,-90\np=14,32 v=24,-78\np=12,63 v=-5,4\np=69,18 v=52,59\np=52,79 v=22,18\np=62,72 v=-41,-29\np=27,12 v=23,-14\np=33,51 v=-92,22\np=5,9 v=-21,-49\np=37,69 v=-70,18\np=30,77 v=15,78\np=87,13 v=-86,-68\np=30,35 v=-44,-39\np=18,80 v=-54,61\np=93,49 v=89,-69\np=33,24 v=86,12\np=48,62 v=-53,8\np=55,95 v=-23,41\np=53,58 v=38,-77\np=4,11 v=2,19\np=20,34 v=-14,42\np=38,82 v=22,61\np=3,100 v=96,-59\np=90,21 v=36,46\np=60,46 v=-65,-5\np=64,83 v=18,74\np=54,22 v=-1,34\np=1,50 v=-3,-21\np=30,64 v=-46,-12\np=71,95 v=5,-11\np=36,31 v=-60,-77\np=75,68 v=-53,-81\np=36,35 v=-22,-37\np=85,68 v=-11,-94\np=42,48 v=-88,61\np=50,96 v=-1,-84\np=58,28 v=99,16\np=39,39 v=-30,94\np=44,90 v=-16,92\np=35,95 v=-53,40\np=28,85 v=32,-37\np=82,57 v=-81,-4\np=62,68 v=36,60\np=78,83 v=49,-99\np=42,86 v=84,-11\np=6,2 v=79,49\np=16,67 v=-76,90\np=40,77 v=31,-33\np=12,48 v=-4,-51\np=55,26 v=-39,98\np=17,83 v=14,70\np=46,57 v=-86,-47\np=55,51 v=92,-22\np=49,89 v=-86,27\np=10,8 v=57,6\np=91,79 v=11,-25\np=67,102 v=91,6\np=75,41 v=52,-78\np=22,89 v=9,6\np=47,88 v=7,19\np=72,93 v=-52,-52\np=30,16 v=79,-62\np=80,25 v=-72,50\np=30,54 v=-38,86\np=69,14 v=-89,-83\np=61,99 v=38,64\np=98,74 v=89,-50\np=88,17 v=96,-44\np=36,80 v=68,-36\np=4,37 v=-5,63\np=35,22 v=86,-70\np=92,74 v=-70,-39\np=63,59 v=52,-31\np=85,99 v=-2,15\np=75,64 v=-18,69\np=89,42 v=-47,25\np=19,90 v=19,13\np=4,9 v=17,20\np=69,87 v=68,70\np=11,14 v=48,-1\np=61,97 v=-56,62\np=53,51 v=-78,76\np=42,95 v=-10,6\np=55,17 v=-71,7\np=27,15 v=-78,58\np=22,25 v=-37,-23\np=6,48 v=-99,8\np=3,5 v=-75,-84\np=30,99 v=15,40\np=96,53 v=-67,17\np=20,36 v=-61,-82\np=53,13 v=69,-6\np=86,8 v=20,-62\np=37,49 v=-7,-91\np=46,86 v=7,-68\np=33,71 v=8,-25\np=83,50 v=4,-13\np=57,89 v=-76,20\np=46,27 v=-63,-27\np=32,18 v=-45,-87\np=92,57 v=-13,-55\np=45,19 v=23,-17\np=5,15 v=-53,-14\np=7,39 v=81,-80\np=90,51 v=42,64\np=20,4 v=-45,23\np=76,29 v=51,-47\np=75,83 v=59,-42\np=6,65 v=57,-51\np=51,73 v=85,-81\np=86,66 v=92,66\np=74,95 v=90,49\np=24,102 v=82,54\np=62,33 v=80,6\np=69,60 v=-34,-30\np=22,84 v=-61,18\np=89,45 v=50,81\np=2,3 v=34,78\np=34,44 v=96,-34\np=82,11 v=-81,84\np=69,57 v=83,-34\np=37,44 v=47,77\np=48,75 v=-71,48\np=62,30 v=-56,55\np=0,61 v=-36,35\np=2,36 v=-59,59\np=83,80 v=50,9\np=2,15 v=-45,-96\np=87,92 v=-27,40\np=23,38 v=1,64\np=18,14 v=82,19\np=32,30 v=64,29\np=25,61 v=-7,-90\np=45,16 v=66,82\np=78,62 v=-42,-13\np=61,4 v=58,-45\np=33,49 v=-49,-2\np=58,96 v=75,71\np=7,69 v=16,88\np=98,53 v=26,-99\np=13,63 v=49,73\np=66,64 v=44,-4\np=56,24 v=-32,33\np=31,56 v=67,85\np=59,86 v=-41,74\np=43,74 v=52,4\np=56,84 v=-72,-21\np=22,67 v=70,35\np=44,65 v=-24,-17\np=34,55 v=35,38\np=100,101 v=26,49\np=22,17 v=74,70\np=82,23 v=21,-65\np=5,40 v=9,-6\np=11,22 v=-95,37\np=8,9 v=80,-36\np=3,40 v=5,-30\np=60,83 v=76,87\np=72,5 v=-34,-88\np=3,13 v=-44,97\np=50,62 v=-71,-60\np=17,5 v=-53,58\np=44,0 v=-47,35\np=69,18 v=92,-32\np=20,98 v=88,41\np=59,1 v=-25,-92\np=97,22 v=49,13\np=14,81 v=-6,82\np=76,97 v=-80,-89\np=63,21 v=-94,12\np=1,67 v=47,56\np=10,52 v=-77,-50\np=36,89 v=-86,-89\np=65,11 v=29,-28\np=95,93 v=-12,-84\np=50,95 v=-71,75\np=25,22 v=55,50\np=26,28 v=55,89\np=90,36 v=-74,89\np=8,19 v=50,88\np=44,48 v=-23,8\np=100,70 v=49,39\np=51,7 v=22,-19\np=56,51 v=92,34\np=64,93 v=-18,-47\np=42,40 v=38,-18\np=3,22 v=-14,7\np=21,62 v=-34,-87\np=44,81 v=-48,69\np=54,86 v=76,2\np=94,0 v=-80,88\np=64,64 v=76,43\np=0,10 v=-5,-88\np=100,7 v=64,-28\np=40,79 v=-8,-33\np=35,41 v=-54,21\np=64,43 v=38,96\np=21,14 v=18,-23\np=50,88 v=22,23\np=63,94 v=76,-97\np=72,36 v=84,17\np=71,29 v=-70,-8\np=57,63 v=23,17\np=33,58 v=-22,-24\np=75,16 v=-18,50\np=80,49 v=29,77\np=40,63 v=85,-99\np=38,88 v=8,-58\np=29,70 v=-37,52\np=80,60 v=20,-51\np=40,86 v=-86,-68\np=2,69 v=-36,-34\np=4,38 v=93,51\np=12,28 v=27,-94\np=36,70 v=92,95\np=94,90 v=59,-59\np=60,16 v=-41,-28\np=75,89 v=28,48\np=1,27 v=4,-40\np=45,9 v=45,51\np=34,10 v=17,84\np=84,58 v=-20,-16\np=22,92 v=49,36\np=6,51 v=-43,-65\np=100,41 v=-28,47\np=52,87 v=-85,55\np=44,38 v=98,4\np=44,41 v=15,51\np=47,92 v=76,28\np=10,69 v=-37,48\np=50,64 v=23,86\np=22,92 v=6,-51\np=32,17 v=-77,-57\np=59,97 v=-1,53\np=88,24 v=-26,-83\np=25,86 v=32,2\np=88,79 v=46,98\np=58,41 v=61,-78\np=82,45 v=-90,55\np=6,78 v=88,65\np=62,82 v=-77,-61\np=94,65 v=-76,-76\np=90,12 v=3,59\np=53,8 v=22,71\np=66,102 v=-2,-24\np=86,9 v=13,84\np=32,102 v=62,36\np=74,50 v=36,30\np=75,7 v=5,-79\np=77,0 v=58,83\np=2,62 v=18,-90\np=12,80 v=48,31\np=67,22 v=-64,37\np=7,52 v=49,49\np=46,12 v=-79,-11\np=53,49 v=38,-91\np=43,82 v=-55,-46\np=43,42 v=89,35\np=20,17 v=33,45\np=30,48 v=-7,64\np=72,19 v=4,50\np=64,62 v=-2,30\np=36,93 v=8,23\np=41,46 v=-62,-56\np=15,52 v=5,-17\np=61,8 v=-89,10\np=7,93 v=80,-93\np=65,97 v=-95,19\np=30,92 v=68,-66\np=72,97 v=67,23\np=74,102 v=-42,-24\np=38,0 v=85,2\np=21,12 v=71,-2\np=64,85 v=55,-83\np=71,70 v=-10,39\np=30,72 v=15,75\np=66,85 v=-2,-76\np=98,78 v=-12,69\np=8,102 v=87,36\np=100,7 v=-58,-23\np=35,1 v=-85,88\np=31,100 v=-42,-2\np=39,0 v=71,83\np=4,22 v=-20,-90\np=68,53 v=-31,8\np=26,21 v=17,-36\np=75,100 v=-34,-84\np=21,50 v=-4,10\np=55,26 v=64,74\np=96,11 v=78,56\np=61,55 v=-25,38\np=14,75 v=-76,78\np=27,41 v=-56,-99\np=44,79 v=77,-76\np=65,96 v=-2,66\np=97,51 v=65,-9\np=98,41 v=-98,81\np=52,5 v=-31,-88\np=83,6 v=-59,-70\np=53,75 v=-17,-12\np=81,97 v=81,-89\np=40,2 v=34,-66\np=86,42 v=74,47\np=16,12 v=-28,-44\np=44,40 v=-6,74\np=100,11 v=-44,97\np=66,95 v=98,74\np=59,2 v=-87,24\np=89,36 v=-93,-90\np=30,62 v=-46,-34\np=19,39 v=-99,-46\np=15,95 v=-63,-17\np=54,25 v=-56,76\np=13,98 v=-78,-11\np=28,100 v=86,19\np=83,45 v=51,-13\np=91,53 v=-35,-69\np=32,1 v=-98,-48\np=66,83 v=66,94\np=3,12 v=-72,-66\np=87,13 v=58,-75\np=0,35 v=-83,-1\np=31,74 v=86,53\np=40,66 v=93,-21\np=59,52 v=-71,95\np=19,70 v=79,-55\np=65,85 v=-93,-74\np=98,68 v=74,-50\np=79,50 v=-82,-5\np=25,45 v=-87,40\np=4,97 v=-52,-88\np=47,28 v=63,-11\np=5,41 v=57,55\np=56,84 v=-87,74\np=77,15 v=51,84\np=2,45 v=-45,-99\np=31,38 v=78,68\np=88,57 v=59,48\np=39,22 v=-70,16\np=79,4 v=-81,84\np=28,66 v=10,39\np=10,28 v=-53,-79\np=22,20 v=87,50\np=35,67 v=43,-25\np=32,59 v=-38,-17\np=83,2 v=-80,79\np=47,47 v=-75,5\np=17,59 v=74,-49\np=6,50 v=73,-61\np=76,62 v=-89,1\np=33,14 v=47,-23\np=18,54 v=17,34\np=19,72 v=-42,-22\np=89,58 v=-97,86\np=87,73 v=-74,-20\np=98,30 v=-90,-1\np=53,72 v=-1,-93\np=0,23 v=10,-96\np=39,0 v=59,34\np=90,68 v=-69,31\np=10,29 v=97,52\np=98,30 v=-66,34\np=58,98 v=84,40\np=82,33 v=59,72\np=64,79 v=21,14\np=26,30 v=72,59\np=68,83 v=-43,58\np=27,59 v=-15,-13\np=86,96 v=-66,62\np=49,100 v=38,28\np=49,57 v=-24,47\np=60,101 v=-25,35\np=1,97 v=-59,36\np=20,101 v=19,-7\np=31,87 v=24,36\np=84,77 v=-28,-46\np=10,3 v=-5,75\np=77,52 v=37,-81\np=24,0 v=92,-61\np=89,43 v=97,-95\np=48,9 v=-40,71\np=0,45 v=95,-73\np=8,40 v=-13,42\np=94,7 v=59,-6\np=93,33 v=3,72\np=0,68 v=-45,-65\np=76,41 v=-11,-71\np=86,85 v=-96,32\np=76,41 v=9,55\np=67,79 v=58,20\np=55,56 v=82,37\np=54,45 v=-56,64\np=4,24 v=-44,16\np=47,52 v=-94,64\np=49,71 v=55,-7\np=65,28 v=-2,-74\np=66,56 v=29,-26\np=81,9 v=-65,-57\np=26,15 v=-92,67\np=62,95 v=4,61\np=46,0 v=67,-91\np=20,11 v=-53,-32\np=89,65 v=-27,69\np=94,27 v=53,93\np=33,2 v=-30,-84\np=73,102 v=83,80\np=32,80 v=-70,-94\np=56,81 v=63,-72\np=44,57 v=-56,-94\np=92,62 v=-51,1\np=77,71 v=-18,-51\np=25,48 v=41,12\np=74,16 v=-42,-61\np=69,10 v=20,-52\np=100,33 v=18,-1\np=45,46 v=55,-1\np=1,58 v=21,-74\np=69,61 v=68,86\np=25,102 v=1,79\np=17,28 v=25,-27\np=43,10 v=-30,-79\np=10,91 v=-54,13\np=41,75 v=39,-38\np=68,88 v=-49,96\np=83,38 v=98,-61\np=0,64 v=-19,32\np=100,36 v=81,-82\np=21,98 v=71,-50\np=98,41 v=-91,13\np=33,31 v=3,30\np=53,89 v=-40,40\np=86,26 v=-19,-83\np=31,32 v=86,12\np=97,99 v=-50,-15\np=73,44 v=-65,98\np=4,85 v=96,-80\np=7,15 v=-91,-27\np=100,7 v=64,7\np=50,25 v=84,-22\np=27,1 v=-8,-93\np=93,38 v=69,-37\np=32,65 v=17,-89\np=61,86 v=22,-93\np=27,48 v=71,-13\np=60,22 v=-29,-61\np=42,53 v=-70,77\np=47,60 v=38,-42\np=38,61 v=32,-39\np=58,72 v=-9,95\np=53,85 v=22,-63\np=71,94 v=83,-54\np=67,18 v=-80,-79\np=58,53 v=53,-56\np=19,33 v=9,82\np=90,40 v=4,4\np=95,101 v=11,-11\np=46,21 v=-36,46\np=81,43 v=-31,14\np=38,83 v=-80,13\np=20,45 v=-68,-5\np=35,70 v=-53,70\np=91,35 v=65,90\np=99,76 v=-59,-7\np=87,39 v=-66,55\np=64,58 v=59,73\np=46,100 v=93,49\np=19,36 v=33,-61\np=39,101 v=-62,6\np=50,17 v=-68,36\np=35,78 v=-17,99\np=23,3 v=29,53\np=49,43 v=-61,-79\np=97,65 v=-74,86\np=47,14 v=-64,67\np=43,84 v=47,33\np=30,87 v=-92,-28\np=4,81 v=-72,65\np=93,86 v=97,87\np=41,64 v=70,-81\np=6,13 v=3,-19\np=19,29 v=80,-6\np=39,49 v=27,70\np=15,32 v=66,48\np=62,40 v=-25,-9\np=90,29 v=-4,76\np=55,4 v=-1,93\np=50,85 v=35,88\np=5,84 v=48,87\np=58,9 v=92,-15\n"

#Day14.part1(input) |> IO.inspect(label: :day14_part1, charlists: :as_lists)
#Day14.part2(input) |> IO.inspect(label: :day14_part2, charlists: :as_lists)
```

```elixir
defmodule Day15 do
  import AOC, only: [s2map: 1, add2: 2]

  def print(m) do
    for {_, r} <- Enum.group_by(Enum.sort(m), &elem(elem(&1, 0), 0), &elem(&1, 1)), do: IO.puts r
  end

  def sim([], _, m), do: m
  def sim([c | rest], p, m) do
    #IO.inspect([c]) && print(m)
    {i, j} = q = add2 p, %{?< => {0, -1}, ?> => {0, 1}, ?^ => {-1, 0}, ?v => {1, 0}}[c]
    case m[q] do
      ?. -> %{m | q => m[p], p => ?.}
      ?# -> m
      v ->
        qs = [q | c in ~c"^v" && %{?[ => [{i, j + 1}], ?] => [{i, j - 1}]}[v] || []]
        m2 = for q <- qs, reduce: m, do: (acc -> sim [c], q, acc)
        Enum.all?(qs, &m2[&1] == ?.) && %{m2 | q => m2[p], p => ?.} || m
    end |> then(&sim rest, &1[p] != ?. && p || q, &1)
  end

  def part1(s) do
    Enum.sum for [s1, s2] <- [String.split(s, "\n\n")], m <- [s2map(s1)],
      cs <- [String.to_charlist String.replace(s2, "\n", "")],
      p <- [Enum.find_value(m, &elem(&1, 1) == ?@ && elem(&1, 0))],
      {{i, j}, v} <- sim(cs, p, m), v == ?O or v == ?[, do: 100 * i + j
  end

  def part2(s) do
    part1 Regex.replace(~r/[#.O@]/, s, &%{"#" => "##", "." => "..", "O" => "[]", "@" => "@."}[&1])
  end
end

input = "##################################################\n#......O.O..O......O......O..OO...O..O.O.O..O..O.#\n#....O.O..#.O....O#.#.#......O.O#O.O#O#..O.O.....#\n#.........O..#O......O...OO..O..O..O#....O.......#\n#.O.O......O#.#..#.#.........O...OOO.O..O..O....O#\n#..O......O.......O..O.#O......OO.O.O#..O.OO..O..#\n#O.O.....O.O......O....O..OO...#.#...O##OO#O.....#\n#O..O....OOOO...#.O.O.O#.....##.....O#.##..O.....#\n#O..O.O....O.#..O.O.OO#O.#..#.O....O..O.#.....O..#\n##..OOOO..O..#O.#.O....O...............OO.....O..#\n#O.O#.........OO..O..#..O.....O..O...O#.....O....#\n#..#O#O#...#....O...OOOO..O.....#O.......O.......#\n#..........O...O.....#OOOO#O..#..O..#O.........O.#\n##..O.OO.O......#...#OOO.OO..O.O.O.OO#.#OO..O.OO.#\n#....O.O..OO.O.OOO..OO...O...O..O.O.O....O...O...#\n#O..#OO.........O#......OOO....O.....O.OO.#.O.##.#\n#.O.OOO.....O....O...#O.O.O.#.O.O..........O...OO#\n#.OO.OO...O...O..#........O.O...O.O...#OO.O....O.#\n#OO...O.OO.#O.....OOO.#O#.O.#......OO.....OO#..O.#\n#..O......O.....#...#O.....O.....OOO.....O.#OO...#\n#.....#O..O..#...OOO.#O.O..O.O#...#OO.O......O..##\n#..OO.OOO#.O.....OO..#.OO......OO.O....O...O.....#\n#.O.OO..............#..O.....O.O...OO.....#.O#...#\n#......OO.....OOO.O..O#OO...OO..O#..O..O.OO......#\n#.#O....O....O..#O..O..O@..#..#...#......O.......#\n#.#..O.O.OO...O.O#....O..#..O...OOOOO...#.OOO#...#\n##O..O.O....#O....OO#O.#O......O.....O..O...#O...#\n#...O...........O.#O..O.#...#.O.O.O...........#.##\n#O#O.......O..O.....OO.#O.O.#OOOO#.O.O.O.O.......#\n##O.O..OO...#.O..#.O.O..OOO.O.O#.....O.O..#.O.O.O#\n#..OO...O..#O.O.#.OOO.....OO........#..OO.#...O.##\n#O.#.#..#.O.O...O..O.#O..O.O.OO......O.OO.O...O.##\n#.O.OO...OO.........#....O.OO.OO..O#O.#O........##\n#.......O.......OO#...#....#.OOO#.#........#.O...#\n#...O.O.#.O.O.........OOO.O.O...O....O....#...O#.#\n#....O.O.......#.......#..O##.O.O.....O...O.O...O#\n#.O.O.O..O#.O.O...##O#O...O.....#OO#O.O....O..O..#\n#O.O.O.#..O...O.O.......#.OO..#..........O...O.O.#\n#...O...O.....O....##......#..OO....##.O..OO.....#\n#..OO..O..O..OOO.....#O..OO.O.OOOO.#.O...O.#.....#\n#...O...O.O.O...O.#O.#.O...O#.#......O..OO..O.##O#\n#...O.O#......OO.#.O.....OO..O.......#...#.O...#.#\n##OO..#O.....OO..............#...O#..O#......OOO.#\n##OOOO..O.#..O.O....O....O..O#.O#....O....O.O....#\n#.....#......O...OOO.O........O....#O.OO.....OO.O#\n#O.#....OO#....OO.O....#O#........#.#.OO.#.O...OO#\n#.O.....O.OO.....OO...#O..OOO.O...OO....O.O##O...#\n##O..OO.OO..#..O.O.O.##O......O..#....OOO....OO..#\n#O..O....O.........OO#.#......OO...##.O.......O..#\n##################################################\n\n>v><^>^v^v^^v><><>^><>>v<><<^<><>>v<^><^>><<<^v<>v>^<v>>><<<<^^<<^v>vv><>>v^<^>^^^^>v<<^<<>v<^^>v^v>>^v^v<<vv>^v^>v^v^^^>>vv<<><^^v<v^v<<<v^<v><<^>>^v<>vv^v<v<vv><<^^vvv<<^^v>^vv>v<v>>v>^v<^<^>^>><>><^>><>^>>v<vv<v^^<>^vv><v^<><>^vv^<<^>><<<>v^>^vv<v<^^^^^^<><v<<^vv^><>^<vv^<>v<>v<v<^<><<>^<v>v><<>^<<<^>vv<<^v^<<v>v<<v^v<v>v>v^<>^v<<v^><^>v^<>vv<v^^>>>>^v<v^><<vv^><v<>v^<^>^>v>>>>^^<<^<<<^^>>^><<v^>>^^^vv>^<<vvv<>v^<v^vv>vvv^<^>v>^<>>vv^^^><v>v<<vv<^<^vv>>>^v>>^>>^^^v<>^vv<<^<>vv>^<vv^>^<>v<^<<^>><>v><>vv<^v^>^v>>><<>^^<<<^><<^^^^>vv^^v^><<v^^v^v>v>^<^^<>v^><v^>^<>^<>>^<><^^<>><>^^^^v^v<<><^><^^v>v>>>>^^^>^^>^>vvv<>^>>v><vv<>^v>>^>^^v^v>^>^v^^>^<<<>v>vv<<<>><^><>><v^<><>>><>>>>>^<v><<>><>^><v><<>>^><^v><v>^<v>>v<vv>>>>vv^^^v^v<<<vv>^>vv^v^^^v><v^<>v<^^<^^>^<v^^<<>>v<^v^<v>^>^<<^<>^>v^^<vv<>^><>>vv^>v<vv><>>^v<<>^^>vvv>v^v<>^<^v^>>v>v^^<^>v>^^^<><>^^v^^>vv>^>v>^v<><<><<><>v>v><^>v^<>v<><^><><<>>>>^v^>><^><<>><>><vv^v>vv^^<<>>>>^v<^vv>>v>v<>^>^v^^<>>^>>v>v>^^><^<^^<^^><v^^<v<<^^<^<>^^v<<\nv<<<v><>vv^v<>vv<>>>><v^^v>^<<><^<^v<>>^^<^^<>>>><^v<^>^^^v^^<>>v>^>>vvvv^<>>>^<><<><><>^^<<><v<>v<<>^v<^v>>^<^v<v<v>>^^<<vv<><<^^^>v<<v><^^<><<<v<^vv^>>v<vv><vv>>v>><^v>>v<>>v<vv<v>>^<^^<>>^<v^>^><^>v><^<<^<^^<<>^<<v^^v^<^<v^><<<v>>^v><<v^^^vv<>>^^^v^>^^^^^>><><<<<^^^^<v^v><<<<v^>>^v>v^>>^>>^<v^<v><>^<<^v<^<>^^><v<>><<<^><vv^>^><vv<^>v<<<^<<<>v<^>>v^>v>>^<^^^v^>>v^<v<><>>^>>v^vv<v^v>><<<v<^^<vv>vvv>>>v^v<<>^^v>^>^<>vv^^<^<<>>^^>^v^>v^v^v><><^v<>>vvv<^>^>v^^<^>^^>v^^^v^v^><>v<><^^<>>^vv^>^^^<^<v<<>^<>vv<><^<>>^>^^>^>vv><v^>v>vv>^v^^v>v>^>^^^^^<<<v>vv>>^vv^v<<><^vv>>>><v<>^vv^<>^>^vv<vv>v^^v><v>v<<v<^^vvv>>^^v<<v>>v><>^v>^v<>^<v>>v<<<^<^<<v^v<><>v^<<>v>>^vv>v^vv<vv^^<><^^^^<^^>v><^<>>v>v>><<<v<<^^^<<>v>>><v<v^vv<v<v<<<^<>^^>^><v><^v><<vv>^^v^v<v>>v^>v>v<<^<^<><vv<<<^<<^^^<>>v<^^v^<<>^>^v<vv<<>>v>>v^v<^vv^>v^v<v>>>^v>>^<<^^<v^v^^<^>^^^v<v>^<^v<><vv^^v<<v>>v>v^>v^^<<<<^^<>^vvv<v<vvv^v><v<>^>^<^v><<^v<^<^>^v>^<<<<^>v^v^<vv<>>v<v^v^<v>>^<v^v^^v^>v<<<^>v<^<v<>>vvvv<<^v<>^^^>v<^vvvvv>><^^>>>^\n>>v<<^><>vv^v>vv<<><>><<vv<^<^^v^<<<>v^^v<^<^><v^><<>vv^>^vvv<^<v<v<>>^<><<<^v^><v>^v<v^^>><v<<>v<<<<>v<>^>v<v<<<v>>^>>><^vvv<^<>>^<^<vv<vvv^^<^^v<^<v>^>vv>v<<<>^>>v>>><^<^<^<<>>^v<>>>v>>^<^v>v>v^^><><^<<>v<>vv>^<<<^>><>v^^v<^vv^^vv<>v><^^v^<^<<^vv<<v>>v><<<v<vvv>^^>^<<>^^^^^v<^>^>^^^^^<^>v^<^^^v^^vv^v^<vvvv<vv<vvv^<vvv^v<>^^^<>v^<>>^<vv>>vvvv^<v^><^^>v^^>v^^<v>>>v>^^^<v^<v^^>>^^v^<^>^vv<>><><<<<>>><<<><v^>^<>^<>>>>v><vv><<<v<<^>>^^>><<^^v>>^>v>v^^<<>^<v>^vv^^<>vvv>v<^v^<^^^v><vv<>^<<<>^v^>^^>>v^vv<vv>vv>vv>v<>>v<<^^v>^<^v><^v<<<>^^v^<<^^>^><>^>^^<^>v^vv<<^><>vvv<^<^<<<vv^v>v^><<v><v>>^v^><>^>vv><<>^<^>>^<<<<<^v<v<^^v^^^v>vv>^v^<<>v>vv^>^><vv^v^><v^>><>^vvv>>^<^>^>^><<>>vvvvvvv>^v^<<<v<^v<v^v^><<^v>v^<v<<v><v<<<<><^^v><<<<><v<><^<^>^v^>v<>>v<^>^^>v>>^>>^<^^^>^^>>><vv^<>^<>>><^<>^>>v>>vv>v<vv^>v<><<^>v<><>^<><v<<>^><>^>>^vv>v<v>^><v>v>>^v<<>^>v>>^><><^<><<<>v^<^^^v^^>v<><<vv^<^^>v^v>>>>>v<<>>^>v<>vv>v>>v>>v<v>^<^><v^><>v><^^<<<^<<^v<^v^^^<<v^>>^<v>^^v>v^>>>>v>^v<^<<<v><<>v^<<>v<>vvvv>v^\n><v^^^<vv^<v><><^^vv>vv><v^>>^v^>^v<^^^<v><>vv>^v>^vvvv>v^>v<v<v<v<>vv^^v^v^v<v>^v>^><^>v^^<>><^vvv<v^^>>v<<^^<>><<v^v<<<<<^<<<>^^^>v^v^>>^<>vvv>^<>><<<v>v^v^v>^^<^v^>>>^^>>><>^>^vv><<^^^>vvv^^>>^^<<^v<<v>>vv^^<vvv<vv<<<<>>><<v^v>^><>^^>v^^><^^<v<<^^<^^^^v^<<>>><v<vvv<<>^v>>v>v<v^v<vv<><>^><v<v^<^^>v^<v<^>>vv^v^>^>>>^>>^<vvvv<<v>^v<<vvv>^v<<vvv<<<<>vv>v>>^><>^^>^^>v<^<v<>v>>v<>v<<vvv<>><><^>^vv><v^v>>>^^<^^><<><<v^^^>><><<>>v<v<^>>>>>>>^<>^<^<<v^v^^vvv^v>v>^v<^<<>><v<v^>vv^<v<>><<^<><v^^vvv<<vv>><<^v<>v<^^>>>v^vv>>>><<<^v>^^vv^<>^>^^^><>v^<>v^>v<v^v>>>^<v^^v^>^>^^^v<v^<><>>v^^>>>v<vv<v>v>>v^v>^vv<v^<>><><<v<v^>>v^>^>>^<><>v>>^<<<>>vv<>>>vv<v<<v^v>v<<<^<^^>v>^v>v<<^vv<^^v<><v^>^v<<v<^v^>>^<>v>v>><v<>vv>^^v>^^v<><<<^>>^<v>><^>^^^<^<<v<^^<><vv^<>v>^v<<<^<v<vv>>>v<<<v^<><^<><^<v^vv<v>v<>^><^^v><^v><>>^>v<<>>^>^v<>>^v>>v>v<<^<<>><<vv<>><<>>^>^<<><<><vv>^vv>^>v<^>v^^>v>>>>v<^>v>^v>>>v>vvvvvv<v^<v<^<^><vvv><>>><v>v<<<^^^^><^v>>vv>>^v>v<^>^^>v<><<^vv^vv>v^<v>v>v<v><v<^<v>^v><><<>^^>>vv<v>><<>>\n^v><>v^^<^>>>vv^>^^>^v>^^<v<v<>^<<^>^>vvv>><^v<^^><>^v>>^^>v<<^>><<>^<v>^><<>vv<^>>^<>v<vv^v>^>vvvv>v<>^<<^^<v<vv<^^v^v^^^<>^<^<v<>>v<>>^<<v<^vv^>^v^^>>^^^^<<^vvv<><<^>>><v<<v>^<^<>^<v^><<v^^^vv<<v^<vv>v<<><^^>>><^><<^^v><<^^>><>>^vv<v^v>^v<>v^v^<<<v^>^><<<^v>^>^^>^^>^vv<^vv^>><^^^<<<<v<v>^v^vv^<>><>^<vv<^^<v^^v^^<>v^v^^vvv^>>^^>vv>>><><<<<^v>>>^v<v<v<vvv<v^><<>>>>>><^^<^<^<v<v<vv^<v><v^^><v<^<<^^>>>>^^<><<^><><vv<^>v^v<<><<v>><><v><v><^><v<vvv>^v^^^^^<v<<>^<<^<^<>^><v<v>v><><vv>v^<v>><>v^^<>^^<v>^<^v<>>^^v^<v^<v>v^^^v<<<v^v^>v>v>v><v<<><v^<<<<<<vv>>^v^>^<v>>^^<v>>^<^<><>v><v>v>^<<v<v<v^<>><>>^^^<^v^<v<><v<v<^v<^vv>v>>^vv^><v<>^^>v^^>^>vvv<^v>^^>^<><>^<>v<<>><^<<<^v>^v^<vvv<><>>v^>^v<<<>v<><>><<vv^<>^<<<^^v>>^>v^<v^><^^vv>v<<>v^>vv^<><<^>v><>>^><^^^<v>>^>>v<^><<vvv^^<^>^^<v>vvv<<^v><v^^><^<<>v>v><<v^<>^<^v>>^^<<<>^>v>v^^^^<^<<<>vv<^vvv^^v<v>^><<<><^>vv^><v^>>>v<<>v>vv^^^><^<vv>>^><>^^>>v<v<>v<>>^>^>^<<v<<>v<v<^^v^<<v<><^v^^>>v^^><v><>^<^>>v><^<<<v>>^vv^<>>>^^><v^><<><v^<>>^vv^v^>^^v<^>\n^^^v^>vv^<<>^<^>>>^<<^vvv^>>>>><vv<>^<><vvvvv>v>v<<>^v<^v<v<v>^<v<<^><<^<^vv<<^v<>v<^<v>>>^v>><v<^^>v><^<v>^><<v<v<<<<^^>vvvvv^v>^^vv<<>^^v>v>vv><<<^^^^>^>vv>>v>>^vv<^<<><>v><v^^v<v^^>v><>^<>v^>vv<v^>v^>v>>v<v^>>vvv>v<><^vv<<vv>^>^<v^v^>v^><^<^>^<v^vvv>v<<^^>>v^>vvvvv<^^^><v^^>^<<v<v^>v<<<^^<<>v>v<<>^<^<v><v^<<^>><>^v<<^v<>^<<v>v>^<<>v<v^vv^>^>^^<v<<^<^^<<<v^>^>^v<^vv>v<<^v<>v<^vv<^^>>><^^^^<>><<^v<^<^<>>v<v<v<<>^^v^v^^v^<^^^>vv>>>^vvv<^>>^v><>v<^^v<><>v^^><^<^v<<>>^^<>^>^>v>><<v><><<<v<>v<v<>vv^vv^v<<<^^v^vv>^>^<^<>^>v>>><v<^^<v<<<^<<v>^<<^^v<^<<^^>vv<^^^^>>^^>^v><><^v<v^^^v<><>>v<<>^>^^v<^v^^>^<v^v<<<>^>>>v>^<<vv^><>^^><<^<>^>^^><<^<>^>^v>^^<^<>>^^v^v>v^>v^<^v^>v>v^^<^><v<vv^>^^>><<^v>^<<^^<^^<<^^>vv^>>^^v<>><<v^v<<<>^<>><^v^^^<<^vvv><^>>^>^>>v>^<><^<<^v>^<vvvv<>>^^^vv<^^v^<v^>>v>^^^>^>^v^<>v>>vv<^><>v><vv<<v<^^vv>^^><<><<v<^^^>>>vv><vv^^v<>>vv>^>>>^<<<>v^v>^vv^<<>>v<>v^<<v>>v^>>v<<^>^vv<>v^v^<v<^<vv>>><<v>v>^v>^v>^><^^v>>vv<>v^^v>><>>^^<^v^>^<vv>v><>^v<^^>v^^<>v^^v^>>^^>^<<<<^^>><^^\n<^<><<v^>>^<v^^<><><<>><^v<^<^<><v>>v<^^<<>><<>><v^>vv<vv^<>v^>v^v><^v^>>>^<^^><^<>><^>v^<v<<>v>^<v>v<^>^^<v><^<^^vv^>^^v<<>><<>>v^<>vv<<>^v><^<^^v<v<<<v<v>^^<><v^v^<<v^vv<v>v>v><^v>>^>^^>vv>>^v<<^^^^>^<<>>^>>^>^v^>^v<<^<>^v<<<^>><<v^<v<^v<><<>^v^>v>^^v>^^v>>v^>><<<^<^^>><^<><^v<^v<<v<>^v^v^>>v^^^<^<v<><vv>>v^<vvvv^v^v<v^>^<vv>><>v<<v<vv^^>>^>^vv^^v>><<>^^<^^v><>v^^v^>v<^^>>^<v>^vv^^^^^^vvv<>^v<^^><<<><<<^>v^>>^vv><>v><>vv^^^v><v^v^^>>>vvv>v><<<^<^^<^>^>v^<v^^v^v><v^v<>v^vv><v><<vvvv>>v>^^vv><v^<v<>^^v>><v<^^>^^v^v^vv^v>^v>^<v<>><><>^^<^<>>>><^>^v^^<><>v>^<^><><^<<vv^^vv<>^<v>>>vv<^<<^>><<^^^^>>v<v<<^>^v<^>v<<<v<v^<<v><<<<^v<<>v<^<^<^v<><<><^v<^^v><>v^^<>>>v^^v^>>>v^vvv>vv<^^^^><<^>v>>>^<v>v<v^v<<v>v<v^^>>>v^v>^v^<v^^v<^<<^>>^<><v><<^<^><^^^>vv^<v<v<><^v<>v>>^v<>^^^vv^^<<^^<<vv>^^^>v>>v>>v^><><>>^>vv^<v<<>><>vvvv<v<<^vv<<v<>v^v^^>>v<>v<<v^><^<^v<<<v^v<<^v<v^>v<<<^v>>>v^<<<<<<>v>^^>><^>>^<^><^>^<<<v^<<<>>^<>>>>vv>v<>^^v>>^v<^^<>v^v>^<v>^<<>^v^v^v^<<<^vv^^<><vv>vv^v^<><v<v>^<>^v><^^v<<vv\nv^<v<v<<^><><<v^>v<<v^<v<>^^>>v^>^v><<v^<v><<vv>><>^v^v><<v<^><^><<<><<^<^^>v><^v<v<v><v^^v^><^><>v<^>^v<v^><<^vv>>v<<v<^v><v^v^v><>v<v><v>>>^v>v^^^><^<v^v<vvvv<v^<v<v<><^^<v<<<^v<vv>>v^<<<^^>vv^vvv<<<<vvvv<<^>^<v<^<>^>>v<<v>vvvv>v>>^>>v<>v^vvv<><^^^>^<^>v^<<^<^v<<<vvv<^vvvvvv^<>v^^>^<^<<>^<v<^>^<^<^<<^v><v>vv<v>v^><^vv><^<<>vv^<>^>^v<<>>^v^<^^<><>^v<^><v<<vv<^><<><<v^><v<>><^v^v^v<<^>^v<>>^vv>^>>v^^vv>>>v^^^>vv>^<<<<>><>>^<<>^^^<<>>v^><^^>v^>^><^v<^^><^^^v^^v^<v<<^<<<<>>>><<<^<v^^>><>^^<^v<>^^^<><>vv>>^<><>>^v>v>>v^v^^^v>><><>><>>^><v^>^v><<v>>v^v^v<v><>v<vvvv^v<><v^>v>v>>>v<<<<>><><v><<v<>v<>v^<^^v^<^<>v^><<^>vv>>v<v>>>>^<>^^v>>^^^<>^<^v^>^v^>v><vv<><^^v>><><>>v^<<vv^>^><><^<vv^>^^<>^>v^^^v<vv><^v^>^v>>v>^vv^^><v>^^>>vv<^v^>^<>>>>>><>><>v>v><<v<<v>><><<^<v^^^^<^v>v^>v<>^<>vv<>v<<><v><^>v^><^>v^><<<>^><><^<^^^v^<<>^^<vv>>><^vv>>^v>><>v<v>^^v>v<^^><^<^>v<v^^vv>^<v<v<v<v^<^><v^<><><><>>><^^vvvvv^>>^^^<<>><>>v>>v>^^<<^^v>^^^v^v>><>>^<v>>^v^v><^>v><vv^^<vv>^v>v^<^^<>>^<<><>>>>>vvv>^><<^^v\n^><v<^<v^>v>^v<^^v^<><^<vv<>v>v^>vv^<v<<<^<v<<>^>>>v>vv^v><<><<v>>>^>><^>^<><>vv^^^>^<<^^>^^v<<v<^vv><v^vv<<v>^^^v>><v<^v>^<><^>^^vv>><>v>v^>><^^^>v>>>>v^>^>^^<^<^>>>>^v>v^>^<>v<<vv><<^<v^<^v>^v>^<v>v^><^>^v^<v>vvvv^<<v><<v<<<<v<^vv<vv>^v><>^^v>>^vv<v<v>><v<>>^^^v>>v<^>^><^vvv><<<^^^v^v<>v>>^>>>v^>>>^^>vv>>v^<<><<<<<v><^^^><><<><<v>vv<>>>^><vv^<><v<<^^^v>^v^v^>vv<>>v>^><^^^<vvv>^<v<<vvv><<<<<vv<<^><<v<v>^<^^v<^>^<>>^v>vv>>vv>v><<<<<>v<<v<^<<<^v<<v<>^<<v>^v^^>v<v>>>v<^^><>>^<^v<>^><>^^><<>v<vv>v>><^>v>>v<>>v^<v^>vvv^^^vvv<>^>>^v>v^<<v><v^^<^>vv><>v<>^>^<<><vv>^<<>^^>v><>^>><^><^><<v^^><vv>vvvvv<v>^<><vvv><vv<vv^v>^<v<v>>^vv<<v<><>>>><>^><v<v>^v><<^^^^<v>v^v^<v<<><v<>>><<>><v>^^^<><^v^^^^^v<^vv>vv<<^>>>>^v<^<v<>vvv>>v>>v^v>^<^v^vv<>^v^<<^<^>^<^<^^^^<^><^>>^vv>vv>^<v><<^v^^^^^<v>v>>v^>^<v>v<<v<>v><>v^^>v^<<^^>^><v^><>^>^v>v<<<<><<<vvv<><><<>^v<<<^>>v<<>^v>^<^^>>v^>^>vv<<><<^^v^vv>^^>v^^><v<^<<<^v>><<v^><^<<<v><<<<><v>><<v<>^><^><v>>vv^^<v<^><>v^^<>^vv>^v>^^v^^^^^<>^<>>>v<v<^><<<^>>v^<<<^<\n>^^<v>^^>vvv^^<^<<>>vv<^<<<^<vv><>^^<^^^<^^vvv<^v<>>v>^><v^>^^^v<<<^v>>^v>vv<^v^v<v><^>vv<>vvv^vvv<>^<<v><>>>^>v^>><^^^^v<v<<v>vvv>v^v>vvvv><v<^v<v<<<^v><<^^^<>v>^v^v^<>v^>v<<<><^^^<v>vv>^>^v>v><<v<>^^v<vv>v<><>v<vv<vvv>>>^<<^vv<<><<v^<vvv>v<<>vv^<^>^v^>^v<v^v>v>>vv^<v<v<<<^>>vv<<^<v>^<>v^>^>^^>v>v^<v<v^^<v<v>>v^>^v><^^><<^<^^<^^<^v><v<^>^>v>>^<<><>>v>v<^<^<v<^>>^v<^^<<<>^^v<^>>^v<>><^<<^<<<<>>>>v^^^^<>^>v<v>^>>>vv^v>v<><>v><vvv^>^v>><vvv^<<v^v>^vv^<<^v>>^<v<>>^v<><^v<v>><^><<^<^>v^>^^^v>^<^>^>^^><<>^><^>^^>v<>><v<<^<>>>>>v>><>^<^^^^<>>v<><>>><^<<>v^^<<vv>^^><<>><>^<>^^^<vvv^<v^^^^^>>^^<vv<<<v<<^v^<<v^><v>^^^><>v<^>>>^>>v<><v>v>>>v<>v<><vv^^><^<>^<><vv>vv>>vvv^v<>vv>><^>v<v>v<><><v<<v<vv^<>>v>>^v><<^>><^>>^<>><><<>v^<^>v<^^v>><<><>v^v<>>vv>>><vv<v^^<v^^>v^^vv>><^vvv^vv>>vv^^><<^^<v>v<^<<<<v^<<^<vv<^v^v>v^^^v<v>v><<<^>>v>><v>>vv<>>>>>^<<>v>v^>vv^>^^>>v<<v<^<><^>v>^vv><>^vv^<^>v>>vv<<vv>vvv>v^v<^^>^v>>^<><^v<^>^vv^^vvv>v<v>>v>^>>>^^<>vv><^v<vv>^><^><<<^^>v<<<><<v>^v<vv<vvv>^^<v<>v><<^<^<\n<v><<^vv>v<<>vv<v<<v^<>>>>^^^v^<^vv^><^<><v^<><^v^>^<^^<v><v>^>^v<>^<<><<^^<v<v<>^<>>>><<>>vvv^<v>^<v>vvv^^>><v<<^^>>^<v>^>^^<v>^>^<<<>^vv>^<<<^>^v<^v<v<>v^>^<<>^^v^v<<>>><^^>v>v<^^>>^><<v^><<>v^>^vv^>^>>>^<v<<^>><^vv<><^^<<>>v<><<v>vv>^v>v<vv>><<>><^<^<^^v<<^v<^>^><v^>v>>^><^^^^v<><v<^v<<><^>v<^vv<<>v>>>>^^<^^><>v^^<<^>^^^^>^>>><v<>v^>v^<>v^v^vv<<>v^<<><^<^<^>>>^<v^v>^v^>>>^^>^v><>vv<vv^<<v<vv><<<^v<vvv^<^^^vv<<v<v<>v^^v<>vv>v>v<>><^v>>v^<>v>>vv<^<>v^^<<^<>^<><<>vv>^>v>>^<<>v>v^v<>^>vv^<<vv<<^>>^vv^v<vvvv^v>^vvv<<v>><>^^v^<<^<v^v>v^<>^<>>vv>>>^^>><>v<^v^v^^<^>^>^v>>><<^^v><v>^v<v^>v>^vv<>^<<v<<<^vv^<^v<vvv>v^>><^><^^<v<>^v<v><vvv>vv<^>v^>>^v<<<^>>>v<^vv<^<v^>>><v^^v^<<v<^v>vv>v>v^^>^<<^><><v<>>v<v<^<>>^v<^^<>>^>^<v<v<^vvv^^<<v<^^^<v<>>>^^^<v<>v>^^v><<^<>><<>>vv>v<>^^><<^v>><<vv><v>^^>v<>>^v>vvv>>v<^<v>v^v^vvv^^vv<^>>v>^v^<<<v<>v<>^^vv^<<^^><<v>^v<^v<^>vv<vv>^<>v^>^v<<^<^>v<^<^v^><<>vvv><v><vv><v><v^v<^><>^^<v<<><v<<>^<>^<<^v^^>v<v>><^vvv^>>vvv^^^>>>^<<vv^><vvv><<^<>vv>vv>v<>>vvv<><><<\n^<><v^<vv^vv^vv^<v>^vv<>vvv<^<vv<<><^<vv^<<><>v^v^^vv^v>>v^v><<^^>v<><<^<>vv^<<^vvv>v^<^>^<^>^^><^vv>v^>v<>^vv^<^><v^^v<^^>v<>>v<^^><<>>><vv>v^^^v<<>v<<<v^v^^>v><<vvv>^<<^<<^>^v<v><v^v<>v^^v^v<><<<^<<^vv^v^<<<^vv>^<^<vv<v><<v<vv>v<<<v>>><v^<><^>v>^^^v<<<>>><^>v<v<<<^<<^^^>^^^<v>>>v^^<^v^^><>^<v^>v>v<^vvv^><>><^^^v><^<v>><>>v<^v^^<>>vv<<<>>>^^^^>>^^^>v>^><<>v>v<><^v^vvvvv><>vvv>^v><v>v>vvv>>vv<^<v>v>v^^v^>>^<<vvvv<vvv>>v<^<<<>v<><>^^v^<v<v<>>v<<<>>^v>^^<^>>v<^v^>v>^>>^vv><v>vvv<^>^^vv^^<>vv<><<v>^vv^>v><>v>^>v^<v<<v^<^v^v^vv^>^v>^v<^vv<>v^><^^><<^>^vv<vv><>vv<<<<<^vvv>^>^<vv^<><^v>vv><^>vvv>vvv>^vv^<^<><^^^<<<<vv>^<<<<<v^>>^<^<>>^<>>>v<<^^>vvv^^<<<><<<><>v^vv^<<vv^>>v><><<^<<^^<<^^>><v^>^v^vv<>>vvv^vvv<^<v><v>>v<<>>^v><v^v<><>><>v>^^>>>><<<>v<<>v^v>vv>><v<>^^^<>^^v<<^>>v<vv><v<v^v<^<>>vv>v<v<v<><>>v^v>^<^^^v<v^<vv<>^v>^>>>^^^<^>vv^>^^<>><^<>><>^><<^^^v<^^<<v<>^^<v^v<v<>^v<v<v>v^<<^>^<v>^><v^vv<<v>v><v<v>^<v<<^^^^v<^<^<vv<><v<><<vv><^^^<<>>vvv><^>>v<>vvv<v>v><<v^^^>^>^<<<v^>><v^>^<^^<v^>\nvv^<^^v>^<<^v>vvv<v<v^v^><<<v>^>^vvv>v>>>^<>^vvvvvvvv^<<>^>><v^^>v><v<>v^v><>>>>v><vv>^v<><vvv^vv^><>vv><<>>>v<v<<>vv>^v^>>^vv>vv^><^<><v^^v<v>v>^^>v>>>>v>v>^v^<>v>>v^><>>^<<>v><^^v>^^^vv^<^>^>>v^<^v>^v><>^<^^^^<>vv^^v^^^>^^><vv^^vv>^vv^<>>^<<>^v<v<<^vv<<>^^<^><>v<>^^v^^>vv<<v<>^<v>^<^^<>^><vv<><<>vv^^v^><>vv<<^^>>v>vv>^vv<v<<v<v>>^<^^<v^<^>^><>v>v>v>>>^v<>^^<^>v<v>>^v>>^v>>^^^v>^vvv^^v<>^<>^<^v<^<v>vv^<^<<^v><^vv><^^>vvvv<<<<>^>^>>^v>>><>><<v^^vv^^vv^<><>^>v^>^<^><<v^v<<^>><vv<><v>v^<vv^><^^^>v^><^^^<v<v>v^<>><<v>^<<^>v^<v^>^>>^vvv>>>v^v^<v>^<v<><<<>^v^^<v^vvv^^^>vv^v<^<v>v<vv^>^<<^^v^v^<v>vv><<>>v^<<vv>>>v^<>v^<>v<v<>^<>^v<>>^>>^<^v^>v^>^v<^^v<<v>>><>v>v<v^v>^^v^<^v^<>^^>>>v><>v<<<<^v>v>>^^<^>^<^<v<^<^>>^^>^<>v^><<^^v^<vv^><><><<^v<>v<><><vv^<>>^><>>vvv^<^^^^>^v<>v<^v<v><v><>><^<<<><>^^<>>^vv>>>v><^<^>><v^^>v><<><^><v<^v><>vv^v^^^^<^v<v>>^>>vv>v>>^^v<vvv^>^>v^>^<>v^vvv^^^<^vv^v^v>>vv^><^<^>>vv<^<vvv^>v^<<v><v<>^^vvvv>v>^^v^>>vv^^^<^>v<<<>^>v<>v^vv^><v^^>vv<>v>v^v>><^<><>v>>v>>^><v<^<\nv<vvvv<^>>v^v^>^<>>><v><><>v<^^v>v<>vv>^<><>^^v><<^v<>^<^>>^<>><<v>v^<>v>^<v>v<v<v<<>^<^v>>v<>^^<^<<^v<<>vv>v<<^<v>^v><v^^v>^^<^>>>v^<v^^v<^v<<v>v<v^<^^v<vvv>^><>v>^<v<<>^<vvv<vvvv^>^v>vv^^^><^>v>v<<^vv^<^^>^^vv^v<<^<<>>^>^v^v<v><><^v>v^v^<<^<v>^^<>^<^>^><><<>^>^^v^v<<><>v<>v^v>v<^<>^vv^^^vvv<v^>>>vvv>>v^>>>^^<^^><<>^v<>>^<^v^<><><vv^>^>^<^^>v>>^^v^vv^>>vv^^v><<v>><v<<<<>v<<<>>v<v^^v^^^^v>^vv>><>^>>>>><v<>>v<v^<vv<v>><<<^v>>>vv>v^<^<<^<v^>v^<>^^^<>>v<v<v<><>v>v<><>v<<v><^<>v^><>^vv<v^^<<<>^>>vv^^>^^<^<><vv<><^^><v<^v<>^>>><>^><vvv><^<<v^<>v^v<><<<^^>><<><v^<^vvv^v>><^^^><v^vvv>^v><^<<v^>^>v<v>>vv>^<^vv<<>v^<v>>^^^>^<<<^<v^>^^v<vvv^^>^<<^>><><v^vvv><><^^<<^<>^<>^v^v<<>^>^>>vv<v>>v>>v<vv<vv<v<^<v^v<<<^^>^v<<><>v^>vv<<vv^^^<>><v>^v>v<<vv<<^v^<^^^vv><vv^^^^^^vv<<>^v^vv>>><>^<>><<>>v>v^>>v>>v<<>v>^^v^^^<^v^^v>v>^>>v>><<v><^>><^<^>^>^<v^v^<<^>^v^<>^>v<>>^<>vv>v^<v<<vv><<v^v<<><<><vv><^>>v^><^v>^><<^>>><>>^<v><v^>v>v>>>>>vv<vvv<<>v>^^>v^^>v<v>^<^^<^>>^^>v><<v<<>^><^^><v>^^>>v<><^>v<v<><<>^v>v\n>vv>>>>v><<^v>^^vvvvv><^v<>^<<>^^<^vv^>^<^^<>^vv<<^<v>^v<^<><<v><<^<v<<<v<<vv^v<v^>^v<>><<^<<><<<>^vv<v><v<>^<^><>vv>v^v<v><^v<vv>^>^^^v>^^<<^v>v>^<<^^^v<v>v^<<^<<<>>>^>^v><<>v>^<^<<^vv>><<^<^^><<>^v<^^><vv^>><v><<v^v<<<><v>^<^<vv^>v<>>^vvv^^v>^v^^v>^>^^^^<>><vv>vv>>>vv<<^vv<>>><v><<^^<><<<>>^^^v>^v>v<^<^v^^<<^<^vv<<<<<<vv<^>v^vv^>v>v^<^^<vv<>^><v^^^v^>^><<^<^>^<<^<<>><v>^<^>^^><^v^^^^v>>v<>^^<><^<^^><>vv>>><vv<^<>^v>>vv>^^><vvv>v<>^>>>>>><<<^<>>^<^>^<^<v>v^v^^v^^^>>^<<>v>>v>>>v^<<v^><v>^>v>v>^>vvv<<<>v<^<>v<>>>^<v><<^<v><v>>vv>>><^v^<<<<<^v<^^vv>^vvv<^v>v^^<^^v>>^<<<>^>>^^>^>>>>^v>v^<^^><>v<<<<^<v>v>^>^>>v><<^^^>v>><vv>^><>>^vv^^^<^<>v^^<>^v>^<>>^^v^>^^^v<><v^>>^><<>^^>>v<>>^<>vvvv>>>^vvv>^vv><><>v^v<v<^vv^v<>>v>>vv><<<>vv<^v>v>^v><v^<<^^^^v<^<>^<><v>^>v<<^v^<v<^<vv>v^^v>^<<<>^v<v<^v^<v^<^^v^^>>v>v>v>^^v<<v>^v>v^>^<v>>^^<>^>^><^<><>^>v>^>><^^^vv^<><<<<^>>>><^^^>vv><^<>>><<v><^v>v<<^v^vv>><>v<><^v>v^v>><v<^^^^>^>v>v<>^^<>vv>>v><<>v>><^<^v<<^>vvvv<<v<<^^<v<^^<>>^v<>^^v<>^^>v<<<>>^^>vvv<\n>^v^v^>>vv><<^<>v>v^v^><<<>v<<^v<v<>v^^<^>^>^vv<<>v^>>^>v<^>^v>^<>v>v^><v><>>^<v<^>>v^<v^v^^^^v<<^>>>^>>><>v^v^>^>>vv^<^>v<>>v^^>>^><<<<^>>v><<<vvv>><^v^^><>v>vv^>v<<<<^^>>>><^>^>>>>^v<<><^^v^<v><^>>>>^>>v><^<><>>>>v><v>v>>>>v^^<v>>^v<<v<<>>^<v^<>>>^<<>>v>^><>v^^>^<<><^<>>>>v<vv^^v^v>^v^v>^><^<^v^v<^v^^>^^>><v><^>^>^>>^^>>^<>vv>><>v><^>>v<<^><<^<^>v^<v>vv>v^v^^>^>>v><^<>v^><>>>^^v>v^^>>>^v<><<<<<^v^><^>>^^vv^>><^<v>v><<v^><^>^>v<^^v^vv<<^>^<>^<v><v>v^vv^<>v<vv^vv>v>^><v>>vv>>^^>^<v<<v<<^^vvv<v<v<<<<<v>^^<>^v^><v>vv>^^^v^<<>^><v<<<<>^><vv^vvv^<<^vv><v^^<<<^<>><v<<^>vv>^^>v<<v>vvvv^<<<<<v>^^>^<>v><^<>v^>^<<>v^>><>>>^^<v>^<>v^>>>^^>><^<v><^<<>^<<<v>v^><<^v<v<><v^<^<><v^^<v^vv^>v^<v<v^><><<vv<>^v<<<^vv<>v^>^^v>><<<v<><vv><<v>^<v^^<>^<>vv<<v<<<><v><<v^^<v^><>^^^^v^vv^<>v>>>>v<>>><v>v>v>^>v^v>vvv^<<<>^^v>vv<v<v<><<>>^<>v<vv>>>^<<>^<v^>><v<v^vv>^^<<^v^v<<<<<<^>^^<<>v<<><<<^v><<<v^<^<v^><v<>>><>^><^<><vvv^v>v<^v><v>>vv<<>v^v<<^<^>^>^v<v<<v<v>><v^<^<^v>v<<<>^>^<>^<v^<v^v^v>^^^v^vv^v>^>vv><^<<>>\n^v><>v<^^^<>>>><>>>^v<vv<<^^<><<^<^>v>>^<<v>><v<<>><^>>v^v^^>v^>v^><^<vv^>><v<>v>vvv<<>v><^vvv>^^vv^<^>><v<>^vvv>^^^>^v^^vv^v^<>^^<>^<v>^^<<v>><<^^<<^<<<>^>v<v^<>>^>^v^^<>^><vvv^<vv<>v<^<vv><^^v<<<vv>^^^>v^^<v^^>v>><<<^<<><<<><><vv^v>>^^>^<<>>><<^>vv><v>^vv^<>^>><>^^<><><<><>^^<><^<>v>^^<<v>v^<<>>v>^>^^>vv^^v<^vv><<vv^^^^^<<<<v<^<<>v^^v^<v>v><<<<<>>v^>^>><<>^^><>v>>v^<^^^^>>v><<v>>^v<<v><vv>>v^<<^>>><^<^v<>vvv<<vv<^<v^v>v<v<<v^^v><<>v<v<>^<>><^>^^^>^v^<<>v^v^^>>v>^v>v<><<^>v^<><<<v^>>>>>vvv^v<>^^>^^^<vvv<vv^^>v<v><v<vv^><^v>>v<v^^>^vvv^^>>vvvv^><^vv^^vvv<<>>^>v^v^v><^^^^vv^^><^<<><<<<v><<^v<^<>>^^vv<><^^><v^<^><^>v^^^<^^>>vv^^>><v<<^<>>><v<^<<v<v>v>>^>>>>><v>v<><^^>^<v<^^vv><<<^<><v^<^v^^v<<<v<<<vvv>><>>>vvvv^<^^v<v^v^vv^v^<v^<<>v>><^^^v><^v^<v^^><vv^<><^^<^<<<<vvv<v><>>>v^<v>v>vvv>><vv>^>^<^><^v>vvv^v><><>>><^<v<v<<<>v<v<<v^>^<v^v<vvvvv>>^><v>>v>>>>vv^<vvv^v^v>>v>v^><<>v^vv^><^>^<vv^v<<v><vv<<^v<>^><v^<^>v>vv^<^vv<v^>^<vv<v^><^>vvv<v^<^<>^v<v^^>><^^<vv^>>vv><^>>^><>>v><>><<<^>>v>^^<<^\n>>^vv>^>^><>>>v>^><^<><>><<<<><<^<^<v^v^v>>>><><vv>>^<>v<v^>v<<^>>v^v>^>^>v<^v>>v<vv^vvv<<^^^<^v<vv<>>^^><<><<^v><^^v>><v>^<v<><^>>v><v^v<^<v^>>v>>>^v<^v><<>v>^<^^^<^vv><<<><>^v^v^^>^v>>v<v<^<<v^^><<^vv>v>^vv<^>v<><<^<<^<^^v^<vv>^<>vv<^>>^^^<^v><>vv^>vv^^vvvv^>v>^v>^<><v^^>v<><vv^><>^>v<>><v<<>^^>^<>vv<>^vvv>><^^v<>>^<v<v^>>v^>>>vvv<<vv^^^^>>^^<<>vv<<>>>v<>v>v^^v<vvv<><><<<^v^>^v^^^v>>v^>v>^v<>v^><>^><v^vv<^<^v^^v<><vv<<^^><v>>^<>^<v>v<<v^^v<v><<>^><>>><><><<>^^<^>vvvv<<v<^<^v><^<<>>vvv^^vvvv>vv<<v<>^^<><<><>^<^v<^v>^^<><>>v><^>><v<v>v>>vv<<v<v<vv>^v^<>>^v^<><<<vv^^>v^<<v^v<^v^>><vv><>^^>><<^>><<v>^<>^>v<^^^vv^<<<<^vv>><vv^><^><^<^^<><v<<^>^^><v>^>^vv><vv><^v>v<vv>^><v^<vv>>vv^v>v>><v^^><^<vvv<v^^<<v^>^<^^^vvv<^>^>^><^^<v^<>v^vvv>^<<v<^^v>v>>>><>vv<>^v<<v>>^<^<<<<^v>^^>>vv>>v>v<vv^><^^v<<<v<<<<^>v^<^v<^^^><^v>^><v^^<^<>>>v^^<^v^<v<^^>vvv>^<<^v<>>^v<<^^v^<v<v<<v^v^<<>v>^^^<v>>^>>^^>>v^>v><>vv^<v<vv^v<vv^^vv>^^>>v<^>>v>v^<>>v^^v>>>v<<>vvvvv>><><>^^<<v>^<>v^^^<><^>><^^v^v^^<^<v><><<<v><<>\nvv>>^v<v<^v<<<<^v<>v<<^v^<vv><>>v<<><v<<><<^vvvv<<^<<v<>v<v>>^^>^<<^v<^v<^<>v><<vv^<vv<v^>v><<>vv^v><vv<<<>><^<v<<><<>v>>v><>>^^<>>>^<>v><><>v^<v>v>>^v>v>^<>><>^^<<^v><>^<^><^>>v^^<^<v^<>^^v>>v<^v><v^>^>vvv>v<<vvv^<v<v>v>v>^^vv<<>v>><^v^v^^v<^vv<<><>>>^^^v>v^^^>v^<><^<>^><v>><<>v^>^>v>><v>v>><^v^v<<>^v<>>v^v^v^^v^^>>v>^<^>>><^v^<<^>^>^>>v>>^>vvvv>>>^^^<<vv>^v<v<^^<v<<>^v>^<^>>v<><<v>v><v>v^<><^<<^v^<^<<^^v>^<v<<>v>v^<><^v^^>><>^<^^><<v^^^v^>>>v>vv^v^v<<<>^v<>^^vv<>^v><^vv<^vv^<<<^<<^^><<><<>^v^<v>v<vv^^^^>vv^^>^<<v<><^>^<<<v<><vv><^v<<>>v>>>><^^>^>^>>>>^<vv>^^v^^>v<^^<^vv>>^^^^vv<^>v<><vv<^^v><<><><^v^><^^>>^^>vv><v^<>v^v>v>^<<v><<^v^v>v>^<v^>><v^<<^<>>^^>>><vv<vv<<>>v<<^<^>><v<v>v><>v^<v^v>^vv>>><^^>>v^^>^>^<^>^v<v<^^>v>v<<vv>>^<>v>v^<v^<<vvv>^^<>vv>>^^>>><<^v<<v>vvv><v>^>v^vvvv^>>^<^<>v<vv>^<v^><<<v^v^>vv><>^<<vv^>>^>>^^v<><v<v^>>v^^v^><^><v^>^^v<^>^v^>^<>>^^>vv^vv<^^v<<<<^<vv<<<^vv>^^<vv^<v<v^><^>v>v^<<>^<^^^^^v>^^>^>vv>>v><^v^^>v<^>v^>><v<<v^>^>>^^v><>>^><<v<>v<><^^v>^v>^>v<v<^v<>^\n>^vv>^<vvvv>v<><<vv>><vv<>v^<<>>v>v<^><>^v<><>>^<<<v>^>vvvvv^>vv^^<>><^<>v>^^><v<>^<>>vv^vv^^v^>vv^<v>v^>>vv>>v^><<<>>^<<^>vv>v>^<>>>^^<v^^>><v^v<v^><<v>^v<>>^vv<>v<vv>^^>>><^<^^>>>vvv><><vv<v>v^<^^<^><>>^<<><<>>v>v^^^><^>v<<>^^<<vv<>>>v>>v^v<<><<^v^^<<vvv^v^^<>v><<^v>>^v<>^^^^v>^>>^>>v^>^>>v>>><^><<^v><>><><v^<v<<>><^v<^>vv<v^<>v^<<^><<<^^>>v<^>>v>>v>>>^<v^v<v<<>v>^><<vv>vv><^>v>^v<v^v><^<^vv^<vv<^^v>^^v^v<v<>>>>>^v>>^>^>v<>^>^<v^<>>^^v>v<>^<><^^<v<v^><<^v>v><>v>^>^<>><>>^>v^<v>v<<<>^><^v<><v>^^^^v<><^^v^^<^v>^<<v^>^>><^v><><<^^^v>><^^<<^>^vv<<^<>>v<<>>><v>>>^<<v<<><v<^v<v^v<>>^>v<<v^<><<>v<^v^<vv>><vvv>v<^^<<^v<<^v><>^vv>v<><v^><v<^^<<<>v<<<^^v^><^^^^<^^v<<^<>v><>>v<vv<vv<v^v<<>><v^v>^v<><v<><v>v><>><^>^^^<v<<^^>>v<<<<v<<^v^vv>>v^>vv<><<<^^><v>^^>^^v<^>^^^v<^^>>>^<^<>v<vv<<^^><^^v^vv<v<v^<^v<<v><^^^<v<>v<^<<v><^><><>v^v>>>^vv^<<^v<<><<<><^^^>>^<^v^v<<>v<v<^<^v^<<^<^>^v^v>v><^^>^>>^<<><v^><<^<<<>v^><>><^<v^v>>^<^<^v^<<<^>^<>^^<>>^<^v^v>v^><v^<>v^>>vv>>>^<>vv<><>^>>^><>>v><^>>>^><^v<vv\n"

Day15.part1(input) |> IO.inspect(label: :day15_part1, charlists: :as_lists)
Day15.part2(input) |> IO.inspect(label: :day15_part2, charlists: :as_lists)
```

```elixir
defmodule Day16 do
  import AOC, only: [s2map: 1, add2: 2, sub2: 2, set: 1]

  def next(p, {x, y}=u), do: [{add2(p, u), u, 1}, {p, {y, x}, 1000}, {p, {-y, -x}, 1000}]
  def prev(p, {x, y}=u), do: [{sub2(p, u), u, 1}, {p, {y, x}, 1000}, {p, {-y, -x}, 1000}]

  def bfs(_, [], d), do: d
  def bfs(m, [{c, p, u} | pq], d) do
    pq = Enum.sort for {q, v, i} <- next(p, u), m[q] != ?#, c < d[{p, u}],
      reduce: pq, do: (pq -> [{c + i, q, v} | pq])
    bfs(m, pq, Map.put(d, {p, u}, min(c, d[{p, u}])))
  end

  def bt(_, s, s, _, _, r), do: r
  def bt(m, s, q, v, d, r) do
    for {p, u, i} <- prev(q, v), d[{p, u}] == d[{q, v}] - i,
      reduce: r, do: (r -> bt(m, s, p, u, d, MapSet.put(r, p)))
  end

  def part1(input) do
    Enum.min for m <- [s2map input],
      s <- for({p, ?S} <- m, do: p),
      e <- for({p, ?E} <- m, do: p),
      {{^e, _}, c} <- bfs(m, [{0, s, {0, 1}}], %{}), do: c
  end

  def part2(input) do
    m = s2map input
    s = hd for({p, ?S} <- m, do: p)
    e = hd for({p, ?E} <- m, do: p)
    d = bfs(m, [{0, s, {0, 1}}], %{})
    {_, v} = Enum.min for({{^e, v}, s} <- d, do: {s, v})
    Enum.count bt(m, s, e, v, d, set([e]))
  end
end

input = "#############################################################################################################################################\n#.............#...#...........#...#...................#.........#...........#...................................#.............#.......#....E#\n#.#####.#####.#.#.#.###.#####.#.#.#.#.#########.#####.#.#######.#.#########.#######.###.###.###.#.#######.#.###.#.#########.#.#####.#.#.#.#.#\n#.#...#...#.#...#.#...#.....#.#.#.#.#.....#.....#...#...#.......#...#.....#.....#...#.#.....#.#.#.#.....#.#...#.#.#.#.......#...#...#.#.#.#.#\n###.#.#.#.#.###.#.###.#.###.#.#.#.#.#.###.#.#####.#######.#########.###.#######.#.###.#######.#.#.#####.#.###.#.#.#.#.#########.#.###.#.#.#.#\n#...#.#.#.#...#.....#...#...#...#...#.#.#...#...#.......#.........#...#.........#.#.#.........#.#.......#.#...#.#.#.#.....#.....#.#...#.#.#.#\n#.###.###.#.###.#########.#####.#####.#.#####.#.#.#.#############.#.#.#####.#####.#.#.###.###.#.###.#####.#.###.#.#.#####.###.###.#.###.#.###\n#.#.......#.....#.....#...#.....#.....#.......#...#.............#.#.#.....#.#.....#.#...#...#.#.#...#.....#.#.#.#.....#.#...#...#.#.#...#...#\n#.#########.###.#.#.###.###.###.#.#####.#################.#######.#.#####.#.#.#####.###.###.#.#.###.#.#####.#.#.#####.#.###.###.#.###.#.#.#.#\n#.#...#.....#.#...#...#.#.#.#.#.#.........#.............#...#.....#.....#.#.#...#...#...#...#.#...#.#.#...#...#...........#.#.............#.#\n#.#.#.#####.#.#.#####.#.#.#.#.#.#######.#.#.#######.###.###.#.#######.###.#.###.#.#.#.#.#.###.###.###.#.#.###.###########.#.#.#####.###.#.#.#\n#...#.....#...#...#...#.#.#...#.........#...#.....#...#.#...#...#.#...#...#.....................#...#...#...#.......#...#.#.#.#.......#.#...#\n#.#######.#####.###.#.#.#.#.#####.#####.#####.###.#####.#.#####.#.#.###.#########.#.#.#.###.#######.#.#.#.#####.#####.#.#.#.###.#.#####.#.###\n#.#.....#.....#.#...#.#.#...#.....#...#.#.#...#.....#...#.....#.#...#...#.........#.#.....#.#.......#...#.......#.....#.#.#...#...#.....#...#\n#.#.###.###.#.#.#.###.#.#.###.#####.#.#.#.#.#######.#.#######.#.###.#.###.###########.#.###.#.###########.#######.###.#.#.###.#.#.#.###.#.#.#\n#...#.#.#...#...#.#...#.#...#.#.....#.#...#.....#.#...#.......#...#.#.#.#.......#.....#...#...#.........#...#.....#.#...#...#.#.#...#.....#.#\n#####.#.###.#####.#.###.#####.#.###.#.#.#.#####.#.#.#####.###.###.###.#.#.#####.#.#####.#.#.###.#######.#####.#####.#.###.###.#.#.###.#####.#\n#.....#.....#.....#...#.#.....#...#.#.#.....#.......#...#...#.#...#...#...#.......#.....#.#.#...#.............#.....#.#.#.#...#.#.#...#...#.#\n#.#########.#.#######.#.#.#########.###.#####.#######.#.###.###.###.###.###.###.#.#.#####.#.#.#.#.#######.###.###.###.#.#.#.###.#.#.###.###.#\n#.#.......#.#.......#.#...#.......#...#.#.........#...#...#...........#...#.......#.#...#.......#.........#.......#...#...#.....#.......#...#\n#.#.#.###.#.#######.#######.#####.###.#.#.#.#####.#.#####.#.#########.###.#########.#.#.#.###########.#.###.###.#.#.###.#########.#######.#.#\n#...#.#...#.#.....#.#.......#.........#.#.#.....#...#.....#...#.....#...#.#...#.....#.#.#...#.......#...#...#...#.....#.....#.......#.....#.#\n#####.#.###.#####.#.#.###.###.#######.#.#.#####.#.###.#######.#.###.#.#.#.#.###.#.###.#.###.#######.#####.###.###.###.#####.#####.#.#.#####.#\n#.....#...#.....#.#...#...#...#.......#.#.#.....#.#...#...#...#.#...#.#.....#...#.....#...#.......#.....#...#.#.....#...#.#.........#.....#.#\n#.#.#######.###.#.#####.###.#.#.#######.#.###.#####.###.#.#####.#.###.#.#####.###.#######.#######.#.#.###.#.#.#########.#.#####.#.#######.#.#\n#.#.#...........#...#...#...#...#.....#.#...#.......#...#.......#...#.....#...#.#...#...........#.#.#...........#.....#.#.#.....#.........#.#\n#.#.#.#####.#######.#.#####.#####.###.#.###.#####.###.###########.#.#######.###.#.#.###.#####.###.#.###.#.#.###.#.###.#.#.#.###.#.#########.#\n#.#.#...............#.....#.#.....#...#...#...#...#...#...#.....#.#...........#.#.#.....#.....#...#.#.#.....#...#...#.....#.#.....#.....#...#\n#.#.#.#.#.#.#######.#####.#.#.#####.#####.###.#####.#####.#.###.#.#######.###.#.#.#####.#.#####.###.#.#######.#.###.#.#.#.#.#.#.#.###.###.###\n#.#.#.#.#.#.......#.....#.#.#.....#.......#.#.....#...#...#...#.#.......#.#...#...#.....#.....#.#...#.......#.#...#.#.#.#...#.#.....#.......#\n#.###.#.###.#####.#######.###.#.###########.#.#.#.###.#.#####.#.###.#####.#.###.###.###.#######.#.#.#####.#.#.#####.#.#.#####.#.###.#######.#\n#.....#...#.....#...#...#...#.#.#.....#.....#...#...#.#.#.....#...#.#.....#.#.....#.#...#.....#.#...#...#.#.#.......#.........#...#.......#.#\n#.#######.#.###.###.#.#.###.#.#.#.#.###.#.#.#####.###.#.#.#######.#.#.###.#.#####.#.###.#.###.#.#.###.#.#.#.#######.#########.#.#.#######.###\n#.....#...#.....#.#...#...#.#.#.#.#.....#.#...#...#...#.#.....#.#.#.#...#.#...#...#...#.#.#...#.#.#...#.#.#...#...#.#.....#.............#...#\n#####.#.#.#.#####.#######.#.#.#.#.#######.###.#.###.###.#####.#.#.###.#.#####.#######.###.#.###.#.#.###.#.###.#.#.###.###.#.###.###.#######.#\n#.#...#.#.#.#...#...........#.#...#...#.#...#.#...#...#...#.#...#...#.#.#...#.#.....#.#...#.....#...#.....#...#.#.....#.#.#.......#.#.....#.#\n#.#.###.#.#.###.#.###########.#.###.#.#.###.#.###.###.#.#.#.#.#.###.###.#.#.#.#.###.#.#.#############.#########.#######.#.###.#.###.#.###.#.#\n#...#...#.#.#...#.#...........#.....#.#.#...#...#...#...#.#.#.#...#.#...#.#.....#.....#.#...#.........#.........#.......#...#.#.....#.#...#.#\n#.###.#.###.#.###.#.#######.#.#######.#.#.#####.###.#####.#.#.#.###.#.#.#.#######.###.#.#.#.#####.#####.#########.#####.###.#.#.#####.#.###.#\n#...#.#...#.#.....#.#.....#...#...#...#.#.#.#.....#...#...#.#.#...#.#.#.#...#.......#.#...#.....#...#...#.....#...#...#...#.....#.....#.#...#\n###.#.###.#.#######.#.#########.#.###.#.#.#.#.###.#.###.###.#.#.#.#.#.#.###.#.#####.#####.#####.#.#.#.#####.#.#.#.#.#.###.###.#.#.#####.###.#\n#...#.#...#.........#...........#...#...#.#.......#.....#...#.#.#.....#.#...#.....#.#...#.#.........#.#.....#.#.#...#.....#...#.#.#...#.....#\n#.#.#.#.#########.#######.#########.###.#.#.#####.#######.###.###########.#######.#.#.#.###.#####.#.#.#.#####.#.#.#.#######.#.#.#.#.#.#####.#\n#.#...#.#...............#.....#...#.#.#.#.#...#.#...#.......#...#.........#.#...#.#...#.....#...#...#.#.#...#.#.#.#...#.#...#.#.#...#.#.#...#\n#.#.###.#.#######.#####.#.###.#.#.#.#.#.#.#.#.#.###.###.###.###.#.#########.#.#.#.#####.#####.#.#####.#.#.#.#.###.###.#.#.#####.###.#.#.#.###\n#.#...#...#.......#...#.#.#...#.#.#.#...#.#.#.....#...#.#...#...#...#.#.......#.#...#...#.....#.........#.#.#.....#.......#...#.#.........#.#\n#.#.#######.#########.#.#.#.#####.#.###.#.#.#####.###.#.#.#.#.#.###.#.#.#######.###.#####.#########.#####.#.#######.#####.#.#.#.#.#.###.###.#\n#.#.#.....#.....#.....#.#.#.....#.#...#.#.#.....#.#...#...#.#.#.#...#.....#.....#...#...#.#...#.....#.....#...#.....#...#...#...#.....#.#...#\n#.#.#.#.#.#####.#.#####.#.#####.#.#.#.#.#.#.###.###.#######.#.#.#.###.###.#.###.#.#.#.#.#.#.#.#.###.#######.#.#.#####.#.###########.#.#.#.#.#\n#.#.#.#.................#.....#.#.#...#.#.#...#.....#.......#.#.#.#.....#.#.#...#.#.#.#...#.#.#.............#.#.#...#.#.........#.....#.#.#.#\n#.#.#.#.#########.###.###.#####.#.#.#####.#.#####.###.#.#.###.###.#.#.#.###.#.###.###.#####.#.#.#.#############.###.#.#######.#.#.#.###.#.#.#\n#.#.#.....#.....#.#.......#.....#.#.#.....#.#...#.....#...#...#...#.#.#.#...#...#.....#.....#.#...#...........#.#...#.#.....#.............#.#\n#.#.###.#.###.###.###.#.###.#####.#.#.#######.#.#######.###.#.#.#####.#.#.#####.###########.#.#.###.#########.#.#.###.#.#.#.#.###.#.#.###.#.#\n#.#.....#.......#...#...#.#.#.....#.#.#...#...#.......#...#.#.........#.#...#.#...#.........#.#.........#...#.#.#...#.#.#.#.#...#.#.#...#.#.#\n#.#.###.###.###.#.#.###.#.#.###.#.#.#.#.#.#.#######.#.###.#.###.###.###.###.#.#.#.###.#######.#######.###.#.#.#.###.#.#.#.#.###.#.#.#.###.#.#\n#.#...#.....#...#.#...#...#.#...#.#.#...#.#.......#.....#.#.#...#...#.#.........#...#.#.......#.....#.#...#.#.....#.#...#.#...#...#.#.....#.#\n#.#.#.#.#####.#.#.###.#####.#.#####.#.###.#######.#.#.###.#.#.###.###.#########.###.#.#.#######.###.#.#.###.#####.#.#####.#.#######.#.#####.#\n#.#.#.#.#.....#.....#.......#.#.....#...#...#...#.#.#.....#.#.#...#.....#.........#...#...#.....#.#.#...#.#...#.......#...#.................#\n#.#.#.#.#####.###############.#.#######.#.#.###.#.#.###.###.#.#.#######.#.#.###########.###.#####.#.###.#.###.#########.#############.#######\n#...#.#.....#...#.......#...#...#.......#.#...#.#.#...#.#.....#.#.......#.#.#.......#...#...#.....#...#.#...#.................#.....#.......#\n###.#.#.###.#.#.#.#.###.###.#.#######.###.###.#.#.###.###.###.#.###.#.###.#.#.#.#.#.#.###.###.#######.#.#.#.#########.###.###.#.###.#.#####.#\n#...#.#.#.#.#.#...#...#.....#.#.....#.#...#.#.#.#.#.#...#.#...#...#.......#...#...#.#.#.#.#.........#.#.#.#.#.......#.....#.#...#.#.#...#.#.#\n#.#.#.#.#.#.#########.#####.#.#.###.###.###.#.#.#.#.###.#.#.#####.#.###########.###.#.#.#.###.#.#.#.#.#.###.#.#.###.###.#.#.#####.#.#.#.#.#.#\n#.#.#.#...#.#.......#...#...#...#.#...#.#.......#...#.#.#...#.....#.#...#.....#.....#.#.#...#.#...#...#...#.#.#.#.#.#.#.#.#.......#.........#\n#.###.###.#.#.#####.#.#.#.#######.#.#.#.###########.#.#.#####.#####.###.#.#.#####.###.#.###.###.#######.#.#.#.#.#.#.#.#.#.###.###.###.#.###.#\n#.............#.#...#.#.#.#...#.....#.#...........#.#.#...........#...#...#.#...#.......#.#...#.........#.#...#.#.....#.#.#.................#\n#.#####.#.###.#.#.###.#.#.#.#.#.###.#.###.#####.###.#.#########.#.###.#####.#.#.#######.#.###.###.#####.#.#.###.#######.#.#.###.###.#####.#.#\n#.#.....#.....#...#...#.#.#.#.#...#.#...#.#...#.#...#.....#.......#.#...#...#.#...#...#.....#.#.......#.#.#...#.....#...#.#.#...#.......#.#.#\n#.#.#####.#.###.#######.#.#.#####.#.###.#.#.#.#.#.###.#####.#######.###.#.###.###.#.#.#######.#######.###.###.#####.#.###.#.#.#####.###.#.#.#\n#.............#.#...#.....#.....#.#.....#.#.#.#.#.#...#.....#.............#...#.#...#...#...#.......#...#.#...#...#.#.#.#...#.....#...#.#.#.#\n###.#.###.###.#.#.#.#.###.#.#.#.#.#######.#.#.#.#.#.#.#.#####.#############.###.#######.#.#.#######.###.#.#.###.###.#.#.#########.#.###.#.###\n#...#...#...#.....#.#...#.#.#.#...#.....#...#.#.....#.#...#.#.#...#.....#...#.......#.#...#.#.......#.....#...#...#...#.....#...#.#.....#...#\n#.###.#.#.###.#####.###.#.###.#.#.#.###.#####.###########.#.#.#.###.#####.#.#.###.#.#.#####.#.#######.#######.###.#######.###.#.#.#.#######.#\n#...#.#...#...#...#.#...#...#.#.#.#.#.#...#.#.#.....#.....#.#.#.#...#.....#.....#.#...#...#.#.#.....#.........#...........#...#...#.....#...#\n###.#.###.#.#####.#.#.#####.#.###.#.#.###.#.#.#.###.#.#####.#.#.#.###.###.#######.###.#.#.#.#.#.###.#.###.#.#.#.#######.###.#######.###.#.###\n#...#...#.#.#...#.#.#.#.#...#...#...#.....#...#.#.#...#.#...#...#.#.#.#.#...#.....#.#.#.#.#.#.#.#...#.#...#.#.#.#.......#...#.#.........#...#\n#.#####.#.#.#.#.#.#.#.#.#.#####.#####.#####.###.#.#####.#.#.#.###.#.#.#.###.#.#####.#.#.#.#.#.#.###.#.#.###.#.#.#########.###.#.#.#.###.###.#\n#.#.......#.#.#...#.#.#.#.#.....#...#.....#...#.#.........#...#...#.......#.#...#.......#.#...#.......#...#.#.#...........#...#.#.#...#.#...#\n#.#.#####.#.#.#####.#.#.#.###.#.#.#######.###.#.#.#####.#######.#.#######.#.###.###############.#########.#.#.###.###########.#.#.#.#.#.#.#.#\n#.#.#.......#...#...#.#.#.#...#...#...#...#...#.#.......#...#.#.#...#.....#.#...#...............#.#...#...#.#...#.#.........#...#.#.#...#...#\n#.#.#.#######.#.#.###.#.#.#.###.###.#.#.#######.#.#######.#.#.#.#.#.###.###.#.###.#########.#####.#.#.#.#######.#.#.#.#####.#.###.#.#######.#\n#.#.#...#.....#.......#...#...#.#...#...#.......#.........#...#...#...#.#...#...............#.....#.#...#...#.......#.#...#.#.#...#...#...#.#\n#.#.###.#################.###.#.#.#######.#.#######.#################.#.#.###.#######.#####.#.###.#.#####.#.#.#########.#.#.###.###.###.#.#.#\n#.#.#.#.....#.....#.....#.....#.#.....#.#.#.#.#.....#...#.........#...#.#.#...#...#.#.....#.#...#.#.......#.#.....#.....#.#.#...#...#...#...#\n#.#.#.#####.#.###.#.###.#####.#######.#.#.#.#.#.#####.#.#.#######.#.###.#.#####.#.#.#.###.#.#.#.###########.#####.#.#####.#.#.###.###.#####.#\n#.....#...#.......#...#.......#.......#...#.#.....#...#...#.......#.#...#.#.....#.#.#...#.#.#.#.......#...#...#.#...#...#.#...#.....#...#...#\n#.#####.#.#######.#.###.#######.###########.#.#####.#######.#####.#.#####.#.#####.#.#.###.#.#.#######.#.#.#.#.#.#####.#.#.#########.###.#.#.#\n#...#...#...#.....#.#...#.....#.....#.......#.#.#...#...#...#.....#.......#...#.#.#...#...#.#...#.....#.#...#...#.....#.#.....#.......#.....#\n#####.#.###.#.#.###.#.#.#.###.#####.#.#######.#.#.#####.#.###.#############.#.#.#.#.###.#.#.###.#.#.#.#.#######.#.#####.#.###.#.###.#.#.#.#.#\n#...#.#.....#.#.#...#.#.#.#.#.#.....#...........#.#.....#.#.#.#.............#.#.#.#...#.#.#.#...#.#.#.#.......#.#.#.........#.#.#.......#...#\n#.#.#.#.#####.###.###.#.#.#.#.#.#####.###.###.#.#.#.###.#.#.#.###.#######.###.#.#.#####.#.#.###.#.#.#.#.#.#.#.#.###.#######.#.#.###.#######.#\n#.#...#.......#...#...#.#...#.#.....#.#.#.....#...#...#...#.#...#.#...#.......#...#.....#.#...#.#.#.....#...#.#.....#.....#.#.#.........#...#\n#.#####.#.###.#.###.#.#####.#.#####.#.#.#####.###.###.###.#.###.#.#.#.#.#######.###.#########.###.#####.#####.###########.#.#.#####.###.#.#.#\n#.#...#.....#.#...#.#.#...#.#.....#.#.#.....#.#...#...#...#.#...#.#.#.#.......#.#...#.......#.#...#.#...#...#.#.........#...#.........#.#...#\n#.#.#.#.#.###.###.#.#.#.#.#.#.###.#.#.#.###.#.#.###.###.###.#.#####.#.#.#.#.#.#.#.#.#.###.#.#.#.###.#.#.###.#.#.#######.#.#########.#.#.#.#.#\n#.#.#...#.#.....#.#.....#...#...#.#.#...#...#...#...#...#...#.......#...#.#...#.#.#.#.#...#.#.#...#...#.....#.....#.....#...#.......#...#.#.#\n#.#.###.#.#.#####.#############.#.#.#######.#####.#.#.###.#############.#.#.###.#.#.#.#.#.###.###.#.###.#.#.#######.#######.###.#.#.#######.#\n#.#.#...#...#.....#.....#.....#.#.#...#...#.......#.#...#...#.........#...#.....#.#.#...#...#.....#.#...#.#.#.......#.....#...#.#.........#.#\n#.#.#.###.###.#####.###.###.#.#.#####.#.#.#########.###.###.#.#####.#.#####.#####.#.#.#.###.#######.#####.#.#.#.#####.#######.###.#.###.#.#.#\n#.#.#.#.#.#.#.#.......#.....#.#.....#...#.#.......#...#...#.#...#...#...#...#.....#.#...#.#...#...#.#...#.#.#.#.#...........#...#.#.....#...#\n#.#.#.#.#.#.#.#.#####.###.#########.#####.#.###.###.#####.#.#.#.#.#######.###.#####.###.#.###.#.#.#.#.#.#.#.#.#.#.#######.#####.#.#.#######.#\n#.#.........#.#.....#.#...#.......#.#.....#...#.....#.....#.....#.....#...#...#...#...#...#.#...#.#...#.#.#...#.#.....#...#.....#.#...#.#...#\n#.#.#.###.#.#.###.###.#.###.###.###.#.#####.#########.#.#####.#######.#.###.###.#.#.#####.#.#####.#####.#.###.#.#####.#.###.#####.###.#.#.###\n#...#.................#.#...#...#...#.....#.#.......#.#.#...#.....#...#.#.....#.#.#.....#.#.......#...#...#...#.#.....#.#...#...#.#.#.#.....#\n#.#####.#####.#.###.#####.###.###.#.#####.###.#####.#.###.#.#####.#.#.#.#####.#.#######.#.###.#.#.#.#.#.#######.#######.#.###.#.#.#.#.#######\n#...#.#.#...#.#...#.........#.....#.....#...#...#...#.....#...#.....#.#...#...#.......#.#.#...#.#...#...#.......#.......#.#...#.#...#.#.....#\n###.#.#.#.#.#.###.###########.#.#####.#####.###.#.###########.#.#.#######.#.###.#.###.#.#.#.#.#########.#.#######.#####.#.###.#.#####.#.###.#\n#...#.#...#.#...#.#.........#.#.#...#.#.....#...#.......#...#.#...#...#.........#...#.#...#.#.#...#...#.#.#...#.....#...#.....#...#...#...#.#\n#.###.#####.###.###.###.#.#.#.#.#.#.#.#.#####.#########.#.#.#.#.###.#.#.#######.###.#######.###.#.#.#.#.#.#.#.#.###.#############.#.###.###.#\n#.#...#.....#...#...#...#.#...#.#.#...#.......#.....#...#.#...#...#.#...#.....#...#.#.....#.....#.#.#...#.#.#.#.#...#.....#.....#.#.....#...#\n#.###.#.###.#.###.#####.#.###.#.###############.###.#.###.#####.#.#.#######.#####.#.#.#.#.#######.#.###.#.#.###.#.###.###.#.###.#.#####.#.###\n#.....#.#...#...#.#...#.#...#.#.#...........#.....#.#.#...#.....#...#.......#...#.....#.#.....#...#...#.#.#.#...#.....#.#.#.#.#.#.....#.#...#\n#.#.#.#.###.###.#.#.#.#.###.###.#.###.###.#.#######.#.###.#.###.#####.###.###.#.#.#####.#####.#.#.###.#.#.#.#.#########.#.#.#.#.#####.###.#.#\n#...#.#...#.....#.#.#.#.....#...#.......#.#.........#...#.#...#...#.....#.....#.....#...#.#.....#.#...#...#.#.....#.....#...#.#.....#...#.#.#\n#####.###.#.#.###.#.#.#######.#########.#.#######.#####.#.###.#.#.#######.#######.#.#.###.#.#.#.#.#.#######.#####.#.###.#####.#.###.###.###.#\n#.#.....#.#.#...#.#.#.........#.......#.#.#.....#.#...#.#...#...#.#.....#.#.......#...#.#.......#.#.#...#.......#...#...#.....#...#...#...#.#\n#.#.#.###.#.###.#.#.###.#####.#.#.#####.#.#.###.###.#.#.#.#.#####.#.###.###.#####.###.#.#.#########.#.#.#.###.#######.#.#.###.###.#######.#.#\n#...#.....#...#...#.....#...#.#.#.......#.#...#.#...#.....#.#.....#...#.....#...#.#.......#...#.....#.#.#...#.......#...#.#.#...#...#...#.#.#\n#.###.###########.###.#.#.#.#.#.#########.###.#.#.#.#######.#.#######.#######.#.#.#########.#.#.#####.#.###.#.###.#.###.#.#.###.###.#.#.#.#.#\n#.#.#.....#.......#.#.#.#.#.#.#.......#.....#.#...#...#.....#.#.....#.....#...#.#...........#.#...#...#...#.#...#.#.#...#.#.#...#.#...#.#...#\n#.#.#####.#.#####.#.#.###.#.#######.#.#.#####.#####.#.###.###.#.###.###.#.#.###.#############.###.#######.#.#.#.#.#.#.###.#.#.###.#####.###.#\n#...#...#.#...#.....#.....#.......#.........#.#.....#.#...#.#.#...#...#.#.....#.......#.....#...#...........#.#...#.#.#...#.#.#.......#.....#\n###.#.#.#.###.#.###.#############.#.#######.#.#####.#.#.###.#.###.###.#.#########.###.#.#.#####.#.#####.#.###.#####.#.#.###.#.#.###.#########\n#...#.#.#.#...#.#...#...........#.#.....#.......#...#...#...#...#.#.#.#...#.#.........#.#.......#...#...#.#.#.....#...#...#...#.#...#.....#.#\n#####.#.#.#.###.#.###.###.#####.#.#####.#.#####.#.#.#####.#####.#.#.#.###.#.#.###########.###########.###.#.#####.#.#####.###.###.###.#.#.#.#\n#...#.....#.#...#.....#...#...#.#.....#.#.#.....#.#.....#.....#...#...#.#.#.#...........#.................#...#...#.....#...#...#.....#.#.#.#\n#.#.#.###.#.#.#.#######.###.#.#######.#.#.#.#####.#.#.#.#.###.#####.###.#.#.#########.#.#######.#.#####.#.###.#.#.#####.#.#.###.#######.#.#.#\n#.#...#.....#.#.....#...#...#.........#.#...#.....#...#...#...........................#...#...#.#.#...#.....#.#.....#...#.#...#.....#...#.#.#\n#.###.#.#.###.#.###.#.###.#.#########.#.#.###.#####.#####.#.#.#.###.#.#.###.#.#######.###.#.###.#.#.#.###.#.#.#.###.#.#.#.###.#####.#.###.#.#\n#...#.#.....#.#...#.#.#...#.#...#...#.#...#.......#...#.#...#.#.#...#.#...#.#.....#...#...#.....#...#...#.....#.#...#.#.....#.....#.#.#.....#\n#.#.#.###.#.#.#.#.#.###.###.#.#.#.#.#.###.#######.#.#.#.#.#.#.#.#.#######.#.#####.#.#.#.###.#####.#####.#.#####.#.#.#.#.#######.#.#.#.#.###.#\n#.#.#.....#.#...#.#.....#.#.#.#...#.#...#...#.....#...#...#...#.#.......#.......#.#.#...#...#.........#.....#...#.#...#.#.....#.#.#.#.....#.#\n#.#.#####.#.#.#.#.#######.#.#.#####.#####.#.#.#####.###.#.#.###.#######.#.#.#####.#.#.###.###########.#####.#.#.###.#.#.#.###.###.#.###.#.#.#\n#.#.#...#.#.#.#.#...#.......#.....#.......#.#.#.....#...#.#.......#...#...#.#...........................#...#.#.....#...#...#.#...#.......#.#\n###.#.#.#.#.#.#.###.###########.#.#####.#.#.#.#.#.#.###.#.#.#####.#.#.###.###.#####.###.#.#.###.#.#.###.#.###.#.###.#.#####.#.#.#######.###.#\n#...#.#.....#.#...#.#...........#.#...#.....#.#.#.#...#.........................#.#.#...#...#...#.#.....#.#.....#...........#.#...#.#...#...#\n#.#.#.###.#####.#.#.#.#######.###.#.#########.#.###.#.###.#.#####.#.#.###.#.#.#.#.#.#.#######.#########.#.###.###.#.#.#######.###.#.#.#.#.###\n#.#.#.#...#.....#.#.#.#.....#.#...#...........#...#.........................#.#.#...#.#.#...#.#.............#...#.......#...#.....#...#.....#\n#.###.#.#.#.#####.#.#.#####.#.#.###########.###.#.#.###.#.#.###.###.#.#.#.#.###.#.###.#.#.#.#.#.#.#.#.#####.###.###.#.#.#.#.#######.###.#.#.#\n#S......#...#.....#.........#...............#...#.....#.......#.....#...#.......#.....#...#.....#...#.......#...........#.#.................#\n#############################################################################################################################################\n"

#Day16.part1(input) |> IO.inspect(label: :day16_part1, charlists: :as_lists)
#Day16.part2(input) |> IO.inspect(label: :day16_part2, charlists: :as_lists)
```

```elixir
defmodule Day17 do
  import AOC

  # a b c = reg, m = prog map, p = prog counter, i = instruction, o = op, d = combo, r = output
  def sim(%{p: p, m: m, r: r}) when p >= map_size(m), do: r
  def sim(%{a: a, b: b, c: c, m: m, p: p, r: r}=s) do
    {i, o} = {m[p], m[p + 1]}
    d = %{4 => a, 5 => b, 6 => c}[o] || o
    case i do 0 -> %{s | a: div(a, 2**d), p: p + 2} # adv
      1 -> %{s | b: Bitwise.bxor(b, o), p: p + 2} # bxl
      2 -> %{s | b: mod(d, 8), p: p + 2} # bst
      3 -> %{s | p: a > 0 && o || p + 2} # jnz
      4 -> %{s | b: Bitwise.bxor(b, c), p: p + 2} # bxc
      5 -> %{s | r: [mod(d, 8) | r], p: p + 2} # out
      6 -> %{s | b: div(a, 2**d), p: p+2} # bdv
      7 -> %{s | c: div(a, 2**d), p: p+2} # cdv
    end |> sim()
  end

  # number of mismatch, 0 = fully match
  def eval(s, g, a) do
    n = length g
    r = sim(%{s | a: a})
    v = case length(r) == n do
      true -> n - (r |> Enum.zip(g) |> Enum.take_while(fn {i, j} -> i == j end) |> length())
      false -> n
    end
    #IO.inspect({:a, a, :v, v, :g, Enum.join(g), :r, Enum.join(r)})
    v
  end

  # s = state, g = output goal reversed, l u = lower/upper bound search range reg a
  def bs(s, g, q) do
    [{l, r, sl, sr} | t] = Enum.sort_by(q, fn {l, r, sl, sr} -> {min(sl, sr), -(r - l)} end)
    #XXX not monotonic decreasing
    m = div(l + r, 2)
    sm = eval(s, g, m)
    best = Enum.min([sl, sm, sr])
    ml = Enum.min(for {l, _, _, _} <- q, do: l)
    mr = Enum.max(for {_, r, _, _} <- q, do: r)
    IO.inspect({l, sl, m, sm, r, sr, ml, mr, ml <= 164541017976509 and 164541017976509 <= mr})
    cond do
      best == 0 -> Enum.find_value([{l, sl}, {m, sm}, {r, sr}], fn {_, v} -> v == best end, fn {k, _} -> k end)
      r - l == 1 -> bs(s, g, t)
      true ->
        q = [{l, m, sl, sm}, {m, r, sm, sr} | t]
        |> Enum.reject(fn {_, _, sl, sr} -> best < min(sl, sr) end)
        bs(s, g, q)
    end
  end

  def part1(input) do
    [[a], [b], [c], g] = int2d input
    m = for {i, p} <- Enum.with_index(g), into: %{}, do: {p, i}
    sim(%{a: a, b: b, c: c, m: m, p: 0, r: []}) |> Enum.reverse() |> Enum.join(",")
  end

  #TODO unsolved
  def part2(input) do
    [[a], [b], [c], g] = int2d input
    m = for {i, p} <- Enum.with_index(g), into: %{}, do: {p, i}
    s = %{a: a, b: b, c: c, m: m, p: 0, r: []}
    g = Enum.reverse g
    bs(s, g, [{0, 10**length(g), nil, nil}])
  end
end

input = "Register A: 46323429\nRegister B: 0\nRegister C: 0\n\nProgram: 2,4,1,1,7,5,1,5,4,3,0,3,5,5,3,0\n"

Day17.part1(input) |> IO.inspect(label: :day17_part1, charlists: :as_lists)
#Day17.part2(input) |> IO.inspect(label: :day17_part2, charlists: :as_lists)
# 164541017976509
```

```elixir
defmodule Day18 do
  import AOC

  def bfs(_, [], d), do: d
  def bfs(m, [{c, p}|pq], d) do
    {pq, d} =
    for q <- move(p), m[q] == ?., d[q] > c + 1, reduce: {pq, d},
      do: ({pq, d} -> {[{c + 1, q} | pq], Map.put(d, q, c + 1)})
    bfs(m, Enum.sort(pq), d)
  end

  def part1(input) do
    h = w = 70
    ps = int2d(input) |> Enum.take(1024)
    m = for i <- 0..h, j <- 0..w, into: %{}, do: {{i, j}, [j, i] in ps && ?# || ?.}
    bfs(m, [{0, {0, 0}}], %{{0, 0} => 0})[{h, w}]
  end

  def eval(ps, n) do
    h = w = 70
    ps = Enum.take(ps, n)
    m = for i <- 0..h, j <- 0..w, into: %{}, do: {{i, j}, [j, i] in ps && ?# || ?.}
    !bfs(m, [{0, {0, 0}}], %{{0, 0} => 0})[{h, w}]
  end

  def bs(_, l, r) when r - l <= 1, do: r
  def bs(ps, l, r) do
    m = div(l + r, 2)
    eval(ps, m) && bs(ps, l, m) || bs(ps, m, r)
  end

  def part2(input) do
    ps = int2d(input)
    bs(ps, 1024, length(ps)) |> then(&Enum.at(ps, &1 - 1))
  end
end

input = "32,7\n8,31\n21,29\n15,23\n51,57\n65,43\n59,45\n15,2\n63,39\n21,18\n38,1\n3,4\n22,21\n41,2\n35,65\n14,15\n57,57\n54,61\n23,7\n5,7\n16,21\n19,6\n53,67\n40,7\n25,17\n63,58\n61,35\n35,2\n39,65\n13,40\n11,4\n47,65\n18,3\n11,47\n40,49\n64,69\n53,61\n45,60\n23,41\n17,44\n17,21\n51,67\n58,51\n58,65\n13,49\n12,9\n43,5\n45,12\n11,28\n23,23\n37,5\n22,11\n42,11\n10,25\n13,47\n40,65\n21,24\n65,27\n46,65\n25,16\n41,62\n64,39\n40,53\n63,35\n63,45\n43,69\n41,59\n43,47\n49,51\n13,35\n30,63\n1,5\n52,53\n61,37\n37,7\n49,62\n18,11\n55,39\n23,27\n19,1\n49,65\n17,15\n18,33\n23,33\n29,5\n9,38\n33,17\n65,33\n64,37\n23,4\n70,69\n26,27\n65,54\n18,7\n12,31\n17,5\n15,35\n63,48\n20,41\n34,67\n66,61\n32,61\n47,67\n39,1\n60,49\n15,42\n15,28\n47,47\n17,40\n61,56\n12,1\n3,1\n7,5\n41,49\n1,11\n49,39\n33,64\n15,9\n49,58\n1,13\n17,25\n21,17\n11,1\n52,55\n29,8\n19,30\n51,49\n40,45\n25,25\n21,15\n62,63\n11,27\n57,61\n7,25\n55,49\n49,40\n22,35\n66,69\n13,25\n4,5\n19,43\n55,68\n55,47\n66,49\n61,60\n65,57\n3,13\n63,37\n49,45\n57,43\n60,53\n41,58\n28,3\n58,63\n7,9\n13,33\n51,60\n27,23\n5,27\n26,25\n25,4\n10,37\n31,66\n37,1\n21,4\n45,67\n59,62\n12,23\n59,46\n61,45\n21,38\n61,46\n53,66\n31,20\n37,65\n39,5\n17,26\n22,17\n37,59\n5,9\n69,55\n5,13\n23,36\n17,27\n12,37\n5,25\n40,9\n69,69\n67,69\n53,55\n19,17\n17,43\n37,66\n38,69\n69,52\n45,68\n67,63\n11,42\n55,50\n61,69\n27,6\n29,1\n29,0\n63,52\n41,9\n63,51\n19,40\n13,27\n2,33\n14,5\n8,25\n33,70\n13,10\n63,54\n10,17\n20,17\n1,1\n65,42\n20,27\n44,49\n23,35\n69,48\n65,68\n5,11\n9,34\n13,37\n63,63\n15,32\n67,53\n33,15\n43,9\n55,61\n11,31\n61,62\n61,51\n18,31\n60,67\n39,53\n39,61\n36,5\n10,43\n31,47\n15,41\n59,57\n34,7\n67,55\n22,9\n49,3\n61,63\n42,63\n67,64\n8,9\n61,34\n13,42\n53,43\n21,1\n58,67\n23,21\n67,45\n28,23\n16,35\n25,18\n46,5\n32,13\n42,65\n11,49\n17,11\n65,39\n16,13\n19,22\n59,37\n19,11\n63,47\n4,11\n52,51\n33,14\n59,38\n46,61\n5,12\n67,41\n39,66\n41,57\n35,1\n57,42\n11,39\n45,69\n5,8\n55,66\n55,55\n13,11\n63,59\n21,11\n27,7\n31,5\n45,49\n24,35\n26,39\n23,15\n68,49\n47,58\n47,56\n68,55\n57,60\n57,48\n55,51\n59,42\n51,64\n43,57\n59,47\n50,49\n30,21\n61,39\n29,12\n59,55\n47,3\n11,26\n55,67\n44,65\n66,35\n7,31\n11,23\n21,6\n9,4\n1,9\n7,29\n1,7\n54,45\n15,7\n23,11\n55,59\n65,55\n9,3\n19,35\n35,7\n9,40\n61,68\n69,42\n57,51\n22,7\n31,65\n8,13\n65,47\n57,39\n21,23\n65,37\n54,43\n13,26\n12,5\n15,37\n39,45\n62,49\n50,55\n59,63\n9,33\n45,54\n65,45\n43,53\n22,31\n59,58\n9,12\n14,21\n31,1\n65,69\n64,43\n46,47\n0,13\n15,17\n19,8\n9,15\n53,59\n12,17\n30,7\n42,67\n29,11\n60,43\n18,23\n23,25\n51,55\n53,64\n57,44\n37,64\n9,5\n11,41\n14,25\n11,6\n35,14\n19,23\n48,63\n65,35\n20,31\n53,47\n16,7\n49,59\n33,11\n67,52\n41,53\n69,49\n60,39\n29,10\n23,3\n37,60\n36,11\n67,44\n19,46\n19,9\n45,57\n8,5\n43,4\n25,38\n21,27\n23,9\n43,58\n6,5\n52,7\n31,7\n18,37\n69,63\n41,67\n9,23\n5,2\n52,47\n7,14\n26,21\n47,69\n45,8\n9,1\n38,7\n42,1\n52,67\n56,61\n35,54\n27,27\n33,20\n17,1\n30,5\n68,45\n62,37\n13,28\n33,56\n47,64\n21,3\n23,1\n1,3\n41,69\n3,3\n21,37\n19,15\n70,59\n45,65\n70,49\n8,29\n36,49\n69,59\n41,7\n65,51\n57,69\n61,36\n35,3\n35,4\n47,50\n13,17\n13,53\n14,35\n21,26\n11,30\n3,7\n13,15\n21,34\n40,5\n49,61\n13,51\n49,66\n41,50\n66,39\n68,61\n55,62\n37,55\n36,53\n41,0\n43,59\n13,7\n56,45\n7,28\n59,33\n61,43\n9,41\n67,43\n13,24\n29,3\n42,49\n59,60\n15,24\n13,29\n45,53\n26,37\n33,21\n21,7\n67,67\n63,55\n9,7\n14,45\n44,67\n63,50\n23,24\n11,9\n22,37\n18,15\n21,25\n21,19\n57,54\n17,37\n55,45\n17,7\n29,34\n15,36\n55,56\n44,61\n29,7\n11,13\n51,69\n15,1\n7,27\n53,51\n57,58\n33,8\n46,59\n57,45\n61,54\n25,11\n64,63\n69,53\n13,18\n55,43\n5,30\n65,61\n9,39\n55,33\n43,51\n37,68\n57,67\n39,7\n67,50\n25,3\n9,14\n27,2\n25,7\n61,59\n15,43\n3,11\n45,63\n19,5\n20,9\n49,55\n25,0\n33,1\n37,63\n17,47\n16,45\n66,53\n21,32\n69,65\n47,57\n33,69\n47,61\n44,5\n67,59\n15,0\n15,18\n9,32\n67,60\n17,33\n5,3\n51,59\n25,15\n1,6\n50,63\n59,51\n13,1\n29,4\n27,8\n45,47\n13,9\n35,49\n37,67\n63,43\n9,19\n67,65\n52,57\n57,41\n42,9\n27,10\n13,43\n69,54\n61,67\n20,3\n38,53\n19,16\n41,1\n0,9\n41,48\n25,1\n63,41\n54,63\n13,12\n27,5\n7,6\n16,15\n39,3\n22,27\n9,31\n9,25\n19,20\n24,21\n10,11\n61,55\n65,63\n19,24\n7,39\n39,69\n56,31\n31,2\n55,54\n33,57\n55,69\n19,21\n46,69\n15,5\n67,51\n47,68\n69,46\n53,45\n17,23\n5,31\n63,49\n13,41\n42,59\n65,46\n67,36\n53,69\n7,15\n7,22\n19,28\n43,52\n41,65\n9,9\n25,35\n43,7\n11,33\n53,63\n69,51\n27,17\n53,49\n64,51\n2,5\n48,47\n64,45\n57,59\n25,24\n42,7\n65,41\n40,69\n13,14\n55,70\n59,53\n55,53\n3,37\n7,35\n6,13\n61,49\n10,1\n15,33\n54,55\n63,60\n48,51\n26,11\n31,16\n61,33\n16,19\n10,23\n5,26\n59,56\n43,49\n43,67\n6,45\n49,63\n9,22\n15,31\n49,70\n61,47\n26,3\n15,19\n7,11\n66,43\n15,13\n21,21\n49,53\n35,5\n60,65\n25,8\n40,3\n13,2\n53,53\n69,58\n37,62\n20,11\n41,43\n20,43\n37,48\n13,39\n17,41\n39,58\n52,59\n49,57\n41,3\n61,38\n46,55\n7,33\n17,19\n39,50\n21,35\n21,5\n7,1\n37,69\n8,1\n43,6\n68,63\n12,39\n57,65\n43,56\n13,21\n10,29\n19,0\n69,67\n24,1\n2,7\n25,29\n11,7\n47,53\n43,61\n50,59\n44,57\n18,45\n49,48\n32,1\n57,47\n23,5\n55,57\n41,5\n23,10\n19,37\n7,10\n59,59\n16,25\n43,65\n16,5\n11,11\n15,22\n34,3\n51,56\n29,27\n35,69\n15,3\n63,56\n50,69\n69,47\n45,3\n37,3\n53,52\n37,49\n35,53\n57,55\n10,7\n59,65\n19,41\n17,4\n21,20\n24,3\n63,69\n21,9\n27,21\n38,3\n21,2\n41,15\n9,26\n32,67\n1,2\n7,38\n65,53\n69,43\n11,17\n6,1\n17,18\n56,51\n49,67\n45,61\n66,59\n61,61\n4,7\n5,5\n17,39\n24,29\n9,11\n4,15\n35,63\n3,19\n47,55\n57,40\n54,51\n59,43\n3,10\n64,47\n50,53\n63,40\n67,37\n47,54\n6,27\n22,1\n44,63\n9,27\n25,37\n15,25\n25,19\n13,19\n53,65\n67,68\n47,51\n3,2\n44,3\n53,68\n61,52\n25,9\n31,4\n17,29\n36,7\n62,69\n56,65\n17,42\n51,53\n30,69\n68,67\n49,68\n41,60\n21,33\n66,47\n25,6\n15,45\n15,30\n25,21\n68,39\n16,33\n32,17\n10,9\n11,29\n61,57\n48,57\n50,51\n55,65\n57,68\n27,19\n9,29\n24,19\n19,25\n19,34\n35,6\n59,61\n11,25\n66,33\n54,47\n57,53\n59,39\n32,5\n11,45\n18,19\n16,29\n63,57\n55,63\n27,1\n19,3\n63,65\n45,51\n9,13\n15,38\n2,9\n27,9\n12,35\n40,55\n15,15\n7,13\n46,3\n59,50\n13,20\n70,41\n47,62\n63,53\n24,9\n66,63\n34,11\n17,2\n36,69\n51,66\n58,39\n13,34\n64,61\n69,66\n69,35\n51,61\n31,3\n69,61\n67,58\n9,48\n25,23\n15,27\n63,61\n13,3\n7,23\n67,40\n31,11\n57,63\n59,48\n60,33\n5,1\n64,35\n39,52\n13,5\n1,0\n7,24\n11,15\n23,17\n9,16\n38,15\n69,57\n43,55\n18,13\n57,64\n13,32\n53,48\n8,3\n37,56\n45,55\n33,67\n16,9\n61,44\n7,41\n3,9\n33,5\n42,53\n56,49\n51,51\n67,38\n14,9\n15,29\n62,41\n58,53\n39,67\n17,38\n57,49\n69,45\n49,69\n15,11\n67,56\n39,4\n42,69\n47,41\n63,34\n15,16\n19,19\n69,64\n35,67\n59,69\n13,44\n46,49\n23,26\n54,59\n40,67\n62,43\n46,51\n17,10\n57,46\n14,7\n10,33\n59,70\n59,41\n39,51\n41,51\n16,41\n7,3\n67,47\n31,9\n15,39\n36,1\n60,41\n11,14\n67,61\n51,45\n23,40\n23,37\n27,35\n56,57\n44,9\n27,3\n61,41\n25,5\n17,35\n51,63\n19,33\n61,58\n59,67\n17,9\n7,7\n12,13\n20,37\n23,22\n14,39\n44,53\n67,57\n18,29\n17,3\n65,49\n58,55\n7,8\n43,46\n17,31\n13,31\n65,56\n8,61\n15,59\n41,30\n40,29\n5,29\n9,63\n54,23\n53,31\n39,20\n21,55\n8,55\n43,19\n49,25\n63,15\n53,14\n39,14\n51,18\n37,61\n64,21\n33,28\n55,23\n3,30\n65,10\n35,38\n64,25\n29,66\n27,68\n33,43\n49,34\n33,53\n28,21\n15,66\n51,44\n39,18\n2,23\n51,31\n35,10\n20,51\n37,37\n12,57\n11,64\n9,21\n47,45\n49,49\n7,50\n16,65\n46,37\n51,34\n62,17\n23,55\n7,66\n53,27\n61,9\n39,25\n23,51\n67,13\n53,28\n45,33\n45,17\n35,60\n70,19\n1,47\n11,37\n29,47\n9,20\n3,56\n29,55\n69,30\n69,12\n19,61\n4,47\n53,22\n63,22\n25,28\n11,20\n32,23\n38,25\n31,53\n67,16\n19,55\n35,17\n51,47\n43,41\n1,33\n45,23\n31,57\n28,19\n39,39\n37,35\n67,2\n61,53\n57,4\n31,30\n47,1\n33,41\n47,37\n35,45\n17,68\n55,40\n25,58\n27,50\n16,57\n52,49\n17,62\n5,21\n33,68\n17,57\n41,25\n25,13\n38,31\n48,45\n9,17\n31,15\n29,46\n59,31\n45,59\n11,59\n69,24\n68,23\n26,61\n19,69\n3,59\n24,69\n40,27\n11,53\n44,15\n65,13\n41,61\n69,1\n42,15\n27,12\n17,60\n53,25\n21,47\n59,28\n47,7\n53,9\n40,11\n22,65\n33,44\n7,21\n7,64\n19,53\n39,31\n31,63\n27,25\n49,6\n5,51\n41,17\n54,3\n59,7\n51,46\n40,17\n34,41\n43,40\n62,3\n69,37\n47,59\n40,33\n15,67\n23,52\n36,9\n15,49\n39,13\n27,52\n21,14\n34,33\n43,29\n23,53\n63,21\n55,26\n59,29\n20,13\n11,35\n26,31\n59,12\n5,15\n67,49\n67,27\n49,38\n47,23\n18,59\n30,47\n53,4\n43,15\n31,13\n2,37\n15,53\n55,15\n67,15\n30,59\n53,40\n50,39\n67,26\n3,43\n51,27\n4,67\n30,53\n1,62\n23,54\n29,24\n67,3\n1,59\n47,13\n17,45\n5,23\n67,9\n16,53\n27,41\n9,69\n64,9\n30,39\n61,17\n59,1\n61,13\n65,3\n55,27\n61,1\n33,37\n55,30\n20,61\n32,41\n38,17\n69,9\n1,19\n39,34\n43,43\n0,51\n1,57\n3,20\n3,39\n48,31\n15,57\n54,37\n37,44\n45,25\n61,31\n34,17\n53,3\n55,1\n21,67\n36,27\n26,17\n31,67\n49,41\n46,1\n32,31\n1,37\n69,28\n47,34\n50,29\n39,64\n67,23\n9,61\n59,13\n26,35\n30,35\n59,35\n55,25\n23,12\n46,23\n9,37\n35,47\n11,63\n15,48\n5,55\n23,47\n35,41\n35,57\n26,33\n25,47\n61,27\n39,15\n25,46\n47,21\n12,61\n48,41\n7,42\n35,51\n5,34\n51,24\n70,15\n48,3\n5,43\n5,62\n21,50\n1,68\n29,31\n21,43\n11,5\n47,5\n61,25\n35,15\n53,23\n57,31\n69,33\n60,23\n21,61\n53,1\n53,6\n38,59\n44,47\n57,28\n58,1\n27,54\n51,65\n69,21\n32,55\n28,63\n46,7\n29,13\n7,62\n51,9\n1,51\n1,49\n38,45\n7,55\n23,50\n5,57\n63,20\n1,44\n49,27\n46,45\n16,59\n21,62\n26,53\n31,21\n37,31\n4,23\n63,29\n14,61\n5,39\n42,35\n65,30\n23,63\n29,43\n51,30\n7,58\n31,55\n11,62\n23,67\n19,49\n54,13\n39,36\n63,23\n6,47\n44,27\n2,15\n14,69\n29,45\n32,45\n31,19\n29,44\n43,63\n65,15\n3,17\n23,31\n46,27\n43,24\n69,15\n25,49\n45,21\n5,41\n52,11\n57,26\n5,58\n37,45\n42,41\n22,49\n43,45\n67,39\n50,13\n45,16\n43,1\n43,20\n13,61\n37,21\n11,54\n45,43\n19,47\n55,17\n58,13\n11,3\n49,24\n1,63\n67,8\n3,38\n57,1\n22,41\n2,35\n68,5\n34,35\n37,41\n33,13\n6,21\n25,65\n39,12\n29,14\n35,11\n69,5\n26,65\n39,27\n61,3\n35,59\n24,63\n42,55\n24,61\n65,65\n70,35\n19,63\n67,33\n57,22\n41,16\n3,48\n19,29\n62,5\n31,39\n33,46\n16,55\n41,41\n11,51\n7,59\n5,68\n69,3\n22,45\n10,59\n45,45\n5,49\n29,42\n23,49\n4,25\n7,51\n51,1\n65,21\n67,19\n58,35\n36,31\n57,25\n17,13\n3,41\n67,7\n11,66\n32,51\n69,4\n18,55\n46,35\n53,11\n27,59\n18,49\n54,17\n43,39\n23,59\n19,7\n2,65\n32,63\n25,43\n13,57\n54,33\n22,67\n3,32\n2,27\n34,51\n38,21\n62,11\n35,29\n51,16\n49,43\n35,25\n65,24\n39,29\n32,35\n58,21\n63,25\n14,55\n67,25\n26,47\n45,5\n61,23\n69,39\n6,55\n47,17\n62,65\n29,57\n49,33\n64,5\n3,27\n33,55\n55,37\n67,21\n13,52\n29,67\n60,11\n68,29\n52,27\n3,50\n69,41\n5,69\n56,5\n67,17\n48,1\n61,0\n9,59\n55,11\n33,59\n41,11\n49,7\n39,63\n11,61\n39,62\n27,39\n3,18\n33,35\n6,53\n45,7\n36,47\n47,19\n55,3\n31,45\n19,45\n21,69\n28,31\n35,64\n51,12\n6,49\n53,34\n1,17\n30,57\n45,27\n43,17\n1,69\n53,32\n69,7\n34,23\n52,43\n13,60\n49,29\n5,65\n28,59\n5,56\n59,3\n60,17\n29,65\n41,24\n21,64\n59,14\n41,39\n63,3\n61,65\n17,63\n27,29\n27,56\n1,39\n55,21\n27,53\n67,5\n25,45\n57,17\n24,33\n2,49\n66,25\n7,57\n35,40\n5,35\n5,70\n61,5\n3,42\n61,20\n51,39\n57,11\n1,15\n46,41\n29,19\n50,9\n39,11\n69,10\n7,43\n3,29\n25,32\n4,35\n18,69\n59,27\n42,25\n9,36\n55,13\n51,7\n66,29\n63,13\n7,63\n0,31\n64,19\n53,19\n19,56\n15,56\n47,25\n67,12\n29,49\n43,37\n1,29\n10,67\n41,42\n52,9\n59,11\n15,61\n43,27\n57,37\n37,47\n4,29\n52,37\n9,47\n18,53\n38,29\n43,44\n27,51\n25,59\n51,33\n38,23\n42,43\n65,23\n25,63\n55,8\n67,29\n25,27\n62,29\n5,61\n49,17\n55,35\n1,23\n61,24\n17,51\n1,40\n37,12\n35,27\n10,49\n63,32\n63,31\n21,68\n65,31\n53,17\n57,16\n22,57\n27,13\n52,41\n53,7\n4,53\n27,57\n53,13\n54,27\n17,17\n25,39\n44,39\n44,37\n61,15\n9,55\n41,37\n45,11\n31,61\n10,63\n11,67\n20,53\n39,43\n21,31\n65,18\n55,24\n31,43\n49,5\n1,66\n27,61\n59,5\n18,63\n48,5\n57,5\n25,66\n67,31\n27,66\n23,45\n21,60\n39,57\n29,36\n55,20\n15,65\n57,3\n32,53\n37,9\n46,15\n59,17\n31,41\n46,25\n66,1\n45,20\n18,65\n35,20\n29,29\n48,11\n33,61\n3,62\n19,31\n53,18\n27,37\n39,55\n1,65\n53,24\n10,19\n1,45\n28,49\n29,63\n23,39\n65,4\n30,43\n54,19\n16,69\n9,60\n55,5\n51,42\n46,31\n31,69\n17,52\n27,65\n68,17\n65,7\n1,58\n41,55\n61,11\n27,49\n49,19\n7,52\n42,13\n39,9\n7,17\n3,44\n68,31\n65,66\n58,9\n63,33\n51,3\n13,45\n23,19\n63,1\n16,47\n51,4\n33,26\n51,37\n47,49\n59,19\n7,20\n65,19\n60,5\n25,41\n53,5\n4,51\n37,43\n67,1\n19,65\n69,13\n27,15\n57,13\n63,28\n38,47\n29,9\n61,26\n19,13\n56,21\n63,9\n33,49\n55,41\n49,16\n25,69\n37,13\n19,27\n59,21\n33,39\n25,14\n24,47\n54,9\n28,17\n57,32\n49,36\n57,21\n57,27\n25,51\n31,32\n51,29\n17,69\n48,25\n57,23\n35,16\n35,55\n51,35\n53,29\n61,7\n1,31\n69,11\n10,41\n41,19\n9,53\n21,13\n67,22\n13,68\n69,26\n3,28\n53,33\n37,53\n15,69\n6,43\n47,33\n30,27\n5,53\n21,53\n38,41\n7,61\n28,37\n65,14\n35,24\n21,41\n69,17\n51,21\n27,48\n36,19\n49,15\n1,12\n35,37\n57,2\n19,59\n11,2\n34,57\n33,51\n39,23\n39,41\n66,9\n58,7\n1,43\n35,43\n3,5\n57,29\n67,35\n23,58\n21,51\n3,53\n5,60\n59,9\n49,1\n63,17\n29,33\n41,36\n21,59\n44,29\n37,40\n64,27\n36,57\n33,29\n7,67\n49,21\n31,22\n5,18\n19,67\n11,69\n59,15\n27,60\n37,33\n1,52\n36,59\n41,20\n51,19\n47,29\n38,33\n29,17\n60,1\n21,39\n9,67\n31,48\n63,2\n0,25\n69,19\n16,63\n47,28\n48,43\n25,67\n53,39\n30,51\n51,17\n47,15\n13,64\n52,15\n44,25\n32,39\n9,35\n29,59\n45,1\n29,37\n3,15\n2,17\n45,44\n27,31\n35,46\n56,11\n11,65\n22,43\n35,33\n55,9\n35,21\n1,27\n65,11\n48,21\n33,36\n14,63\n2,25\n5,67\n50,1\n65,25\n51,32\n19,39\n59,49\n27,42\n43,31\n9,54\n47,11\n15,63\n41,38\n39,38\n25,12\n61,29\n59,25\n29,32\n28,45\n48,19\n45,19\n42,37\n3,61\n53,57\n3,47\n1,41\n25,55\n5,33\n39,49\n28,53\n9,49\n50,35\n27,45\n45,29\n11,70\n25,44\n53,15\n24,39\n47,9\n49,30\n27,33\n60,31\n53,36\n53,37\n33,47\n7,69\n30,15\n1,18\n39,28\n37,39\n13,55\n23,43\n37,19\n43,11\n29,41\n45,10\n49,12\n41,45\n33,38\n41,31\n23,56\n8,45\n0,35\n35,23\n49,14\n35,31\n48,27\n35,19\n41,35\n29,23\n19,42\n41,23\n65,9\n55,16\n42,27\n55,29\n3,46\n29,39\n9,57\n21,58\n11,50\n20,65\n35,9\n21,63\n35,35\n41,46\n3,67\n15,21\n43,13\n29,15\n7,68\n33,63\n3,65\n21,57\n61,19\n69,31\n32,11\n49,23\n6,65\n27,69\n37,11\n37,50\n13,69\n29,61\n22,15\n62,9\n49,44\n9,43\n46,13\n39,37\n7,36\n37,25\n31,59\n52,21\n1,25\n30,55\n28,27\n31,37\n3,21\n59,10\n63,27\n20,45\n51,23\n8,17\n9,45\n32,33\n53,30\n39,17\n67,6\n37,57\n62,13\n4,21\n30,29\n47,39\n25,57\n51,15\n36,15\n35,28\n62,31\n33,45\n26,57\n20,69\n48,9\n53,35\n51,43\n39,59\n63,19\n15,51\n63,16\n60,3\n2,55\n34,55\n42,31\n11,46\n5,16\n43,25\n60,7\n3,33\n43,23\n33,23\n24,49\n3,51\n8,57\n45,34\n1,21\n3,57\n36,41\n27,55\n31,50\n24,45\n23,57\n43,18\n41,21\n0,57\n31,12\n8,47\n61,18\n27,43\n7,19\n19,51\n39,56\n57,9\n36,33\n24,67\n35,52\n15,55\n64,31\n25,52\n65,29\n45,22\n24,55\n7,53\n11,56\n48,15\n33,31\n5,59\n69,23\n47,43\n43,33\n63,66\n4,65\n46,29\n1,55\n3,58\n3,60\n5,37\n38,9\n4,55\n23,29\n51,11\n55,19\n53,21\n51,2\n17,55\n63,7\n25,42\n31,35\n51,13\n5,63\n36,43\n17,65\n65,17\n3,35\n48,37\n33,3\n65,6\n50,27\n17,53\n27,47\n50,19\n17,50\n59,23\n54,1\n35,66\n23,13\n8,35\n27,11\n45,31\n31,27\n37,29\n1,67\n26,69\n3,25\n64,15\n33,33\n43,22\n9,70\n67,11\n57,19\n6,31\n35,61\n19,57\n5,36\n9,50\n39,32\n31,49\n47,63\n5,40\n57,14\n11,43\n13,13\n14,51\n3,55\n6,33\n45,42\n35,30\n15,47\n13,67\n65,5\n66,17\n31,51\n25,31\n41,27\n56,29\n33,27\n70,1\n33,9\n59,18\n59,30\n11,57\n49,9\n26,41\n3,45\n30,17\n1,60\n31,25\n32,59\n6,39\n49,47\n64,1\n57,33\n27,67\n13,59\n39,47\n29,68\n17,59\n20,57\n11,55\n35,39\n28,15\n49,13\n31,10\n7,37\n13,58\n47,18\n69,29\n50,7\n29,35\n51,5\n39,19\n59,36\n58,25\n43,3\n33,7\n43,34\n35,62\n46,39\n3,31\n51,20\n13,46\n66,21\n27,63\n37,22\n69,27\n12,51\n31,29\n28,57\n3,23\n3,63\n4,39\n17,49\n7,49\n46,19\n21,49\n40,25\n8,43\n69,8\n52,1\n41,47\n29,62\n67,18\n29,26\n63,67\n47,27\n22,29\n68,11\n69,20\n59,4\n67,14\n45,13\n54,5\n9,68\n61,28\n29,69\n57,35\n6,17\n2,53\n33,25\n53,10\n41,22\n45,35\n36,35\n35,26\n9,65\n56,35\n23,61\n29,21\n37,36\n13,48\n1,38\n57,24\n66,27\n1,61\n29,40\n60,25\n25,53\n31,33\n47,35\n0,43\n44,17\n33,65\n40,41\n58,19\n69,32\n9,58\n41,33\n57,7\n57,15\n45,32\n61,21\n57,6\n39,35\n1,46\n5,45\n14,59\n55,7\n17,67\n39,33\n31,24\n29,25\n45,15\n21,54\n55,42\n31,23\n8,65\n15,50\n31,17\n25,33\n15,12\n65,1\n37,23\n23,65\n9,51\n49,11\n7,45\n13,65\n13,23\n45,41\n43,12\n33,48\n25,61\n33,42\n0,21\n43,35\n2,69\n45,37\n23,60\n44,1\n41,63\n61,14\n11,21\n23,64\n65,67\n49,35\n63,11\n1,35\n51,25\n13,54\n29,53\n26,63\n49,37\n30,19\n21,65\n56,9\n41,13\n62,7\n47,8\n13,63\n43,32\n24,15\n5,19\n64,13\n47,31\n37,51\n35,18\n13,66\n65,59\n36,37\n32,27\n56,15\n55,31\n34,61\n39,21\n37,26\n37,15\n28,29\n38,43\n45,9\n35,13\n34,21\n10,45\n34,49\n19,48\n50,23\n31,31\n53,41\n3,22\n51,41\n12,47\n65,12\n69,25\n19,66\n43,21\n3,49\n41,29\n55,12\n3,64\n37,17\n69,36\n3,14\n49,31\n23,69\n5,47\n63,5\n29,64\n45,39\n11,19\n9,52\n68,3\n7,47\n61,22\n57,34\n47,22\n4,43\n3,69\n55,38\n21,48\n33,19\n1,28\n30,37\n26,23\n5,17\n33,58\n25,30\n7,65\n37,27\n29,51\n21,45\n67,34\n1,53\n17,61\n56,37\n62,66\n20,30\n50,58\n15,26\n36,2\n42,12\n28,51\n38,66\n42,17\n66,6\n12,54\n10,15\n12,49\n9,28\n59,52\n47,10\n47,16\n60,68\n46,17\n26,40\n40,51\n38,4\n2,59\n16,18\n65,64\n25,68\n0,64\n23,0\n64,70\n47,44\n0,7\n45,52\n68,65\n19,44\n54,50\n46,10\n19,68\n21,36\n13,16\n40,66\n48,53\n13,70\n29,58\n31,52\n58,50\n1,48\n2,52\n15,60\n36,26\n19,64\n8,40\n46,68\n68,64\n40,68\n58,20\n4,70\n36,70\n48,23\n50,56\n5,22\n51,40\n14,47\n19,26\n19,36\n30,25\n70,27\n63,62\n64,12\n22,10\n56,12\n69,16\n8,4\n70,46\n14,37\n6,7\n4,58\n2,41\n47,52\n39,60\n52,23\n26,22\n51,6\n67,4\n33,66\n38,2\n18,18\n14,50\n24,64\n2,18\n15,64\n48,46\n60,60\n26,14\n0,54\n52,66\n44,46\n38,55\n19,32\n7,18\n68,41\n23,48\n18,48\n28,24\n4,24\n46,48\n24,27\n23,66\n26,56\n62,56\n58,38\n44,55\n12,64\n42,6\n49,18\n36,54\n40,26\n43,60\n12,66\n32,42\n32,29\n28,65\n56,46\n58,61\n25,26\n8,28\n16,68\n63,10\n38,63\n50,61\n54,68\n8,18\n32,30\n52,25\n11,36\n36,45\n52,64\n56,32\n52,40\n22,60\n68,13\n41,26\n11,68\n7,34\n39,30\n6,22\n62,53\n19,38\n70,38\n18,62\n15,62\n59,68\n11,58\n20,22\n50,34\n54,11\n29,28\n3,36\n40,34\n58,66\n4,6\n14,33\n60,18\n34,52\n58,15\n34,46\n70,43\n36,38\n16,66\n36,4\n48,22\n70,40\n10,50\n10,47\n45,48\n48,18\n52,30\n6,70\n43,62\n54,41\n23,28\n28,10\n36,28\n38,56\n12,50\n36,30\n50,60\n67,42\n58,57\n44,41\n17,36\n65,60\n24,44\n46,33\n2,58\n23,68\n0,46\n10,58\n34,66\n28,16\n51,58\n22,28\n4,16\n51,54\n54,25\n32,58\n46,4\n48,24\n55,48\n17,32\n4,37\n36,52\n38,58\n4,8\n27,70\n8,60\n46,24\n43,28\n11,32\n27,62\n7,70\n39,40\n53,58\n23,38\n24,28\n52,42\n30,61\n40,37\n16,64\n34,56\n64,60\n8,51\n4,14\n62,25\n64,40\n10,0\n10,38\n35,56\n50,10\n46,66\n26,68\n50,42\n24,50\n2,14\n55,2\n67,20\n0,59\n14,49\n55,60\n50,68\n44,48\n13,36\n24,22\n14,41\n0,47\n36,65\n62,62\n34,43\n50,18\n7,32\n46,70\n69,22\n32,49\n3,6\n13,62\n28,28\n52,13\n52,3\n29,38\n12,56\n53,26\n20,20\n38,62\n32,56\n21,46\n38,5\n57,10\n38,68\n52,52\n10,56\n16,2\n34,58\n14,0\n51,0\n63,64\n62,42\n0,16\n40,56\n10,46\n16,54\n28,64\n48,50\n61,12\n12,65\n12,22\n52,12\n40,62\n56,53\n54,32\n68,15\n16,4\n36,29\n49,4\n62,15\n50,31\n40,0\n18,41\n18,67\n56,69\n3,8\n70,42\n10,60\n28,61\n35,48\n56,17\n0,34\n40,24\n14,26\n12,52\n37,58\n18,42\n56,48\n1,22\n62,61\n10,62\n60,54\n12,43\n8,62\n14,31\n22,47\n52,26\n44,43\n25,62\n33,34\n24,46\n28,11\n30,64\n50,38\n29,60\n52,63\n26,62\n34,20\n28,8\n45,0\n57,38\n18,26\n28,9\n24,48\n70,31\n24,38\n36,36\n36,24\n54,38\n2,20\n12,42\n41,18\n26,29\n0,53\n38,67\n28,30\n17,22\n5,38\n16,43\n40,42\n34,19\n0,60\n48,66\n8,20\n64,65\n62,68\n27,22\n52,65\n54,34\n1,54\n12,14\n55,58\n16,51\n6,37\n22,33\n2,66\n14,3\n40,20\n44,20\n41,4\n30,31\n62,52\n22,61\n38,60\n18,52\n26,13\n0,18\n26,64\n0,14\n36,10\n70,33\n52,28\n57,12\n4,12\n12,44\n50,26\n31,26\n6,64\n11,0\n54,40\n55,14\n41,28\n20,33\n8,19\n23,32\n48,56\n56,55\n8,22\n19,58\n65,26\n34,70\n66,64\n6,62\n29,30\n29,20\n38,70\n54,35\n2,54\n46,54\n10,14\n36,62\n54,46\n56,25\n4,36\n55,64\n21,44\n41,12\n57,30\n36,48\n59,64\n18,51\n46,18\n11,60\n62,55\n4,56\n12,69\n20,24\n26,15\n50,2\n54,66\n66,30\n26,32\n2,43\n17,48\n30,42\n16,70\n30,38\n58,23\n20,67\n30,20\n42,28\n56,19\n10,24\n16,34\n32,60\n65,62\n14,65\n44,16\n22,38\n1,24\n64,34\n28,55\n68,12\n13,8\n45,66\n26,67\n59,24\n12,48\n5,48\n53,46\n36,61\n36,46\n56,4\n26,58\n50,4\n53,20\n60,37\n15,58\n36,25\n54,49\n1,42\n30,62\n7,0\n54,54\n14,56\n34,54\n0,10\n11,48\n31,36\n68,40\n34,60\n37,42\n39,24\n32,25\n38,48\n2,29\n32,44\n50,5\n43,68\n31,28\n10,70\n48,55\n46,67\n43,66\n18,46\n2,70\n14,48\n26,60\n12,34\n34,59\n60,19\n46,14\n55,52\n61,4\n70,25\n8,24\n24,37\n0,37\n25,70\n50,33\n22,20\n36,67\n19,62\n20,66\n66,46\n10,44\n31,18\n56,47\n38,51\n36,23\n18,57\n52,19\n1,14\n38,34\n14,12\n54,60\n41,54\n46,58\n18,22\n29,56\n66,14\n70,3\n41,32\n70,10\n54,10\n44,21\n49,20\n58,60\n20,2\n62,22\n52,48\n56,16\n40,8\n27,46\n44,44\n31,14\n38,14\n54,0\n52,4\n30,0\n20,50\n2,56\n14,66\n24,40\n25,54\n25,34\n48,6\n60,42\n34,6\n58,3\n42,14\n54,56\n10,48\n18,28\n15,20\n58,17\n66,42\n31,46\n10,26\n61,66\n24,60\n2,44\n32,54\n8,58\n44,45\n60,6\n65,38\n34,4\n22,26\n18,14\n62,19\n26,16\n0,42\n65,48\n61,70\n53,54\n24,11\n42,23\n52,46\n56,20\n24,52\n47,14\n22,59\n26,46\n38,19\n27,24\n1,10\n53,56\n54,70\n70,2\n2,30\n46,34\n22,42\n8,7\n14,2\n39,8\n6,54\n62,8\n30,14\n66,12\n3,54\n16,32\n64,56\n4,41\n60,10\n10,68\n56,60\n60,64\n0,63\n50,20\n30,24\n50,64\n14,4\n32,18\n24,32\n4,57\n65,36\n17,64\n48,13\n14,67\n25,2\n56,30\n19,54\n22,6\n70,45\n68,54\n70,58\n10,10\n50,44\n62,59\n37,24\n36,16\n68,25\n9,64\n10,18\n68,10\n62,47\n66,19\n52,38\n42,21\n69,14\n30,49\n36,21\n6,8\n44,68\n6,34\n38,13\n40,31\n10,8\n66,62\n60,22\n18,21\n24,10\n37,14\n10,39\n61,10\n6,28\n54,7\n60,35\n6,4\n58,2\n68,33\n50,37\n15,54\n39,44\n9,56\n59,8\n45,38\n30,28\n49,64\n55,6\n18,16\n26,52\n35,70\n58,27\n59,6\n22,14\n69,0\n63,0\n29,2\n28,13\n43,38\n53,50\n10,61\n20,28\n1,32\n20,29\n50,70\n53,70\n56,0\n68,35\n62,21\n10,65\n14,10\n26,24\n52,68\n43,26\n52,34\n20,49\n2,19\n66,11\n34,39\n69,38\n51,14\n20,70\n30,32\n21,22\n60,40\n69,18\n41,66\n18,40\n45,28\n18,0\n7,40\n10,5\n16,48\n30,41\n30,50\n58,12\n22,36\n46,8\n28,44\n64,20\n65,58\n14,54\n25,10\n67,24\n35,50\n46,32\n50,16\n62,39\n36,58\n70,0\n4,33\n60,16\n30,34\n12,18\n8,14\n46,63\n68,57\n70,47\n44,32\n22,22\n4,45\n28,42\n40,46\n36,14\n62,35\n16,14\n56,24\n23,70\n48,29\n56,64\n12,20\n40,58\n61,42\n25,20\n38,30\n2,61\n34,64\n24,31\n10,13\n28,58\n14,70\n66,45\n39,48\n20,56\n35,58\n45,62\n6,9\n52,22\n63,36\n10,27\n63,30\n40,4\n24,4\n24,14\n65,0\n70,56\n50,3\n33,32\n37,6\n12,55\n44,35\n52,17\n49,60\n16,1\n63,24\n20,6\n4,42\n10,66\n66,16\n34,68\n60,29\n27,40\n44,60\n34,63\n45,36\n68,6\n70,67\n16,16\n3,52\n0,17\n7,16\n44,70\n4,3\n50,12\n54,52\n60,32\n18,61\n68,16\n46,40\n43,0\n16,3\n22,18\n56,58\n44,24\n70,13\n18,70\n44,56\n61,32\n9,10\n46,52\n28,35\n58,14\n60,69\n65,34\n52,29\n39,2\n38,61\n22,3\n34,22\n38,36\n39,16\n70,18\n22,25\n4,28\n60,36\n60,26\n56,22\n31,64\n51,8\n43,30\n4,9\n33,54\n1,56\n44,28\n65,70\n61,30\n53,2\n67,0\n3,12\n60,15\n61,40\n18,58\n34,31\n28,4\n18,24\n27,36\n30,30\n22,55\n6,20\n0,33\n50,6\n16,67\n2,39\n55,22\n37,2\n31,62\n60,63\n2,46\n64,22\n52,58\n62,58\n24,17\n52,20\n64,28\n12,60\n0,26\n58,30\n2,47\n27,30\n62,26\n14,1\n50,40\n64,0\n51,52\n62,44\n68,70\n44,4\n42,18\n70,61\n30,10\n17,6\n0,39\n58,43\n40,36\n19,10\n66,60\n43,70\n6,26\n32,37\n0,15\n9,30\n40,38\n28,22\n4,4\n56,41\n22,30\n2,10\n1,64\n60,14\n57,50\n45,26\n12,46\n6,50\n20,60\n21,10\n42,4\n36,63\n12,19\n19,18\n59,54\n36,6\n32,22\n38,38\n38,22\n4,61\n45,2\n62,46\n54,62\n0,61\n26,10\n21,8\n6,44\n13,22\n56,36\n56,34\n10,2\n26,66\n16,40\n51,68\n66,20\n28,56\n40,54\n54,18\n8,0\n64,64\n63,42\n58,70\n70,28\n2,2\n37,54\n28,39\n4,38\n47,20\n62,51\n22,69\n68,26\n46,16\n66,40\n48,12\n29,54\n20,32\n50,0\n70,60\n68,66\n18,27\n63,26\n8,12\n69,70\n30,6\n58,10\n44,62\n58,56\n46,2\n50,50\n"

Day18.part1(input) |> IO.inspect(label: :day18_part1, charlists: :as_lists)
#Day18.part2(input) |> IO.inspect(label: :day18_part2, charlists: :as_lists)
```

```elixir
defmodule Day19 do
  import AOC

  def count(d, ps) do
    cache d, do: Enum.sum for(p <- ps, ^p <> t <- [d], do: t > "" && count(t, ps) || 1)
  end

  def solve(input) do
    [ps, ds] = for s <- String.split(input, "\n\n"), do: String.split(s, ~r/\W+/)
    for d <- ds, c = count(d, ps), c > 0, do: c
  end

  def part1(input), do: Enum.count solve(input)
  def part2(input), do: Enum.sum solve(input)
end

input = "buu, ubg, gub, wbwu, rrgrgg, urrwr, grwb, ubw, ubrbr, ubgb, gbw, rbrwgw, wbrr, brg, urugggr, wgbb, uwwu, urgg, wwwr, wrub, rbr, brgwb, gruwwb, rrwuwbu, rub, urwwgu, bbbw, wrr, uwr, grr, ggwrb, wbrwwbur, brbg, rubrg, urwbbru, brwww, bu, gugwww, rbww, buw, rurwgrug, rugwr, ruubww, bgbu, bgbw, wuu, burw, uuwb, rug, grw, bbrugwr, wurwbg, uurwu, bgu, ruu, bgrg, uguub, bgug, burubb, ubuugb, bbww, grbrr, gubbww, gwbgrwu, ggu, bubgurub, wguu, gww, wuuu, wbgb, bgrw, gug, rwwbw, uru, rwr, ubwr, uwb, bubwbwbw, gggwr, brr, gbrrg, rrww, gwg, uurubb, ruwwgrw, brgrru, gbgrwb, wbbwgg, wuwr, ruwuwbw, ggwrr, gbu, gwr, uur, wbgu, gbwgbgr, bbb, bubu, rwwggw, ruw, rbwuw, ugbbrwu, uurrgrg, bwwubwwg, gruu, ubgwu, rww, bur, ubwrg, wgb, gurbbr, rgbr, wuw, gbwuwru, rgwbrg, wbbr, wr, bgrrgb, wwb, urgwubww, bwurw, ur, rgbu, rrurw, ubbu, ubur, wrbwwr, uugww, grg, rwb, rgb, gguggu, rwgr, gurbubg, guwwr, wwbgb, grbgwruw, wug, bgb, rb, ruuubggr, www, wbgg, gguu, bbur, gbub, bwg, uuugbw, brb, brrrggu, buwu, rbrg, bg, bwgrbw, bwb, u, guw, gwrwur, brgb, wrru, ruugu, wrgrg, wbrb, rg, buwrr, ugr, uwru, bub, wbb, ubr, brrwr, wgbuu, bguu, bubw, ug, ugwg, wurbww, bwrbuwu, wwuwb, brbubg, wwub, g, brw, bbrwrgb, bgr, rbuwb, gwur, bggg, gbuu, wbu, rubw, bguug, bbw, wuguw, uwbwrgb, wwwub, wwbugg, gwubbb, rugwg, rgwwbru, ugbbubr, wrrgr, bubg, wwbwu, wbw, bbr, wbggugw, wurw, wwgwgr, burgr, wbgbu, wwwuuw, buguu, gwrugg, wwgugg, bburg, urwbu, rrug, ggb, ggbg, rguwbu, guru, wwr, ggurrw, brbbbubg, bbguuwgw, rru, ugwu, wbggr, rgrbww, rrubw, ubwurwg, gbr, rwrgw, wwguwbu, wggrr, wru, wrgbb, bgburwg, wruwwg, uuu, rugr, rwbw, bwwbr, bbbrgwu, br, ubb, bbu, urg, brbuggb, uw, rbug, wbbrgugb, rgu, uubgrrgw, bru, rwgbu, wrgw, gwb, bwbr, bgw, wgwg, wbgrwwg, wwwwgr, gg, gwgggu, ugwuu, gugur, gggbw, bwbwguu, uwbr, gw, wrgg, rugwbgg, uwg, urb, uwggb, urgggb, bbg, gwbr, uub, gbg, gwuu, buwrrw, rbu, wbbu, ru, rbbw, rgugrbwg, ggbgrw, ugrwwww, uwgbwu, wwbw, wurr, wrwrrr, rrw, rbb, rwrgr, bbwwg, rbg, bbbgrbrw, ruubwb, ubbg, gr, gwwbuuuw, bwgr, rrwwggu, bbuugb, guwwbg, rguw, rur, gwbbbbr, rbwr, wb, uuwrbb, uruwbrrr, bb, bbubu, gruguu, urr, bwbrb, rbru, ugu, ugg, rwbgu, rbbuug, uguw, grwbg, bbgrrr, gur, urw, gguwbb, rburuug, w, wg, ggw, wur, ubwuw, bwggugb, gwbu, wbrg, gbrgw, wrugur, rbgb, uwbrrubg, bbugugw, rwbgwur, ubwu, rw, wurwggr, gru, brur, gwbuw, uwu, gurbb, rgbgr, bgg, rggg, rrg, wbbg, wwu, wbr, uww, ggr, wbwgu, rrgu, rgw, rrwugrg, wgug, wrw, rbw, bug, bruuubrb, rubwurr, rwub, bbbru, rr, gwu, ubbgwg, gbww, wwrgrgg, wbg, rwu, ugurw, bubwg, wbubw, urwur, wgu, ubuuug, wubu, rrb, rrru, bwr, rbbubbru, gbwb, ggrruw, bww, uu, wu, wwuww, gwguwbb, ubu, uug, gubgr, rwggb, ubwug, wrg, r, wbwgwu, ww, gggw, rubrw, ugw, wgg, buguurwr, grb, bwur, wgr, uubb, wuwbwrb, urbwr, bw, ggg, bgrgr, buguwr, rbgbg, rrr, wgwbrr, rgg, rububg, bwu, ub, gbb, wub, uuw, wgw, bbub, wbggbb, wwwbgg, rgr, rbbbu, wuwb, grubu, rruwu, gubu, urwu, wrurg\n\nwuuwwuwubwggbgggggwgurgwubwwrbwubgrbuubrwwgwgbbwugw\ngwbwwrurbbgwuubwwugbrgrrwrgurgwgggubbugb\nbugwwguwrbbgrbguguurbrrbwubbbrrwrgbguwrurbgwbg\nbugwgguwrwbrggwugwgguwrwrwubrgwgwrububwrgugb\nruurguwurrwbgrrgwwbrrwgbrrbrbwwurwruuuuwbbbuwgggbugb\nbgrurbguuurrgbgggrggrbgwbbwwguuggrwbwrgbgrrbugbgguwr\nguggrwuugwrbbrwrubbbgwrrwruururgwubwwrbguugb\ngrugwgrgwrbuwwruurgwwwbrbrbwrurbbwrrubuwugb\ngbwrgrgbubugggrwuwbugrrrrgurbbwbbgbggguwruwuubrurwrg\nwuwbbgbrbruuubrbwwwugwbbwrugrwruwggwbbwbbuurbgr\nrgbrbwugwrrgggbruuubruuubggrrrrgrbrgrwwrgrrgg\nguwuggggurwbwugwgruwubwrubbuwbrwurwubugrburwuwbw\nbrbgwugbgggruwwugbwbguuugubwgrrrrruguwugubu\nuggrbbbuwrggbgwbrbwggugwbrgrbwwwbrrbrbrwguwbbuugug\nwurububrurruguubggbubbgwgwgguwbguubbwbwwwbrrubuuruuubbwgur\nrrbbrbrwbbrrgrbbrugwggrwbwgwrrwwggugrbugwbugbbwrwub\nggwubrwrbwrubuwwrbguubwrrbbbbbrruuuruwbbrrbubgr\nbrgubwrbbbrrrbbggwuggrugrggwbbuuwwwubwbggwwubbrgw\nwbbwurbrbgbrruugbbgrbubuuguwuruubbbgurugwbrubr\nbwbbuwwurbwgrubuurwwbrurwrbwggrrgwgrwggubruburbgrrg\ngurbuggubwrggugggbwuurbgbgugwguwrbwbgwgrgrgb\nrgwbuwrgurwbgubwurruugwgwrbuwrgrbrurrurguwwwrugb\nwrrugbguruuwwrbrrwbrggwrwrgwwuwrwbgwgrbwguggwbwugb\nrgbubguwbrwuuuwrbgruuwgrrrugugbbwrrwrrgruuubruggwrbrgubrw\nuguwgwwbubgwwwrugbururbbugugrwgbbbgwubwggbburwubwuuubgu\nbbwrgwbggwuwggwggurrrrbgbbgwurrwrgwuwbuggbgrgwwuguubrguuugb\nwbbrbguggurrbuuwbbugrwrbgwuguubuguwbrgrurgbbrbgruwuwwrugb\nuwgrbwuuwrugubggubgubrgrgrrwgrgbrbbwuwruwgbbgwubwww\nbuwbgggwwrwbuuugwwbbugrgugurrrrbwrugbruuuwbwrruw\nugrurwbgbwrbbgrwwgrwbugwbwgwrbugwgggugugugwrgugb\nwuwwwwbubgwwrwwuuguggrggrbggbwbwrbwuwubrgrr\ngugbwbuuwugwuwbrbwuguggbuurruwgugbbwbbwbrurgrrbbwrgurwgg\nugurugrubrrbgwrubgwrrwgubbwgurgwwugrwbuwrbwrubbuwrggugg\nbubuwuggrbugburbwwbbwgwbbbwwgubgugugbrurbuubbgbrgbbgb\nwugbgwubugbbrrbgbrrwgbwuuububwuwgrugububrburbuu\nubrubuurwgbrrrbgubbgwwrbgwwbgbububbbruwwwwgguguggrgggugb\nwubbwubgbwrrrggrubwbbwwggguugrgwgrwbgurgurgbuwuurbrbgwu\ngbwbwggrwgrurbbwwrbruwrguwgggrbuwrbbururrwrwrrrwwwwwburbwu\nubgbrubbbgwbguburuwuggggbgrwbbguruwrrwbruggugwwuwbb\nbbbbgrbbbbbgbwrurbwbwruubrbrgwrbgwwrgbruwwgwururguggbb\nuguwbubguwrgrbgwgwbuurbuwrrgbuwbuurruwuggububu\nuwurbbuguwbwwgwurwwbgwuwggbwrwbgrrrrbuwruwbrbgguuubwggrugb\nubbrwrbrrbgbrgrrwuwgrrwurwrbwubwbwggguwbwww\nbrrrggwrgwruwgwwuwwwwwwbwbwguwbwwurbwbuggubbrgrugurugu\nurwbuuwgrurwgrgurrgbbwguwrgugurrwbwrwrrbugbwguugb\nwbrubrwubgruurwwwgugwwwbwbwbgbuguwgbubbwgrgbrgbrbguwugwbrb\ngbguugwwgggwbbbbbbwbguugrbrguuwuwwrgbwbgggw\nrbbrrrbbwwbugwbbgbubbrugwbbrwwbruuwubwrgwbuwrrbwu\nggubwggwbbuwbwbwuwgrwbwrbugugbwuwrrugruwuurubbbw\nubururrguubuugggubgggrgrwwwwgbgbuwrbggrwugrgbguu\nruugbuwwbbrrbwurgguburrbgruugugbguwwrubrwuwrrwuuugb\nugbgbbrrbrrggbwwgwwubuwwuggrugurbrbwgrgwburrrurgggwbugb\nguruwbrrrrrrbbwwwruwwubrurbgggwugwruuurwugwwwrgbuwgwwwugb\nurrbbrbrgwwrbgbbbbgbwgruuwuwgwwbwwwuguuggbg\nubggggbbuurrrbruuwwbrwugrbbwrbbrubwwruggrrwwuuuggw\nggbggbwguurugggwgwwgurrrgubgwrruguburgurwbwuurubbgrgwbbrww\nguurbugwuubgugrwurbuuwuwwuruwwrgwwwubbbbuubgbb\nggugwggurgguurwgwwrburwrwwbgwgwbwgwugwubrbuuwubugb\nbwuwbwgwrwububgrbgrgwbwbwrrubuwrbgwgurbrwuwubwugb\nubgbgggrrggrgrrwbrubrguuwbwurrrbbuuurguwubbuwguurw\ngruurubrugrgggurwgbguwwrbwwrrwwrwbgrrugwrrgrggrurggb\nrbwwgbwrwbbgrbuggrubgurggwbrrguuurbgrbgrrrwwbugb\nruwugwubgwwgwruwwwwuurrgbbwbwwwrbbbggwubgbwuubrwbuubrggbw\nbwbrrrrwurrrbgggburgubwubrruwwwrrgwruugb\nurwwwbggugrrgwuwubbbburbugrguwubrbwbwwugb\nbbwrrwugugbgbbgbrrrrrbuwwuuuwrgubgwbwubrburwubwrrgwwurwbr\nbruubrrrwbruruurgrwbrbguwuwwrgrbbgbrbugggbguuwgbbub\nrgrburrwuruwrrgruruuubgrrrrwrubwwbwbbwbgwubuugwbgbww\nrwwgrrbbwbguurwggrurgwgwwgbbubrwgrurggbggurbbugbbrubwruub\nrugbguwubggwwrugbbuwbrwwwuuwbgrugrrrgruruwuuurwugwgrgubruugb\nbbwgbwwruuguuuggrgwrrwrugbggrbbgwrggrrgbgbguurrg\nwggbrguwbbrbbgwugbbgubrwgbbwgurbgwwrguruubbrbuwguwrrwgrugb\nrwgrrgwwwwwugbwuwgurguuwubwbuwrgggbrrruwbwugb\ngwrwbubuwurrubrrbrgbbggrrbugurrwwwruwubwubwuubwrgr\nwwrbwggwguwwbuwuwbrgrbwuuwgruurwrgbgwrubbgubwbrrgwrgugb\nwwwwugwwuwurrrrbwuuuguuwuwuwuurrrgwrwrrwwgbbbrwrrrubgu\nguuguwggwruwgwbuwrrwbbwrbbbbburrbuwbbrgbuuug\nuwuwurwwgwbgwrgrgugwgrbwwbwbbbuggugrbuuwggwwbguuwgw\nrwrrbwbgubbbwbrgwubwgbwuwwrrrwbugggwwwrbrg\nbgbbwurrrruwguuwwwgubwrwwgurrwwguwrwgrgubgubururrrrugb\nbwugruwgwbwbrrbbuwuuwwurwbrrgugbbubguwggggwwurrwb\nrrwuuwurrwwgwwwbuubgrruugrgurwuuwbggrbbwwug\nwgugrwuruwwgrbugbwbgbrrruuubggrbrwubwwgugrwbbrrbugb\nwrwgwwubuwbgwbgwgbubuwuwwwrubwuuwwwwwrwugb\nbrggbuwgwrgguwgwgbrwwuwuuugwgbwwwrgugwbwwwguwuuubwu\nrrwuwburwgwbburbrwrgrbrbgbgrrrrrwgrggwwggrrwuwrr\ngwrrrgrwuruwrbrbbbubgrbgrugrrbbrwgrgbbuugbbbugb\nguwuuwrgbbgrrubwwuwbgwrwwbguwrguguubbuugrrubwwbruwrbw\nwbrrbuwruuuurggurrbgwburwwgurwbrwrbwuuuwwrrrwwgubwgruwrbwr\nrrwgrugbbgwgrwgrburugubuwrububuuugbugugbbgbrurwgrugbu\nwrgwbwbggruugbrrruggwbwwugrguruubgwwgwwwubbwwwwuruurwuru\nbwbrrrbwugubwggrgbuwrbubgubrbbbgwwrgwbrrbu\nugbrrrgbbgrwrbwbwwuwbuuuwbuwuubbgwwurrrubwugggugbbgwrg\nrwgrwwbgwugbwrbuwrwwwgwwbrwrugurwgwbbguwbgruwrggbuubgrwuugb\nurugurwbrrwrruwwrbuubruugurwbrbrbbruururbwubuuugwgggwgugb\nugggugwrwwwuubuubggbbuugbgguwrguubgrrgwurrwwuwubguurrrgugb\nrubrgrrbuwuruwgggbuuwbwubwugggbgguwbwubbbruwwgwwbbbbu\nuwbwgubrbbwgbugwggurbugrbwwwgrwubuuubwubwrw\ngggrggwbwgbbwuuugwbwwubguububggruwububgwwgbwbrrwbbbwu\nguuurwwbbuwgguuwwruubuurgbgwggrrbwwuurwbgwwbubbbgu\nbbgbbrurwrwbrwwbuguggwwwguwuubrrgruuwgururugububurrrb\nbuwbrrubgubwbubgbrrwwwbrrggwrwwgwbruuugb\ngrrbggubwggbbbuwggrubrrbbbggrbuuugbrrrurbbwbb\nwugggrrubwruruggbrbwrgwwugbwwbwbuuwwrbubggbggw\nrggugrbuggrwubrwuugrrugrrrrugwubguwbwwugb\ngrbrgbwrwuugrrbugrugbwruwrwbbggbrwurbuubbwubrgbbgugb\nruurubgrbgrwwgrwrwgwbwuggwwbbrgbgrbbgrugb\ngwbwgubgggbgrrbgwuwrrwwgbrbbbwwgubugrrbwgbgbrwgw\ngbrubwggubwruwwrrwbwrrrwuurwrgbubrrubbbugrbbwu\ngwgrrbwwgrubwrrrrwwrgwrgwgbbugrbrrgrubwgruruugbwugwuuubugb\nrrrwwubbuwuurrruubwbwugrwbwwgurbwwrwrruuguubbbbubbggwugb\ngrwrwburgurbrwuuubgrrgwubwrbuwwwrbbwrgrrrubrwwgrrburwbbw\nububgwuurwruwbwuburbuurwrgwrrguurbwgwwggrwbbugggr\nrgwugbgbbbbbrrbbwwgwguuwurbwbubwwgwwbbgwgbrbgbrwuuuw\nbgbbwugbrwuubuwrgggruuwubbbbgbruguugwrwrbu\nwugbrbrbbwubgbrrugubwugbugrwgubbugbwggugwug\ngbbbwguuwrruubrbgrgbwgubbbgggbbuwwbruugb\nbwgbrbwbbburubbbwwggrwbuwbruguurwruurgbgbrgww\nrbgrggruugbbgwbwuggbruuuurgwbbgubbrbbubgruwbuwgwr\nwgwugguuwubggguubbruugggrrbrrbrwburwrrggrgubrwbbbb\ngbbgwuuubwbrwwburuwwruubuwgwuuwuwgwgurbgrrgbb\nubwgbgwggwwbuwwwbbggbbbwuubwrwggrbbgrrugwr\ngwugwgurgugguwubgbrgwgwbbwbwbuwwwbwugrbwugwgrrg\nrgbbbwruubuurruwbgugggwubwwuwgbbugbbrrrbrwgrrgbr\nuwbggrgrbuwbgwbrurwgbrbbbubgrwburrggwbrbuwugrbwrggub\ngwuuwgwrggbwrrbwwuruguwbrwbgwuggwrgwbuubuugbbrggw\nugbwbrrbbwugggrwwbwubbwrbgrwrrwgbgrgurrurrwbg\ngggwbrggubgwgwrgrrgurubbguwrbwwurgbwrurubbwbrbgrbwrbw\nruwwgurbbbguurgrbwwwgugbbrbguggbrwuurwgwbrr\ngrgugrbwgbbrrugbuwubrgrgbwururggwrbrbgugb\nbrurggwbgwrbbugwbgggwwbwruwbgbgbubgrgbwbwgwbgugw\ngrrggguugwuguugrrrwwugbguugrbbubbrugrubgbgbwururbwbrguurwugb\nwuubwubwgrgurwurrwbbwgbwbgugbwbbbwggruwubgrgbgubb\ngburuuwwwwrubrwwurwgwbbrbuuuwgrrgurgwwwgwgugbwgug\nuruuwbwbbrwwrwruwrgruwuurwrgrguwwggggbuubbbbrrgrruugb\nwrrrbubruuwggbguurubrbuguwurwbgbrrbuwurwbwggbwgrwrbwwuuggugb\nggwwrbgrgrgggbgwuwbgbgwwrrwburuwwgwbggrwgruuwwbwgrugubrru\nubbbbgbugbwuuggubbwrugrbgwwrruwuwggwwuggbwguruw\nrgurwrbwuuuubwggrbuubwwubwwgbubgwugbgrgrurwuwbrwrbbgurgugb\nbgrgrrgrurbwrbrbruububwuwgububwgbwwwrugrgwr\nubbggubwrgwgwwbbbwbbrgguubrbwguggrrguguwgbgg\nruubwgbgugubbrrrbgrbwwuwwwwbgrbwwugrruwwrgbruwwrbugb\nbururubguggubwrurgbrurbubbuwgbwggrguwgggbbubugb\ngrgrguuurwuwgubgrwbbwrwggggbguburrwbububrgb\nwubbwugruwbgbwbrubrrwggwwwubbgurwurwubuggbrruuurrrugb\nwubgbwguwbugbwgwwgrrbubgubgwrgrbgwruwgbwubbggwgwr\nbwwruugwruuruurgbwwrwgrwruguugruruggrrbgugrwrrrrbbgwururugb\ngurruwbwubrurwbuwruggurrgbubwwggwbubgwbbuw\nbwbggubwbbwbwgwrbwbrrgurugbrbrbrbwwrurugrwbggugu\nbwgwgrgwwguuwrwgbuurubwgbgbrwwwgbugwrbwrrggug\nubugrwguuuwrrgbgbggwgbbbubgbgbwubwggwggrururgwr\nwgwwbguwwrburrrwrwwuruugugurbrbgubbgwrrrbbrrugrbbubbb\nwbgurwrbrgwburwrguurrggugurugrbrguwwrrbgruwgbwgrgwwuwgg\nbrrrggwugbbgrwrwrgbbrgbuubwguuwwrwrrrugurugw\ngbubbgrgggbwuuwwgugbgrwbrgbbwwbgbuurwgurwbgbub\nggrugwugrwuburugruruwwwrurbgwbwrbwgbuggwggrwwwrburguurgugb\nwwrrwrruwwwwrurwurrbbrgrbbuuurbwwbguwwwbgrwggbwr\nubrbuurbrwbgrbrwbgubbbrrbrburggburbwwbggrguwg\nugwrbwuwrbgrrubugwbbbbrbrbwuuruuwuwbrwbgguwrwgr\nurwgwwrubrrwrrwwbbrubggrbwrbwgrrbwgrgggbbubwrwwwwguguugb\nubbugwgbwwruwruubwugburwurgbrgwwgbgubbgburrbuuwrbrwurggugb\nrwbgwbruwbguwbrwwburrrrgggbgwgbggrwuwuwbrwgwbggugb\nguggbuuggrgrwwrgrwguwggrbwrbggwwrbgrwbuwrwrgbrwww\nbgwugwubgggwwbuuuwgwubuugggbgbwurwbrgbuurbbb\nwggrrrgrbwruugrgbbguuwgwgwgrugrbgubwggbugwwrgwrgrugb\nuwguuwurgrbwggwbwrubbwgbwrwurwrwuwbwguuuguwuuug\ngrwuwrgwbwbrwrbgggrbbwburbgbuwggrrrrrgbbwgu\nugwrwbwgwrggwwgrrgubgwgrgwurgrwrrbururbuurrwgwgugugb\nwgwggrbrrwbubwurwgubguwrubgwbbrgbbugugguruwbbggruwuwgwwugb\nugwbgbrgrurrurbgbgbruwrbgbugggrwwgrubugggwubbwu\nbbwugrggrwggrwwrugwuwbbgbbwurbgbgrrguwubwbrbrguwrruugb\nbbwggrwwbrrubwgbubguruburwbubbrwwruwrbbbgrburubruruwurwwugb\nwwgurbbwrwrwrubuuwuwgwrrbbwgururbrurbwwggwuuwrbbgrwrgrbg\nwbwbgwgrbrwrugbgwbwgbbgbgrubrrrbwruguugwrb\nwbburwwbggbbgrrbbwwrruuwrrbuguwugwwugbwgb\nuwwbwbuwrwrwggbwrbbwgwrgwwubbwbugbwuggrwrbugb\ngurwgrwwwgwggbubbubrgwwbbwgbwuwbbgwwbrrgbbu\ngbgburbwbburbrbrubwwubwwguubwguwguuburubrbbrrbruggg\nubrbwggrbwururguwubggurbbbrwwrgurwwururuugwrrbbgwburrwrugb\ngrbuurwbrbruugubrbwggbbggbuwruubgwubbrwgbwbwwwgwugbwgrgrb\ngbuugbbwggrurbwrbuwugwuwuuwbwrugbgrbubrbubrwuw\nwrwggugbgurrwbwrgbwubrurbwwgggbwgggwgbgubggrbuwwugb\nwgugbggggbrgrbbrwbruubrrrrggbuwgrwbrbrgwrrwbgbgwuuugb\nggburgwguwggwrbugwgwurgrbggwwwubwrgrugbrugb\nwgubururrugrbbubbrbwwubwuruwwugrubuguwburgubrrwwbbbgbbgwg\ngwurwgwugbugurgubgubuguurwurrbburrbubwwbrwgub\nbwguuugwgugwbuwrwrrwrrubrggrwbbrgugbbgwrguwuwruwwugb\nurrrubrwbwgrgruuwwgbubrbubugguwwgrbwrwuwbu\ngruubbbubwrrrgrbwwbuwbwbrwrubgrrrurgwugbbbbbwggubwug\nugbuwrruwrbbwggbrrgurwggwwgrubbwgwuwwrwugb\nrbrrwuwrrbrguuwuggwbrrubggwgrgwrrwrgbwgbgb\nrbggwgwgubrwbbrgwrwwbubuwgugwrwrgrrgbugb\nwwuwurrbrubbbubgggubwuwbrrrbrgbrwwgrbwurugbugb\nuuubuugggbwwgwrguruwuubbrrguwwuubwwubbbubggubugb\nwbgwbubwbwbwwbrrrwbwrwwgugurrgbbubuuwgrrgbbwuggubgug\ngrwbbrwuwgggbuwgwugrubwubggrgbwbbugruwugrugu\ngbrbwggbbgbwwrwgruwwbwrbbuwburrwbugbbrbubgguugb\nbrbwggbgbwgurwubwguuuugurwbgbwgggubwrubggurgugrbwggrub\nugguuwgubgubrubbbbgwgbuguuubrgrbrbrruggbugb\nbwwbgwruwrrbruuurwugwwbbrurguwrguwrgwbugwguuugbugg\nbbwuwrrwgbgbbwrwwrgwrggubggubuwurugugugwrrwbrgwwguuw\nugwubuguurwrbguruwurrrrgrggrugwguuggwgruwwbbwuu\ngwgwgwbwwrrrbburbugubbubuugugbwuggugwuubrwrggbrbgurgu\nrrrubgggbgwwwbbrrrgubuggbgwrrubgbubuwrggwruuwbuuuwurrw\ngwgrgbrgugbgguwbwubugwrgbrrrgrruggwgwbwbwwurbubgrbgwuw\nuuuubuuwgrwbwbrgwrwwuubwwgrbwrugugwwrwwgrurb\nwugrrgrgbuwggwuuwwbrrbrwbbwbgwuruuwurggugwrwwwug\nbguuwubgrrbwrrbgrubgwburwbwguggwrbbrurgbgrguwuwbbbgrurrbrugb\nrwurgubuwwggrwrrrbgrbgruwgbrwwuubwurgwrwbb\nwrbubrrugbgggburubruubgrugrwgbgwguugwwgrubwbrrguwgrug\nuwugwbuburwgrgbrgggrrrgbbggruubbuurgwuubwwgwbrbruwgg\nwbubuwgbwbwwbwbbgbbguuwgwugrruurbwbbrbggwuburgruugwwrb\ngrgruggwgwbbrwrwuwwwuurrwurwwwwrgbrugbuurruwr\nurbgbbguuwgrwbrgrggwuwurbugbgugrurbrrrrrwrrgrgubw\ngwwrwwwbburgwggburruwugubwwwguuruubugubrwb\nwggggguwguwrrrbugbbgrbwbugbgurrbgugubuubgwuwwburwugb\nbguwgrwuubuwgwurgbrgugrwbrwbuwgurggbgbugb\nwbuubbwruguwuburwuwwrbgrgrrgbbgggrbrbwuwrgguu\nugwwbuuuwwwwburuggubbrbubrurbrrrbwgbgugb\nubggurbruuwgubgbrggugbbbbrbugbuubrrrbuugbrgwurgw\nuugbgugrbruugugwggwwrrbugbgrwbwrggrwwrbuuwgb\ngwgugwbugugwgrgbrbuuuwwbbbbrurrrurwwgwuuugb\nguwrbggbbwgrrwwwbgrgbgburwwbuggwggugguwbrugb\nguubbgubwurbbrbbruwrwbugruwuwuguubugugrruuggbgwgwwuggwugb\nbguwbrrgrrrggurwrrwurwrrrbrbuwrurbwrgrrrubug\nggbgwrrbgbrgwubrbrgrwgrurwbgwbuwbrgbrugrwwwgrbbuwwurubbgw\nbbuurugwggurgwubwbbwgwgrbwuuwgbggurgwwbrbwuwuwbwb\nugbbuurubuubggubwruubbgwubggbrggubgwwbuugwuwbrwgbwug\nbrrggwbrburrwbwrgrwwubbwbbrwuguubugwrgugwugggugb\nwuwrbggbrrrbrgrggbgburrwggwgwgubgrrgbubrggbgbbgbwugb\nbwbwbgbugbgwguwwwbwwwugbggwwguwrbggruwgbwguwguugb\nrbgwwggbwrwggugurbgrbgrgrgbgrrbugrggrwwugb\nuugurugggugwwgrrwbuggbwgruwrbbwwrguwbbbrwrrgwruurbbuwugrwu\nrgggwgbbwguwwwugurwbuugrwbrururwburburbrurrwuwgugrurwwurrg\nugrwwubgrwugwburbwruwgrbrgrgwwbubrbbgwwrgugbwurubggguugb\nubbwubbbrggugrbbrrrgwuruugbuggubgrbwwbbbwbggwrugb\nbuwgbbbbwugbwbruwuwgrwubbuwwbgggwguuwbbugwuugb\nuugrgrwgugwbwwgbwrrbuwwuuguwurggggrwugwuwbbuugb\nurguugrwuwwuurubuurbbwugrbggrgrgwwguubwwwrbbugb\nbwbwrbbggwrggggrgruwwuwwbuwrrbggrgrrurwggrgbbb\nbwbrwwrwwgrwggubwguubrgwbburwgurwbgrruugb\nbgggubwubwbwwbuurbrgbwbuurbrbgwwgrgbwwwrwwrbrrbbrggb\nurugbruwbrbgbbwbguuurruggwruuurrwrubbrrubbrwwwrggwwg\ngwwuggwbuwbbrubgbwgburruwgbwbgbbrgbwrugbbbwugbbuuwbrubrbr\nwbgbuuguuwwbuggwrruggbwurwrrrubbwrruurburrwbbbuurwu\nbgrgbruruuuugwrwuggwuwrbwgrwrbwbwbbuwbbbgggwwuwwgugb\nuwggubrrwuruwwuwwuuwubwbbgbbuuubgwbwgbwburrbrbuugbgguur\ngrgbubwurbuwbbrgugbwuwwuwwrwbrugbrwbuugubbr\nguuwbuwrwwurubrggwurubbuwgrrurgwwugbwgruuguuugb\nwbbwwurwwwwggrrwbrbuwbbrguwgwwrubwrgggruruuugwuwbru\ngwggururwruuuubgrrrgggbguwbrrruguuwbbgguggurr\nggbrruwgggwrrwggurbbubrbbbbgbgwwgggbuugrbrwwburggb\nwbubwgurwwgrgwuruurgwbrrugruwbugrrbbgwrguruwgurrwuwb\nrgrgbgwrrrgrbgbbwubgrggwwruugbbuurrubrbwbgbwuurruurugrugbr\nbuwubbrwgbwbwruwrbrbgrrwrugbggbrbbbwbbgrwwruuuuugwgrgruww\ngggrbrbuugwgwgruwuurwuuggwwbwbuwgwggrgrrburuwguwbbrbwwub\nbgwwuwgbruuuwwgwwugwrbwurrgwubgwwrggbrggwuubgbrwugrbg\nrugwrurrggwwwbggwrrubrburbwrbubuwbrwrwwbuwugwuburubwugb\nugguuwrwgrbuugbrbwbugbbgwbwwuurgruguuugurwuggwwugbwwb\nrbwrbbwrwuwrwgwuuwwrubbgrrwrbwuwwuurugwrugb\nbguwgwgbuguurwrbgrgrbwgwwgugwwwwwuuwbrbrgrugb\nrwgwwuuuwuuuuwwrubugbwuuubrurgbbbgrbbwguwbrrubgugwg\nbwbugruruuwbgrgbgwwbbrrguubuubgugwwwwuwrgrbuugb\ngrgrgrwrbwuwwbwrrbgburubrgubrruurbbbgrrgrwubr\nurburrrbrrgrguubugrwgrwbbgwwwbbruuubgwguburrwu\nrwggbgwguuugubbbbrgggbuurgrugrbburbbwruwwuuwwbwbwwugb\nrubgbrguggrwwwubrbrwburrwgwurrbubwrwwgrrwbbbwgr\nuwwbwbwuwgrbrbbrwbwwgruburggbrgwwgrbrrrburgrbbbub\nwrgwrrwwwbgubrbrwbwbwuwuurwubggbgubrwrrbbwwbgbgrrbwwgrugw\ngrrgwgbggbgbggrwgwurggurrggwgbwuwrbgwrubrg\nwuwgrrbbbrwwubrubwrurrrggrbgwbgrurgwgubuwubrgbbbuguugb\nrwgrgbgggbuwurwrbrrubbrrbrbwgbrgrwwguwgurrgggurbuuwgu\nbbwbbguwugrbbbbgrbrwbrggbuuurbgwgwgugbuwgwug\nrrrurububrburggurugurrubwgugwguwrbgbbggbwgw\nbgubrruugrwuugggwwbuwrwwugrwggbgwwwwwggrrgbubbgrgbgr\nbbuwburbgggruuwbuuwwbwuurwbuugugrgrgruwwwwb\ngubbruurbggbwuubruubugwurgwwbbgubrbwgrwwrggrguugb\nbwwgrrurwggugrguuwgrbwuwbuuwwgrrwggbuububgggugggbubbbgur\nrugrubwwbguwuwwwurwbbuubwwwuguwgurbubrggwrrubrrrrbwrbggb\ngwbuuwgrrgguuwbgrbgwruwugburbrruurgrurbwbuwrrugb\ngbwgwgrrgwrwwrbbwwbggbrbgwrwwrwrgwggrrrbgrwbubgurg\nwuubrguwbwuwugwurgbgbwgubwggbbrrurbwguurbw\nbugwwbrgwguwruuwgbguuwbbwgbgbburbwburbrbrrrbgrbw\ngrwbwggwrbbbrgwbrwrruwubwbgbrwbgbbwwrwggwgwwuurgwurwgggrgugb\nuubgrwggrbubruuubrbrrrbggbgbbruugwwuwgrugurwuwwrwguggbugb\nruwgugrggwuugrugbrwrbggugguggrggrbwuburbbbgrr\nwrububurgbbrgwrgbuguguwwbrbgbwwwwgrbbrwbugb\nwuuwurwbrwrgwrgrrwububrggwgbrrrbgburwgugb\nrgrrguwgwguubwrbruwugrwurbgurbbggbrwgubwbu\nugwbgrbbbgwwrgggggrrbwurrbbwwgguwrwgwbbugb\nbgwrwrgwbwbwrggwuwbggrwwguwurbrggrguuubggwwwrurbuwwuugb\nbbgwwbbuwguggggwbbugbuuururbrwrrububbbbruugbgrrrbururrwrugb\nwbrwbrwgrgwrwuurguubrwguuwuubwrwwgugbrbrbbwbruwgrwwuuwuggw\nwbgwuurbwggurrrbugrbrugbguruwbwgubgbguurrbrwguwrrwgrbw\nrubrrbubgbuuugbbgggrgrgggrruruuwwurbgrugbwrrbgubugrwgwrbrb\nwugwrwwrbuwrggbugbwruugwgwbbgggwuruwwrgurbbrgrr\nbrrubrwbbbrgbuwwguwgrgwbguuwrwrbruwwbrgrgwbugb\nggwrrbgbwgrbrwbbrrwggugwuurrgurgrbgurwrbbubwwuwrwwugb\nrwrrbgrrwbbuubburbbwugwugwgbbwwbuwubuwguwgggrwbuugb\nwuuuwuruwbrrruwrrbwwwbbwrwwugurbbwgrwrguubg\nuwwgbbrgurbwggwbwwuuwuuuwbgwwwrwgwrguggrgwgrgrwwgbbrurrrgg\nbrgwbbrgrrrrrwbwgbwwgruuubbbbwrugubggwgwrwruggugbgw\nrubgwrgbrwrwbwwbrrwrbrrwbwuurugrgwbrgrgubuubbubg\nrwrbwwwubgbwbubguurgbwwbbwggrgggbrrurwgbbbwwbrubbggrbg\nwuubgrrbrrgrburuggbbwruwbbrrwbwgrwwbwbggbbubbbugb\ngbuwbrruuwwwwwbrgguruubrbuuuubgwrrgugrguwwuwwg\nuurburbrugwurruwbrbgggwwubgwuwuwggrwwbbrrrbwbrwggbrg\nuwruguwwgwwbuwugurrbwguwurugrwrugrugrrgwuwugrb\ngrwrbrbgwgwwrbwubbwurwrbwgrurbwgurubrgwbgruuubguuur\ngbugrwrgrbrrrrbbuuwubrugbgbgwrrbbuwgwwuwruggwgwwwgguurwguugb\nbbrbgrgrbguurgwuurrgwuurbrgwrugwbrgwbbuwgbubrwugbggb\nbrwwwgruggguuwbwgbrbgwbrwbbbuggbubwrbwwruwbgrwgbrruw\ngwrgubwgwugrruwwrrugggbugurbubuurbwurgbbwgggwggwrub\nuwbuubrugwubbbbrgurbrrugwrbbrbubrwgbbbrurwbuugrbgwwgugb\ngubgbwrbruwwgrwggrrbgwwbgurgbwubgbrwbuwrgrrgg\nwwgbrgbubrwrguggrugwuwwwwwburgwrbgggguubwwurwbgggwru\ngubruugrgrggbgbbgbubgugwbrrguwbgurrrwrgbgggwbrubbubbwggbgugb\nrgubguuurugruggrguuuubggrwbgbwgbrbrburugwbwuwwuwgbw\nruwbuurburwwgububgrbrwbbbrggrwrgrrrgugrubgrgwwgbgw\nuwurrrbbuwbgrwugbwgbwbrrwrwwuggwbbuuwubgwbwwugb\ngubguruubbrrugburbgrguurwrrurwbbuwgrrrruuugrwgrwrugb\ngrurrwwbbuwwrwwrrrugbwgbrgbrugrrwrgwggrwbuwurgb\nuwrrgubrbbbwbggurrgbbrggwuubgrbgrguugugbwrgbwgbbugw\nwgurrguubuugburrwbggbrrbbbwbgwbrwbwgurgrgururgbbbruwuwb\nwwbbrgrgbubruuuwuurugrruwbuubwrgrrrbggurwurgurrr\nbrbwwbguuugurruwguwgugbbgrbrgguwruuuuwwruugb\nrrbgwwwwwwbrguwbrgwwguwrurrwbgugggbggbwgubrgbubugb\ngrgrgwbrruugwgbwguwwwbwwgrwugbgrbbwrrwgrrbwrbwwgwwbbw\nbgbugrgugugrugrgruuurwwrggbggwrrwurbbgggbwwwuwggwrgrgrb\nuwwrrgrbbwuuruwgwgggrwwrgwrwrruruwbggugrguuugbrrwrbrrgwb\ngburgwwgbwbwurbugurrgrruwubbububwgrrgwwgbuugb\nrguuwbururbwgwubbgrgbgrrwrwbuwwwwuggrbwrguub\nbbugwgugrrbugbgruwrugwwwbbwurrrurrgrgwrbwuuugb\nwbubbrggwwubruuurwrubrggbrgrugurwwugrbuwwgugb\nwggrwrwwburrgbwgbruuggbuwugwruugbwggrwrbbburwwbbugb\nubwubuurrruugrbwggbgugrbgbbubbruwugbburgwugb\nuugwubbbubwrguugggrgugrgrwbwrwrgbbbgbggburrrbggbrwwbgg\nrwuubwwurruuwrwbwbbgrwbbgbbwurrggwugguwburgwwbuwrbu\nugwbgbrwwrguubgwuwrbgurwggbggrurbuwruwgrbrgbbgb\ngrugwbgwbubgurubbrwbrwgbrrbbwubuuwurbrgruwu\nwuwbbbwwwrbrgugwrwrwbwrrbubuwwgbbgurgwbbbuubugugwuggruggw\nrrrwwgrbburwrgbwrwbwuwuuguggubrurrrgrruruggwbwgwubuwu\nrrrgrrrrwwrbwugbwwgurwruwbgugwrggbbgwbugbugb\nrrwgruwgbrwurrrrguuubbwuuuruurruwgbrgbwubgbbggrwbbwww\nrgbugugurwgurrwuuuguggwggrbrbubgwrwuwbbwgbbgwuuugbggb\nurwruwbgrwgwgrrbuwurwwugrbggwwugrgbrggbrbbbguwugb\nurwruwurrgurrbrrgwwrbgbbbgrbrwggubguwggburggbwgrurrbubgrugb\nwgrubgrrwgubrgurubggrgrrrgrggbgbbuwwurburgrrr\nuwrruggugruruurugugbgwguruuruburwugwbugwgbbu\nwuugubwwuugubrwgwurrrrbruguwbwuwwwrrwbwbgbgwg\nurrggrrrbgubrrbwwrbwwrggbuwrrwgugrbwburrgrrbugrrbgbwub\nwgruwrrrgbubwbbuubuwbbgwgwrbwguwugrwuwgrbrwguwb\nurgwbbggugrwwuubrwrgwuugrgwrruwgwrbbwrwurrbguwwuwwggggrrg\nbrwrwrrrrbubbgubwuuwbwuggruggbubbwbwugrgurubbbwrwgr\nbrrruguggbwgurbwburrwrrbugubrrrwrubugggbugb\nwwguwbuuwrbwgrwwwwwrggbuwruuwgurwuugwuurggwgbwu\nrububwbrguuuuwrrbwbguwgrwgwuggugwgbgugrrguwru\nrgrwbuubwrwrwwbwgrugguwgbrwubwruwwbbgggurbwgwrugb\nurrbbubbrubwbwuggrurbbgbgurgbbrgbwbubgrwgrwb\nwrrwwbbwubrwuurbwuurbugrrgrrwurbubrwgrrgggguwr\ngrguwbburbrurubggwwwgrwbgbbugrwrgbrggrugb\ngbwrruuurrwbgrgrwgrburbwwgwwuwbubburgrubgwrwgrbb\nwwwggwrwwubrggwrgrwgwrbggbbbggubwwwbruguwbwbrrruwgrg\nbbwwgwwurwgrgrrgubguggwbugrbuwuwgwgbruwgurgugb\ngwgwgwgbgrruwbruwgbguuuwwrubbgrrwgrruwbbbgww\nrwwwbggwggbbwggubgubwwrwgrbbubwbwbwbbugb\nwgwwgwrbuwbuwgbggwggrguwubggbrwugbbwrrurbrbgru\nrrrbgbwurrrbbbrbwgrugrrrrggbgbrgbbruguwwwbu\nugbugwbuuuruggggrubrrugrrrrugbubwugbbwuuwbrrbugurwbrgwg\ngbbwuwwbbgwurgwguuwrbgbbgbguruuurrrgbwugwwbrgrgwgrwugbbgb\nrwbwggwuuwruuwgburgrubrrwugrwrgggugbgrwgwu\nwwwrrugrgrrrugbwgugrwuwrwuguruwuurugbbbwubbgbubr\nbwgrwrugrbrrurwgwrbgbbrrwrubbbgwwggugwgwrgruggrggbuwbuugb\nggbgurbbgwbrwbuurrgrrwwurwgrwruwwwuguugubb\nwurwgbrgwguubuguugurrwbbrugrgwugruggbgbgbguugb\ngrrbwbuubwbruggwbubwbwgbrugrrwbrrwgwrbugggbggwwgrugb\nuubwrgrrwggubggbwwgugwbrgbgbruwgwuwgrrurrwurbg\ngwgurrrwgrguguuuwugwurgrgrrurbwrwgbggggbgbrbwrwurgugbu\nrrwbwgugruwuubgbwrwbbbbbbbugwgbwrgggwwrurr\nwrrgbwrrbrgrbwuwrwbrrwgubwbgbugburugwgrugruwbgrugb\ngrbbgrwggrggbrrbgwwguubbrbbbgburgrbwgurggru\nbwuwuwbwbugrurgrwbbburwwbrwbuubgggbwwubwwrwwuw\nwwwrwbbuubwrguruwwurwwubbgwbbgbrrurbgwwbuggurbwrugw\nwuuwwruuguuwbrbugubwrurwrggwuguwwgwwbbbugb\nbburuguugrgurugrbwgggbbugrurwgwrrguguuguwubbbbrrwgwurubrugb\nwbwgrbbwbrrubwurrgbwbugbrwgwwgwbuubggggguubwgwbbw\nbwrwurbwgrgrurbrwrbubrbugrbugubbrbbgrgbuwguguuuuu\ngrbuuwbrugrbugurrwwwbwrubuwgwwubrbwwwgurrrbubbrubbwuggugg\nrurbwrrbwuguuwrurwgruguwrgggrbgbgubwgrwbbbwugb\nbbggbwwbwbururuwrgrgrbwggburwwgrrbwuwwwgwgbwgrwwugbg\nbwbbbbbwwgwwrgubrrguurwugwwbguugrbrwubgrwgrugbbgwrrwwubgg\nrrgwuuuwgwuubbrbwuuubggrrgbrubgbgrrrbbgugbgbguugb\nggburbrwwbgbgwwgrubggggguuwwwrrbubrrgwububbruubggwrgggrbuw\nggrugwrgbubrrrwbbwguuruuwgwrbggguwbgguwwggwbugwruubrugb\nbuubwgrbbgwurububwgwbgbrrbrbbrwwbbrbbrwggwbbbuwuug\nwgwruubwbrwgbwugbwwbgruwuwbbgwrbwrrrurbrgrgwbgwrb\nrrrugrgbrrrrgggrbbbgubuwwurwrrrruwbwgwwruwubgwrbwgrbgw\nrwggrgrbgwgwgwrwwwrggwbwwrwgrguuugrrguwggruwb\ngggrbgwgruwwbbugggwrgurbwwwuugrwbburrrgwgwgrwguwwwgrwgbggr\nwwwuwrwggrrrrwuruwwbugbrbrguwuuuuwrrwrbugb\n"

#Day19.part1(input) |> IO.inspect(label: :day19_part1, charlists: :as_lists)
#Day19.part2(input) |> IO.inspect(label: :day19_part2, charlists: :as_lists)
```

```elixir
defmodule Day20 do
  import AOC, only: [move: 1, s2map: 1, add2: 2]

  def dfs(m, p, d) do
    for q <- move(p), m[q] != ?#, !d[q], reduce: d, do: (d -> dfs m, q, Map.put(d, q, d[p] + 1))
  end

  def solve(input, t) do
    length for(m <- [s2map input], {s, ?S} <- m, d <- [dfs(m, s, %{s => 0})],
      {p, _} <- d, i <- -t..t, j <- t - abs(i)..abs(i) - t, q = add2(p, {i, j}),
      d[q], d[q] - d[p] - abs(i) - abs(j) > 99, do: 1)
  end

  def part1(input), do: solve(input, 2)
  def part2(input), do: solve(input, 20)
end

input = "#############################################################################################################################################\n#...........#...#...#.....#.............#.........#...#...........#...#.......#...#...###.....#...#...#...###...#...#...#...#...#...###.....#\n#.#########.#.#.#.#.#.###.#.###########.#.#######.#.#.#.#########.#.#.#.#####.#.#.#.#.###.###.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.###.###.#\n#.......#...#.#.#.#.#...#.#...#.....#...#...#.....#.#.#.....#.....#.#.#...#...#.#.#.#...#...#...#...#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#...#\n#######.#.###.#.#.#.###.#.###.#.###.#.#####.#.#####.#.#####.#.#####.#.###.#.###.#.#.###.###.#########.#.###.#.#.#.#.#.#.#.#.#.#######.#.#.###\n###...#.#.....#...#.....#.###.#.###...#...#.#.#...#.#...#...#...#...#.....#.###.#.#.#...#...#.........#...#.#.#...#.#.#...#.#.#.......#.#...#\n###.#.#.#################.###.#.#######.#.#.#.#.#.#.###.#.#####.#.#########.###.#.#.#.###.###.###########.#.#.#####.#.#####.#.#.#######.###.#\n#...#.#...#...........#...#...#...#...#.#.#.#...#.#.#...#.....#.#.........#.#...#.#.#...#...#...#...###...#...#.....#...#...#.#.....###.#...#\n#.###.###.#.#########.#.###.#####.#.#.#.#.#.#####.#.#.#######.#.#########.#.#.###.#.###.###.###.#.#.###.#######.#######.#.###.#####.###.#.###\n#...#.###...#.........#...#.#.....#.#.#.#.#.#.....#.#.#...#...#.#...###...#.#.#...#...#...#...#...#...#.....#...#.....#.#...#.#.....#...#...#\n###.#.#######.###########.#.#.#####.#.#.#.#.#.#####.#.#.#.#.###.#.#.###.###.#.#.#####.###.###.#######.#####.#.###.###.#.###.#.#.#####.#####.#\n#...#...#.....#...#.....#.#.#.....#.#.#.#.#.#.#.....#.#.#.#...#...#...#...#.#.#.#...#.#...###.#.....#.#...#.#.###...#.#.#...#.#.#.....#...#.#\n#.#####.#.#####.#.#.###.#.#.#####.#.#.#.#.#.#.#.#####.#.#.###.#######.###.#.#.#.#.#.#.#.#####.#.###.#.#.#.#.#.#####.#.#.#.###.#.#.#####.#.#.#\n#.....#.#.......#...#...#...#...#.#.#...#...#.#.....#.#.#...#...#.....#...#.#.#...#.#.#.#...#.#...#...#.#.#.#...###.#...#...#.#...#.....#...#\n#####.#.#############.#######.#.#.#.#########.#####.#.#.###.###.#.#####.###.#.#####.#.#.#.#.#.###.#####.#.#.###.###.#######.#.#####.#########\n#.....#.#...#.......#.......#.#...#.....#.....#...#.#.#...#.#...#.#...#...#.#.....#.#.#.#.#.#.#...#...#.#.#...#...#...#.....#.#.....#...#...#\n#.#####.#.#.#.#####.#######.#.#########.#.#####.#.#.#.###.#.#.###.#.#.###.#.#####.#.#.#.#.#.#.#.###.#.#.#.###.###.###.#.#####.#.#####.#.#.#.#\n#.....#.#.#.#.....#.#...#...#...#...###.#.#...#.#.#.#.#...#...#...#.#...#.#...#...#.#.#...#...#...#.#...#...#...#.....#.#...#.#...###.#...#.#\n#####.#.#.#.#####.#.#.#.#.#####.#.#.###.#.#.#.#.#.#.#.#.#######.###.###.#.###.#.###.#.###########.#.#######.###.#######.#.#.#.###.###.#####.#\n#.....#...#.###...#...#.#.#.....#.#.#...#.#.#.#.#.#.#.#...#.....###.#...#...#.#...#.#.#...........#.#.......###.#.......#.#.#...#.....#.....#\n#.#########.###.#######.#.#.#####.#.#.###.#.#.#.#.#.#.###.#.#######.#.#####.#.###.#.#.#.###########.#.#########.#.#######.#.###.#######.#####\n#.........#...#.......#...#.#.....#.#...#.#.#...#.#.#.#...#.#...#...#.#.....#...#.#...#.#...........#.#.....#...#...#...#.#.#...#...#...#...#\n#########.###.#######.#####.#.#####.###.#.#.#####.#.#.#.###.#.#.#.###.#.#######.#.#####.#.###########.#.###.#.#####.#.#.#.#.#.###.#.#.###.#.#\n#...#...#.#...#.....#.....#.#.....#.#...#.#.#.....#.#.#...#...#.#...#.#.......#.#.....#...#...........#.#...#.#.....#.#.#.#.#.#...#...###.#.#\n#.#.#.#.#.#.###.###.#####.#.#####.#.#.###.#.#.#####.#.###.#####.###.#.#######.#.#####.#####.###########.#.###.#.#####.#.#.#.#.#.#########.#.#\n#.#.#.#...#...#...#.......#.#...#.#.#...#.#.#.#...#.#.....#.....#...#...#.....#...#...#...#...#...#...#.#.#...#...#...#.#.#...#.........#.#.#\n#.#.#.#######.###.#########.#.#.#.#.###.#.#.#.#.#.#.#######.#####.#####.#.#######.#.###.#.###.#.#.#.#.#.#.#.#####.#.###.#.#############.#.#.#\n#.#...#.....#...#.........#...#.#.#.#...#.#.#.#.#.#.......#.#...#.#.....#...#.....#.#...#.....#.#.#.#.#.#.#...#...#...#.#.#.............#.#.#\n#.#####.###.###.#########.#####.#.#.#.###.#.#.#.#.#######.#.#.#.#.#.#######.#.#####.#.#########.#.#.#.#.#.###.#.#####.#.#.#.#############.#.#\n#...#...###...#.......###.#.....#.#...#...#.#.#.#.....###.#...#...#...#...#.#...###.#.###...###.#.#.#.#.#...#.#...###.#.#.#.......#.....#.#.#\n###.#.#######.#######.###.#.#####.#####.###.#.#.#####.###.###########.#.#.#.###.###.#.###.#.###.#.#.#.#.###.#.###.###.#.#.#######.#.###.#.#.#\n#...#.#.....#.......#.....#...###.....#.#...#.#.....#.#...#...#.......#.#.#.#...#...#...#.#.#...#.#.#...#...#...#.#...#...#.......#.#...#.#.#\n#.###.#.###.#######.#########.#######.#.#.###.#####.#.#.###.#.#.#######.#.#.#.###.#####.#.#.#.###.#.#####.#####.#.#.#######.#######.#.###.#.#\n#.....#.#...###...#.........#.#...###.#.#.#...#...#.#.#...#.#...###...#.#.#.#.###...#...#.#.#...#.#...#...#...#.#.#.#.......#.......#...#.#.#\n#######.#.#####.#.#########.#.#.#.###.#.#.#.###.#.#.#.###.#.#######.#.#.#.#.#.#####.#.###.#.###.#.###.#.###.#.#.#.#.#.#######.#########.#.#.#\n#...#...#.#.....#.....#...#.#.#.#.#...#.#.#...#.#.#.#.#...#.#...#...#...#.#.#...#...#...#.#.#...#.#...#...#.#.#.#.#.#.#.....#.#.........#.#.#\n#.#.#.###.#.#########.#.#.#.#.#.#.#.###.#.###.#.#.#.#.#.###.#.#.#.#######.#.###.#.#####.#.#.#.###.#.#####.#.#.#.#.#.#.#.###.#.#.#########.#.#\n#.#.#...#.#.........#...#...#...#...###.#.#...#.#.#.#.#...#.#.#.#...#.....#...#.#...#...#.#.#.#...#...###...#...#.#.#...#...#.#.....###...#.#\n#.#.###.#.#########.###################.#.#.###.#.#.#.###.#.#.#.###.#.#######.#.###.#.###.#.#.#.#####.###########.#.#####.###.#####.###.###.#\n#.#.....#...#.......#.................#...#...#.#...#...#.#...#.#...#...#...#.#.#...#...#.#.#.#.#...#.#...........#.#.....#...#...#...#...#.#\n#.#########.#.#######.###############.#######.#.#######.#.#####.#.#####.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.###########.#.#####.###.#.###.###.#.#\n#.......#...#.......#.#...............#...#...#...#...#.#.....#.#.....#.#.#.#.#.#...#...#.#.#.#.#.#...#.............#.###...#...#...#.....#.#\n#######.#.#########.#.#.###############.#.#.#####.#.#.#.#####.#.#####.#.#.#.#.#.###.#.###.#.#.#.#.###################.###.###.#####.#######.#\n#.......#...#.....#...#.................#.#.#...#...#.#.#...#.#.#...#.#.#.#.#.#.....#...#.#.#.#.#.#.....#...........#.....#...###...#.......#\n#.#########.#.###.#######################.#.#.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#########.#.#.#.#.#.#.###.#.#########.#######.#####.###.#######\n#.........#.#...#...#.....................#...#...#...#.#.#...#.#.#.#.#.#.#.#.###.......#.#...#...#...#.#.........#.#...#...#...#.....#...###\n#########.#.###.###.#.###########################.#.###.#.#####.#.#.#.#.#.#.#.###.#######.###########.#.#########.#.#.#.#.###.#.#######.#.###\n#.........#.....#...#.#.....................#...#.#...#.#...###.#.#...#.#.#.#...#...#...#.#######S..#.#.#.....#...#.#.#...###.#.#...#...#...#\n#.###############.###.#.###################.#.#.#.###.#.###.###.#.#####.#.#.###.###.#.#.#.#########.#.#.#.###.#.###.#.#######.#.#.#.#.#####.#\n#.......#...#...#...#...#...#...#.....#...#...#.#.....#...#...#.#.....#.#.#...#.#...#.#.#.#########...#...###...###.#.........#...#...#...#.#\n#######.#.#.#.#.###.#####.#.#.#.#.###.#.#.#####.#########.###.#.#####.#.#.###.#.#.###.#.#.#########################.###################.#.#.#\n#.......#.#...#...#...#...#...#.#...#...#.......#.......#.....#.#...#.#.#...#.#.#...#.#.#.#####...............#...#.........#...#.....#.#...#\n#.#######.#######.###.#.#######.###.#############.#####.#######.#.#.#.#.###.#.#.###.#.#.#.#####.#############.#.#.#########.#.#.#.###.#.#####\n#.........#...###...#.#...#.....###.###...#...###.#...#.......#...#.#.#...#.#.#.###...#...#####...#.........#.#.#...#...###...#.#.#...#...###\n###########.#.#####.#.###.#.#######.###.#.#.#.###.#.#.#######.#####.#.###.#.#.#.#################.#.#######.#.#.###.#.#.#######.#.#.#####.###\n#...........#...#...#.....#...#...#...#.#...#.....#.#.......#.....#.#...#...#...###############...#.......#...#.#...#.#.#...###...#.....#...#\n#.#############.#.###########.#.#.###.#.###########.#######.#####.#.###.#######################.#########.#####.#.###.#.#.#.###########.###.#\n#.....#...#...#...#...#.....#...#.....#...#...#...#.......#.......#.#...#.......#####.....#...#.#...#...#.......#.....#...#...#.....###...#.#\n#####.#.#.#.#.#####.#.#.###.#############.#.#.#.#.#######.#########.#.###.#####.#####.###.#.#.#.#.#.#.#.#####################.#.###.#####.#.#\n#.....#.#.#.#.#.....#.#...#...#...........#.#.#.#.#...#...#...#...#...#...#...#..E###...#...#...#.#.#.#...........#...........#.#...#...#...#\n#.#####.#.#.#.#.#####.###.###.#.###########.#.#.#.#.#.#.###.#.#.#.#####.###.#.#########.#########.#.#.###########.#.###########.#.###.#.#####\n#.......#...#...#.....#...###...#.........#.#...#...#.#.....#...#...###.....#...#.......#.........#...#.........#.#.............#.....#.....#\n#################.#####.#########.#######.#.#########.#############.###########.#.#######.#############.#######.#.#########################.#\n#...#.....#...#...#...#...#.....#.......#.#.........#.#...#...#...#...###...###...#.....#...............#.......#...#...#...#.....#.........#\n#.#.#.###.#.#.#.###.#.###.#.###.#######.#.#########.#.#.#.#.#.#.#.###.###.#.#######.###.#################.#########.#.#.#.#.#.###.#.#########\n#.#.#...#...#...#...#.#...#...#.......#.#.#.........#.#.#.#.#.#.#...#.#...#.......#...#.#...#...#.......#.#...#...#...#...#...###...#...#...#\n#.#.###.#########.###.#.#####.#######.#.#.#.#########.#.#.#.#.#.###.#.#.#########.###.#.#.#.#.#.#.#####.#.#.#.#.#.###################.#.#.#.#\n#.#.....#...#...#.#...#.#...#...#...#...#.#.........#...#...#.#.#...#.#...#.......#...#...#...#.#.....#.#...#...#...#...###...###.....#...#.#\n#.#######.#.#.#.#.#.###.#.#.###.#.#.#####.#########.#########.#.#.###.###.#.#######.###########.#####.#.###########.#.#.###.#.###.#########.#\n#...#.....#...#.#.#...#.#.#...#...#.....#.#...#.....#...#...#...#.....#...#.....#...#.....#...#.......#...........#...#.....#.....#.....#...#\n###.#.#########.#.###.#.#.###.#########.#.#.#.#.#####.#.#.#.###########.#######.#.###.###.#.#.###################.#################.###.#.###\n#...#.#.........#.###.#.#...#...###.....#.#.#.#...###.#.#.#...#...###...#.....#...#...###...#.....#...#.........#...#...#.....#...#...#.#...#\n#.###.#.#########.###.#.###.###.###.#####.#.#.###.###.#.#.###.#.#.###.###.###.#####.#############.#.#.#.#######.###.#.#.#.###.#.#.###.#.###.#\n#...#.#.........#.#...#.###...#.#...#...#...#...#...#.#.#.#...#.#.#...#...###...#...#...........#...#.#.#.......#...#.#.#...#.#.#.#...#...#.#\n###.#.#########.#.#.###.#####.#.#.###.#.#######.###.#.#.#.#.###.#.#.###.#######.#.###.#########.#####.#.#.#######.###.#.###.#.#.#.#.#####.#.#\n#...#.#.........#.#.#...#...#.#.#...#.#.###...#...#.#.#...#...#.#.#.#...#.....#...###.......#...#...#...#...#...#.....#.#...#.#.#.#...#...#.#\n#.###.#.#########.#.#.###.#.#.#.###.#.#.###.#.###.#.#.#######.#.#.#.#.###.###.#############.#.###.#.#######.#.#.#######.#.###.#.#.###.#.###.#\n#...#.#...........#...#...#...#.....#.#...#.#.###...#.#.......#.#.#...###...#.#...#...#.....#.....#.....#...#.#.....#...#...#.#.#.#...#.#...#\n###.#.#################.#############.###.#.#.#######.#.#######.#.#########.#.#.#.#.#.#.###############.#.###.#####.#.#####.#.#.#.#.###.#.###\n###...###...........#...#...#...#.....#...#.#...#...#.#.....###.#.#...###...#...#...#.#.....#...#.....#...#...#.....#...#...#.#.#.#...#...###\n#########.#########.#.###.#.#.#.#.#####.###.###.#.#.#.#####.###.#.#.#.###.###########.#####.#.#.#.###.#####.###.#######.#.###.#.#.###.#######\n#.......#.....#...#.#.....#...#...#...#...#.#...#.#.#.#.....#...#...#...#.....#.......#...#...#...###.......#...#...###...###.#.#.....#.....#\n#.#####.#####.#.#.#.###############.#.###.#.#.###.#.#.#.#####.#########.#####.#.#######.#.###################.###.#.#########.#.#######.###.#\n#.....#.#...#...#.#.#...###...#.....#.....#.#.#...#...#...###...#.......#.....#.###...#.#...#.......#.........###.#.#...#...#...#.......#...#\n#####.#.#.#.#####.#.#.#.###.#.#.###########.#.#.#########.#####.#.#######.#####.###.#.#.###.#.#####.#.###########.#.#.#.#.#.#####.#######.###\n#.....#...#.......#...#.....#.#.#...###...#.#.#...#.......#...#.#.###...#.....#...#.#.#.#...#.....#.#.............#.#.#.#.#.....#...#.....###\n#.###########################.#.#.#.###.#.#.#.###.#.#######.#.#.#.###.#.#####.###.#.#.#.#.#######.#.###############.#.#.#.#####.###.#.#######\n#.#...#.....................#.#...#.....#...#.....#.......#.#...#...#.#.#...#...#.#.#.#.#.........#.....#...........#.#...#...#.....#...#...#\n#.#.#.#.###################.#.###########################.#.#######.#.#.#.#.###.#.#.#.#.###############.#.###########.#####.#.#########.#.#.#\n#.#.#...#.....#.......#.....#...#...................#.....#.....#...#.#.#.#.....#...#.#...............#...#...........#.....#...........#.#.#\n#.#.#####.###.#.#####.#.#######.#.#################.#.#########.#.###.#.#.###########.###############.#####.###########.#################.#.#\n#...#...#...#.#.#...#.#.....#...#.................#...#...#...#.#.#...#.#.#...#.....#.#.........###...#.....#...........#...###...#.......#.#\n#####.#.###.#.#.#.#.#.#####.#.###################.#####.#.#.#.#.#.#.###.#.#.#.#.###.#.#.#######.###.###.#####.###########.#.###.#.#.#######.#\n###...#.....#...#.#.#.......#...............#.....###...#.#.#.#.#.#...#.#...#.#.###...#.......#.....#...#...#...........#.#...#.#.#.#.......#\n###.#############.#.#######################.#.#######.###.#.#.#.#.###.#.#####.#.#############.#######.###.#.###########.#.###.#.#.#.#.#######\n#...#...#...#...#.#...#.....#...#.........#.#.......#...#...#...#.#...#.....#.#...........###.......#.#...#.............#.#...#.#.#.#.###...#\n#.###.#.#.#.#.#.#.###.#.###.#.#.#.#######.#.#######.###.#########.#.#######.#.###########.#########.#.#.#################.#.###.#.#.#.###.#.#\n#...#.#...#...#.#.#...#.#...#.#.#.#...#...#.......#.###...#.......#.......#...#.....#.....#.......#...#...#...............#.....#...#...#.#.#\n###.#.#########.#.#.###.#.###.#.#.#.#.#.#########.#.#####.#.#############.#####.###.#.#####.#####.#######.#.###########################.#.#.#\n#...#.###...#...#.#...#.#.#...#...#.#...#.......#...#...#.#.......#.......#.....###...#...#...#...###...#...#.....#.....#...#.....#...#...#.#\n#.###.###.#.#.###.###.#.#.#.#######.#####.#####.#####.#.#.#######.#.#######.###########.#.###.#.#####.#.#####.###.#.###.#.#.#.###.#.#.#####.#\n#.#...#...#...#...###...#...#.......#...#.....#...#...#.#.#.......#.......#...#...#...#.#.#...#.....#.#.#...#...#.#...#.#.#.#.###.#.#.....#.#\n#.#.###.#######.#############.#######.#.#####.###.#.###.#.#.#############.###.#.#.#.#.#.#.#.#######.#.#.#.#.###.#.###.#.#.#.#.###.#.#####.#.#\n#.#.#...#.......#.....#.......#.....#.#.#...#...#.#...#.#.#.#...###...###.#...#.#.#.#.#.#.#.....#...#.#.#.#.....#...#.#...#.#...#.#.#...#...#\n#.#.#.###.#######.###.#.#######.###.#.#.#.#.###.#.###.#.#.#.#.#.###.#.###.#.###.#.#.#.#.#.#####.#.###.#.#.#########.#.#####.###.#.#.#.#.#####\n#...#.....#...###...#.#...#...#.#...#.#.#.#.#...#...#.#.#.#.#.#.#...#...#.#...#.#...#.#.#.....#.#.#...#.#.........#.#.....#...#.#.#...#...###\n###########.#.#####.#.###.#.#.#.#.###.#.#.#.#.#####.#.#.#.#.#.#.#.#####.#.###.#.#####.#.#####.#.#.#.###.#########.#.#####.###.#.#.#######.###\n#...........#.....#.#.###...#...#.#...#...#.#...#...#.#.#.#.#.#...###...#.#...#.....#...#.....#.#.#.###.#...#...#.#.#.....###.#.#...#...#...#\n#.###############.#.#.###########.#.#######.###.#.###.#.#.#.#.#######.###.#.#######.#####.#####.#.#.###.#.#.#.#.#.#.#.#######.#.###.#.#.###.#\n#...........#...#...#.#...#...#...#...#.....#...#.#...#.#.#.#.......#.#...#.....#...#.....#...#.#...#...#.#.#.#...#.#.......#...###...#...#.#\n###########.#.#.#####.#.#.#.#.#.#####.#.#####.###.#.###.#.#.#######.#.#.#######.#.###.#####.#.#.#####.###.#.#.#####.#######.#############.#.#\n#...........#.#.#...#...#...#...#...#.#.#...#.###.#.###...#...#...#.#.#.....#...#.#...#...#.#.#.#.....#...#...###...#...#...#.......#.....#.#\n#.###########.#.#.#.#############.#.#.#.#.#.#.###.#.#########.#.#.#.#.#####.#.###.#.###.#.#.#.#.#.#####.#########.###.#.#.###.#####.#.#####.#\n#...........#.#.#.#...#.........#.#.#.#...#.#.#...#.....#...#.#.#.#.#.#.....#...#.#...#.#.#.#...#.#...#.#...#...#...#.#.#...#.#.....#.....#.#\n###########.#.#.#.###.#.#######.#.#.#.#####.#.#.#######.#.#.#.#.#.#.#.#.#######.#.###.#.#.#.#####.#.#.#.#.#.#.#.###.#.#.###.#.#.#########.#.#\n#...........#.#...###...#.......#.#.#.#...#.#.#.#.....#.#.#...#.#.#.#.#.....#...#...#.#.#.#...#...#.#.#...#...#...#.#.#...#.#.#.#...#...#.#.#\n#.###########.###########.#######.#.#.#.#.#.#.#.#.###.#.#.#####.#.#.#.#####.#.#####.#.#.#.###.#.###.#.###########.#.#.###.#.#.#.#.#.#.#.#.#.#\n#.#...........#...###...#.....#...#.#.#.#...#.#.#...#.#.#...#...#.#.#.#...#.#.#...#.#.#.#.#...#.#...#.#...#...#...#.#.#...#...#...#...#.#.#.#\n#.#.###########.#.###.#.#####.#.###.#.#.#####.#.###.#.#.###.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.###.#.#.#.#.#.###.#.#.###############.#.#.#\n#...###.........#.....#.......#.###...#.....#.#.#...#.#.###.#...#.#.#.#.#.#.#.#.#.#.#...#.#.###...###.#.#...#.#...#.#.#.....#.....#.....#...#\n#######.#######################.###########.#.#.#.###.#.###.###.#.#.#.#.#.#.#.#.#.#.#####.#.#########.#.#####.###.#.#.#####.#.###.#.#########\n#.....#...#...#...........#...#.......#.....#.#.#...#...#...#...#.#.#...#.#.#.#.#...#.....#.#.........#.#...#.....#...###...#...#.#...#...###\n#.###.###.#.#.#.#########.#.#.#######.#.#####.#.###.#####.###.###.#.#####.#.#.#.#####.#####.#.#########.#.#.#############.#####.#.###.#.#.###\n#...#...#...#.#.#.........#.#...#...#.#...#...#.#...#.....#...#...#.....#.#.#...###...#.....#.#...#...#...#.....#...#...#.#...#.#...#...#...#\n###.###.#####.#.#.#########.###.#.#.#.###.#.###.#.###.#####.###.#######.#.#.#######.###.#####.#.#.#.#.#########.#.#.#.#.#.#.#.#.###.#######.#\n###.#...#.....#.#.........#.###.#.#.#.#...#.#...#...#.#...#...#...#...#.#.#.#.......#...#.....#.#.#.#.#...#...#...#...#.#...#.#...#...#.....#\n###.#.###.#####.#########.#.###.#.#.#.#.###.#.#####.#.#.#.###.###.#.#.#.#.#.#.#######.###.#####.#.#.#.#.#.#.#.#########.#####.###.###.#.#####\n#...#.....#.....#...#.....#...#.#.#.#.#.#...#...#...#.#.#.....#...#.#.#.#.#.#.#.....#.###...#...#...#.#.#.#.#.#...#...#.....#.....#...#.....#\n#.#########.#####.#.#.#######.#.#.#.#.#.#.#####.#.###.#.#######.###.#.#.#.#.#.#.###.#.#####.#.#######.#.#.#.#.#.#.#.#.#####.#######.#######.#\n#...#.....#.#.....#...#.....#.#.#.#.#.#.#...#...#...#.#...#...#.....#...#.#.#.#...#.#.#.....#.....#...#.#.#.#.#.#.#.#.#...#...#...#...#...#.#\n###.#.###.#.#.#########.###.#.#.#.#.#.#.###.#.#####.#.###.#.#.###########.#.#.###.#.#.#.#########.#.###.#.#.#.#.#.#.#.#.#.###.#.#.###.#.#.#.#\n#...#.#...#.#.....#...#.###.#.#...#.#.#...#.#.....#.#.#...#.#...#...#.....#.#.#...#...#.#.....#...#...#.#.#.#.#.#...#.#.#...#...#...#.#.#.#.#\n#.###.#.###.#####.#.#.#.###.#.#####.#.###.#.#####.#.#.#.###.###.#.#.#.#####.#.#.#######.#.###.#.#####.#.#.#.#.#.#####.#.###.#######.#.#.#.#.#\n#.....#...#.#.....#.#.#...#.#.###...#...#.#.#.....#.#.#.....#...#.#...#...#.#.#.......#...###.#.#...#...#.#.#.#.....#.#.###.#.......#.#.#.#.#\n#########.#.#.#####.#.###.#.#.###.#####.#.#.#.#####.#.#######.###.#####.#.#.#.#######.#######.#.#.#.#####.#.#.#####.#.#.###.#.#######.#.#.#.#\n###...###...#...#...#...#.#.#...#...#...#.#.#.....#.#...#...#.#...#...#.#.#.#.#.....#.###.....#...#...#...#.#...#...#...#...#.......#...#.#.#\n###.#.#########.#.#####.#.#.###.###.#.###.#.#####.#.###.#.#.#.#.###.#.#.#.#.#.#.###.#.###.###########.#.###.###.#.#######.#########.#####.#.#\n#...#...........#.....#.#.#...#...#.#...#.#.#.....#...#.#.#.#.#.#...#.#.#.#.#.#.#...#.#...#.....#...#.#...#.#...#.......#.#.....#...#.....#.#\n#.###################.#.#.###.###.#.###.#.#.#.#######.#.#.#.#.#.#.###.#.#.#.#.#.#.###.#.###.###.#.#.#.###.#.#.#########.#.#.###.#.###.#####.#\n#.....................#...###.....#.....#...#.........#...#...#...###...#...#...#.....#.....###...#...###...#...........#...###...###.......#\n#############################################################################################################################################\n"

#1402 = Day20.part1(input) |> IO.inspect(label: :day20_part1, charlists: :as_lists)
#1020244 = Day20.part2(input) |> IO.inspect(label: :day20_part2, charlists: :as_lists)
```

```elixir
defmodule Day21bak do
  import AOC

  def gen([], _, _, acc), do: acc
    #|> Enum.reverse()
    #|> Enum.filter(&[] < &1) |> Enum.reverse() |> Enum.intersperse(?A) |>IO.inspect()|> List.flatten()
  def gen([c2|rest], c1, m, acc) do
    {di, dj} = sub2(m[c2], m[c1])
    a = dup(di > 0 && ?v || ?^, abs(di))
    b = dup(dj > 0 && ?> || ?<, abs(dj))
    [a, b] = dj < 0 && [b, a] || [a, b] # < first
    #ab = [a, b] |> Enum.filter(& &1 != [])
    #ab = [b, a] |> Enum.filter(& &1 != [])
    #acc = [[[?A]], ab | acc]
    #ab = dj < 0 && b ++ a || a ++ b
    acc = acc ++ a ++ b ++ [?A]
    gen(rest, c2, m, acc)
  end

  def choice([]), do: [[]]
  def choice([i]), do: [i]
  def choice([i, j]) do
    [i ++ j, j ++ i]
    #perm2(i, j)
  end

  def perm2(i, []), do: [i]
  def perm2([], j), do: [j]
  def perm2([i0|ti]=i, [j0|tj]=j) do
    for p <- perm2(ti, j) do [i0 | p] end ++
    for p <- perm2(tj, i) do [j0 | p] end
  end

  def perm([]), do: [[]]
  def perm([h | rest]), do: for(p <- perm(rest), cs <- choice(h), do: cs ++ p)

  def k2map(s) do
    for {k, v} <- s2map(s), reduce: %{} do
      m -> Map.merge(m, %{k => v, v => k})
    end
  end

  def shortest(ps) do
    len = Enum.min(for p <- ps, do: length p)
    Enum.filter(ps, &length(&1) == len)
    |> tap(&IO.inspect("#{length &1}/#{length ps} len #{len}"))
  end

  def part1(input) do
    m1 = k2map "789\n456\n123\n 0A"
    m2 = k2map " ^A\n<v>"
    for s <- String.split(input, "\n", trim: true) do
      n = Regex.run(~r/\d+/, s) |> hd() |> int()
      #p = String.to_charlist(s)
      #ps = for(p <- gen(p, ?A, m1, []) |> perm() |> shortest(),
      #         p <- gen(p, ?A, m2, []) |> perm() |> shortest(),
      #         p <- gen(p, ?A, m2, []) |> perm() |> shortest(), do: p)
      ps = [String.to_charlist(s)]
      ps = for(p <- ps, p <- gen(p, ?A, m1, []) |> perm(), do: p) |> shortest()
      ps = for(p <- ps, p <- gen(p, ?A, m2, []) |> perm(), do: p) |> shortest()
      ps = for(p <- ps, p <- gen(p, ?A, m2, []) |> perm(), do: p) |> shortest()
      len = Enum.min(for p <- ps, do: length p)
      p = Enum.find(ps, &length(&1) == len)
      IO.inspect("#{s} #{len} #{p}")
      len * n
    end
    |> Enum.sum()
  end

  def part2(input) do
    input
  end
end
```

```elixir
defmodule Day21 do
  import AOC

  def corner(m, c, b) do
    d = case Enum.at(b, 0) do
      ?> -> {0, 1}
      ?< -> {0, -1}
      ?v -> {1, 0}
      ?^ -> {-1, 0}
      _ -> {0, 0}
    end
    m[add2(m[c], mul2(d, length(b)))] == ?\s
  end

  def gen(cs, m, c1 \\ ?A, acc \\ [])
  def gen([], _, _, acc), do: acc |> List.flatten()
  def gen([c2|cs], m, c1, acc) do
    {di, dj} = sub2(m[c2], m[c1])
    a = dup(di > 0 && ?v || ?^, abs(di))
    b = dup(dj > 0 && ?> || ?<, abs(dj))
    [a, b] = dj < 0 && [b, a] || [a, b] # < first
    [a, b] = corner(m, c1, a) && [b, a] || [a, b] # < first
    acc = acc ++ a ++ b ++ [?A]
    gen(cs, m, c2, acc)
  end

  def k2map(s), do: for({k, v} <- s2map(s), reduce: %{}, do: (m -> Map.merge m, %{k => v, v => k}))

  def part1(input) do
    m1 = k2map("789\n456\n123\n 0A")
    m2 = k2map(" ^A\n<v>")
    for s <- String.split(input, "\n", trim: true) do
      n = int(String.slice s, 0..2)
      p = String.to_charlist(s)
      |> gen(m1)
      |> gen(m2)
      |> gen(m2)
      len = length(p)
      #IO.inspect("#{s} #{len} #{p}")
      len * n
    end
    |> Enum.sum()
  end

  def splitp(p) do
    chunk_fun = fn ?A, acc -> {:cont, Enum.reverse([?A|acc]), []}
                    c, acc -> {:cont, [c | acc]} end
    Enum.chunk_while(p, [], chunk_fun, fn acc -> {:cont, acc} end)
  end

  def dp(pm, m) do
    for {p, n} <- pm, p <- splitp(p), reduce: %{} do
      pm ->
        Map.update(pm, gen(p, m), n, & &1 + n)
    end
  end

  def part2(input) do
    m1 = k2map("789\n456\n123\n 0A")
    m2 = k2map(" ^A\n<v>")
    for s <- String.split(input, "\n", trim: true) do
      n = int(String.slice s, 0..2)
      p = String.to_charlist(s) |> gen(m1)
      pm = for _ <- 1..25, reduce: %{p => 1}, do: (pm -> dp(pm, m2))
      len = Enum.sum for {p, n} <- pm, do: length(p) * n
      #IO.inspect({s, len, pm})
      len * n
    end
    |> Enum.sum()
  end
end

input = "279A\n341A\n459A\n540A\n085A\n"

input1 = "029A\n980A\n179A\n456A\n379A\n"

Day21.part1(input) |> IO.inspect(label: :day21_part1, charlists: :as_lists)
Day21.part2(input) |> IO.inspect(label: :day21_part2, charlists: :as_lists)
```

## new

```elixir
defmodule Day22 do
  import AOC, only: [int2d: 1, mod: 2]

  def next(x) do x
    |> then(&(&1 * 2**6) |> Bitwise.bxor(&1) |> mod(16777216))
    |> then(&div(&1, 32) |> Bitwise.bxor(&1) |> mod(16777216))
    |> then(&(&1 * 2048) |> Bitwise.bxor(&1) |> mod(16777216))
  end

  def part1(input) do
    Enum.sum for([x] <- int2d(input), do: for(_ <- 1..2000, reduce: x, do: (x -> next x)))
  end

  def part2(input) do
    for [x] <- int2d(input), reduce: %{} do # %{[-2,1,-1,3] => [7,7,9]}
      acc ->
        ps = Stream.unfold(x, &{mod(&1, 10), next(&1)}) |> Enum.take(2000)
        ps
        |> Enum.zip_with(tl(ps), fn x, y -> y - x end)
        |> Enum.chunk_every(4, 1, :discard)
        |> Enum.zip(Enum.slice(ps, 4..-1//1))
        |> Enum.reduce(%{}, fn {k, v}, acc -> Map.put_new(acc, k, v) end)
        |> Enum.reduce(acc, fn {k, v}, acc -> Map.update(acc, k, [v], &[v | &1]) end)
    end
    |> Enum.map(fn {_, v} -> Enum.sum(v) end)
    |> Enum.max()
  end
end

input = "6731044\n5953403\n16612514\n5099965\n2695721\n9419295\n9708091\n7902959\n7365259\n14395904\n2850373\n11132133\n9236815\n9465160\n11799711\n11020160\n5762967\n14047498\n15394883\n14714081\n5291730\n13128552\n882307\n10206510\n7385142\n3165644\n10284607\n7618987\n12114979\n412548\n7832417\n5445536\n5736086\n4529181\n9033325\n6126799\n7952175\n14660481\n7828233\n4749744\n6296331\n3071395\n3353323\n3931915\n5596339\n14281172\n7417721\n384583\n2292076\n11854932\n12478474\n10949432\n9909161\n9352387\n10604400\n14809407\n1621759\n13025058\n9176570\n15434040\n737951\n8047843\n14538738\n1705914\n16747424\n13991250\n8359895\n8098119\n7606120\n11227645\n16487043\n10475796\n12865576\n14794334\n343448\n7243114\n10168556\n10758918\n11815241\n4394729\n14384066\n14970320\n6306267\n5792854\n11225733\n16530268\n11249111\n8345673\n13402436\n15469574\n5922818\n7769736\n6436793\n9367787\n4901605\n7692696\n4060451\n9115206\n447143\n877559\n13930165\n8058989\n16583837\n2840625\n2884652\n1933846\n14568926\n5324306\n13350754\n16506474\n9201357\n15742551\n5532298\n1003828\n5147714\n15019866\n9073773\n13110580\n1964977\n8819065\n8514121\n8455468\n1669446\n4216696\n11496226\n10482027\n12255629\n14178907\n7833571\n9710325\n3620560\n12003327\n4994681\n15603809\n2658528\n16573486\n7441147\n3299435\n491401\n5026749\n9128231\n7918816\n15908955\n498981\n12937442\n6670138\n14435060\n3870675\n7799317\n9855129\n747367\n14035089\n16406010\n3553788\n8272812\n10808182\n1238561\n952797\n179055\n393228\n13386401\n7014932\n2368487\n8638609\n13300082\n4900563\n12437415\n2123466\n16285615\n15867429\n5107609\n15334689\n9855565\n11075782\n4487831\n6377364\n6434356\n5708434\n13403978\n9204364\n3489470\n8819670\n13414421\n16571251\n15922564\n4218616\n1417742\n243153\n3286512\n16504979\n10041855\n12274856\n1589815\n3298564\n2304168\n641219\n13680025\n10032842\n4027741\n7253744\n14452784\n6764189\n675648\n5382711\n12204876\n13498923\n10450228\n4983712\n15903057\n4047559\n7227070\n841816\n7678222\n9997023\n4208578\n12830128\n8370675\n11950636\n1247797\n7917056\n15569940\n10110431\n12629597\n12169005\n5563317\n6532535\n14966890\n3506520\n1659898\n16071184\n5237684\n7311161\n10624723\n7244588\n15576284\n15734666\n5834834\n4720882\n13838253\n9053453\n2810255\n10970414\n13148004\n6450909\n15976944\n7361274\n9515932\n14498322\n3259596\n2094490\n5846229\n2514420\n14507201\n5861700\n4842766\n7670437\n15541371\n5098146\n14077600\n2675852\n4255379\n7038931\n10668261\n8401538\n15620599\n14004375\n5663478\n15093634\n16457384\n4175111\n3443713\n6905710\n234978\n11123668\n5585516\n8912738\n13183340\n15928429\n3519030\n4149801\n8267437\n10762148\n2290569\n5578334\n1745707\n11281566\n10225595\n1846068\n6570074\n14086307\n4741201\n10764259\n14887983\n15763802\n1115370\n15640177\n12628382\n5780090\n7103804\n10150318\n8517644\n1498243\n15603569\n5422647\n13670906\n12280423\n11637911\n7353242\n6545798\n4987432\n6844352\n9778133\n15111141\n8282490\n13665487\n2287872\n14554093\n12668241\n8293610\n6205726\n14126505\n1757939\n14164888\n9630706\n10555970\n830638\n10374331\n7969795\n10732300\n328883\n13058938\n739348\n5379080\n675806\n6078777\n6769349\n7205215\n10717476\n15742136\n471149\n12275481\n12162934\n13727816\n6950100\n6289169\n299908\n7249414\n1335542\n8312157\n11860850\n736701\n8221149\n16291685\n4118797\n12215583\n2013739\n9645253\n8404290\n14723979\n11099674\n6951518\n10296016\n15334047\n5026425\n2537303\n9892887\n12785487\n10408044\n16689290\n15699391\n14733356\n362187\n3629234\n13833122\n12359668\n6472781\n7666106\n15275984\n5120869\n2535682\n2282988\n12871415\n6420909\n1593123\n13661518\n3132062\n3185560\n14594218\n12241938\n11338407\n2982401\n10550790\n14928431\n6169978\n2915246\n13234097\n15108407\n2058978\n1794333\n15437443\n15363080\n8223319\n15228250\n1931889\n11993968\n9671594\n6854972\n2974301\n12114670\n3363453\n6000126\n13656027\n14252162\n16644829\n10158150\n4359147\n15688193\n9691500\n14104893\n10869762\n14377150\n16508209\n2411381\n12760596\n2128168\n11171295\n8949953\n11398374\n1576654\n4145364\n4182079\n14934126\n6348172\n8809049\n14947374\n16096953\n6434264\n13359589\n15880490\n9121186\n15584222\n4544551\n9633716\n8272500\n8756950\n15623771\n6736096\n6580104\n8359699\n10109257\n4569929\n5148422\n4650363\n15890598\n2208048\n12878357\n10210729\n3475236\n14739461\n248553\n5047424\n7381391\n2735933\n7265195\n763670\n12965234\n9591955\n8636771\n9472187\n7730098\n6322578\n687815\n7457402\n11741778\n2229560\n16077901\n397776\n13087754\n15362146\n5744295\n11417392\n841208\n6041462\n3123353\n1492716\n6114537\n15952802\n10743281\n806745\n306635\n2051250\n887164\n4298061\n6263277\n9633350\n16049121\n6310917\n2408568\n305903\n2710375\n7976457\n5836068\n3365199\n13847057\n6748684\n3316185\n11142666\n4398524\n4278241\n9004814\n6259957\n5042792\n388661\n3249950\n16197496\n10397559\n6224264\n1574057\n8352161\n137774\n988874\n15953184\n12258826\n5654684\n15626286\n8237101\n10497520\n10564838\n1357882\n7066713\n10046115\n3792823\n406963\n9865903\n2439809\n3497706\n2652629\n3460952\n4088429\n8687674\n8358239\n10657355\n14079945\n16131422\n1388364\n143914\n6232697\n758784\n13397361\n16134663\n10876326\n6223484\n7439124\n1897128\n4232275\n15671249\n4373358\n5732892\n16197618\n1270480\n2723121\n9788163\n661123\n5046295\n5630086\n9398480\n7646921\n3628398\n7518630\n12351893\n7421803\n4288687\n9335523\n9780616\n13647050\n8117924\n796939\n2169414\n16135317\n2342921\n3518546\n5110089\n1814791\n13021764\n7204204\n10434441\n2040791\n6916982\n13952522\n2103624\n14317021\n2478080\n2436380\n1712724\n15277905\n14864351\n8335619\n10674621\n5218689\n15426036\n14175363\n14131699\n2359498\n10528702\n3855780\n1121440\n15814752\n10851044\n11061128\n2686525\n13341784\n10378403\n9702716\n8878465\n8518962\n5661491\n6838981\n7489532\n8113627\n16281608\n4675339\n16561445\n11720158\n3676460\n14844931\n13518082\n4997183\n15035594\n15839807\n5331216\n13514748\n14313119\n15743286\n4466392\n6975758\n2666512\n9958866\n801963\n8887081\n14619491\n1309825\n12559469\n5830198\n1172969\n244353\n7076666\n7355118\n2548162\n11676524\n8794288\n6459293\n6337392\n9960159\n9849660\n10079604\n7763821\n9342683\n14342538\n14066021\n7665095\n1551553\n3444081\n1474497\n1006311\n13027570\n12704796\n2725743\n6232738\n10561268\n6226734\n3623862\n7506704\n738669\n16723118\n1822217\n5727435\n1582480\n7726374\n12552081\n2546634\n13486240\n15077951\n14327633\n16542801\n2338492\n5311830\n5917233\n11343947\n3383462\n2983708\n16066624\n9361341\n9763158\n6033478\n16771783\n5042468\n1168363\n10441075\n13450204\n15870223\n10405443\n5733188\n7044678\n8909198\n225181\n10664001\n7523984\n1607389\n3890383\n13399752\n12697665\n5315847\n11489329\n4283028\n7530270\n9938770\n10258933\n14173609\n6836337\n1993670\n7824782\n16711813\n8705580\n1011804\n13935094\n8586073\n15964591\n15802908\n10456054\n14434011\n12261617\n13336029\n15045382\n13016264\n16585349\n7664705\n10066522\n8615867\n4644582\n14257184\n7182203\n5916959\n12899115\n13241771\n8470046\n5776474\n10726932\n6275691\n11273563\n6406405\n5683228\n14116968\n16032766\n16082205\n9311459\n7931625\n2889882\n10624141\n4224004\n15820430\n9880864\n9344775\n14203893\n9757384\n6776044\n1481095\n9637699\n12866904\n15824636\n15146736\n15891969\n3279565\n16505729\n7837015\n7823044\n6645479\n6951979\n15187047\n11431729\n10509873\n9437333\n2080508\n4192091\n2016586\n11779010\n3639217\n9302262\n2431752\n3607578\n6352766\n10227314\n8169152\n14662732\n14893003\n13439702\n3941650\n9060460\n13185127\n3380276\n9289947\n7063305\n1752803\n431147\n8096038\n11190620\n12665199\n10460930\n466295\n13762435\n7884072\n5693012\n11330849\n5612928\n8546323\n11205468\n4598309\n4252451\n1973105\n12468810\n3344776\n15653642\n14646586\n4415240\n12967944\n6577107\n6123656\n6334503\n14878664\n14731551\n1246868\n10115499\n8853430\n4069456\n13305259\n3781253\n11988284\n12998128\n8499943\n11774105\n7635501\n11369551\n9482253\n662336\n8104173\n2173319\n11520490\n7147270\n10769756\n15278591\n15976154\n15581846\n14616369\n15377556\n6883809\n1982318\n8028248\n8322584\n11384471\n8883482\n13650963\n2691611\n13305518\n12959318\n6697158\n7651080\n13165671\n4505721\n15581888\n11803236\n3565424\n12710453\n694401\n4192087\n15295734\n15667860\n7968203\n486659\n11753834\n16240571\n16594952\n10423016\n4267172\n6230491\n11039119\n4912981\n7288923\n9354533\n5076942\n3976748\n13475769\n10219897\n12767109\n1494097\n8570356\n3498743\n16650213\n13503974\n7969571\n15341375\n11818699\n6824450\n12014482\n3746747\n13148952\n15035802\n16756636\n6884552\n1407929\n16152723\n15727345\n11808784\n16189445\n15348288\n1276589\n2861283\n12744124\n14425658\n7891965\n5584833\n3539004\n13493861\n11864702\n3697066\n4964448\n8377062\n15921004\n6509606\n11309811\n16239680\n10955466\n14289747\n3910062\n5262864\n8324954\n156542\n6022739\n6687212\n9952000\n6908715\n7859664\n3790971\n5345406\n12552332\n1263613\n9593685\n15453926\n12171709\n7081265\n15993689\n6058040\n281895\n13310646\n13290746\n4594866\n3990179\n9496550\n5117332\n8828183\n180745\n8099046\n11397665\n1977612\n13624309\n8009401\n3319725\n8427784\n8157570\n7315676\n3326097\n11248344\n4821723\n16562063\n15980031\n11472347\n11908706\n10929524\n5608315\n11551291\n12058168\n9195659\n7135442\n6448710\n9933766\n5030683\n10874533\n14737356\n8602602\n1182372\n12443905\n4802326\n6505999\n9995988\n3764846\n9048656\n8798369\n15634956\n7853997\n2905530\n13492402\n16661039\n3926234\n5096183\n7865797\n14084132\n5410495\n16650956\n15157295\n7048405\n5083947\n1952135\n1733726\n3285086\n5969828\n12384466\n10887895\n12573095\n15497013\n3244889\n11976591\n13524670\n8226077\n14831834\n10598064\n9010943\n13679355\n3458458\n15330448\n7396448\n7126135\n276502\n765473\n16426790\n12244160\n15445179\n10070429\n6976444\n11004435\n11602744\n9484467\n16241533\n7372061\n5676150\n10815730\n5907453\n16270481\n14931370\n10479764\n13222521\n13035570\n9454948\n13946925\n8067131\n743806\n949325\n231716\n10796515\n6410921\n16299646\n2236462\n9702613\n15474139\n5580024\n11859522\n14353544\n8611458\n9462394\n9321695\n14576329\n3894374\n14079322\n8501135\n14211016\n11723619\n16552569\n9121772\n9969221\n4029172\n4681061\n11587192\n10009377\n3362168\n11534568\n14214366\n1051471\n15671228\n16710401\n770342\n5482814\n2633093\n1984773\n13316252\n3018940\n491253\n9170464\n2062374\n9529236\n5022780\n8091885\n14612934\n6997846\n845972\n8449509\n13074435\n10139419\n5028488\n5531054\n8481523\n825454\n10374558\n14547217\n12102523\n8250926\n8646608\n14574135\n1162046\n6251691\n5096398\n6231386\n13921958\n9583904\n12095199\n6400924\n1879336\n6275427\n658948\n10689240\n1611449\n6546571\n8735114\n12271260\n1861452\n13029453\n4001605\n14099000\n13319588\n6568434\n9962155\n15391695\n15318492\n2876114\n9661876\n2147811\n14353482\n11144376\n10978699\n8438121\n9922402\n2062277\n3177060\n2539451\n1816976\n4190964\n15217001\n15471362\n3140297\n12824546\n8958539\n3307173\n8364028\n2935613\n2578208\n2820426\n9721890\n6755013\n8313928\n7981189\n6782751\n9541100\n2109081\n6608154\n8786209\n15166394\n3794827\n12895964\n2857352\n9442795\n10740005\n3449544\n8325592\n14394153\n4078916\n1127857\n7961472\n10821263\n929108\n8477745\n3407264\n2672362\n13645799\n9790963\n2777665\n8133014\n237667\n5679457\n858032\n14020942\n1761777\n9272832\n7845615\n14099926\n4016363\n12009791\n2720355\n10775597\n11533698\n16215163\n15254535\n6829206\n14294490\n2415929\n1913761\n7424702\n3319206\n16423712\n7235456\n13615417\n2497641\n8066124\n13770860\n6013576\n4757934\n12255422\n10293096\n2434091\n1726222\n14418782\n13026575\n14272827\n16609908\n1534728\n6736415\n6756278\n14931745\n9304653\n16622307\n8317624\n11051230\n5816934\n15113988\n6081204\n9259589\n550572\n16775212\n6678553\n11084944\n13214575\n9289672\n2544314\n6487078\n2090633\n7047693\n9993725\n4614414\n324416\n3042844\n10712257\n7181507\n11390782\n9034757\n12299764\n6989631\n331094\n2993407\n9900250\n948929\n2524574\n13935613\n7476285\n10520745\n6148885\n7733349\n14287610\n2265338\n4966020\n1813844\n13316290\n12556594\n4341425\n7510387\n12779625\n9522652\n11956254\n9285883\n16652160\n14111714\n12854428\n15423755\n16244447\n14082737\n12615143\n16509953\n5225017\n10569308\n8292389\n5180902\n10012642\n3821676\n4438720\n15692197\n13298366\n5367433\n9982338\n7749363\n8855650\n11001638\n15478281\n8345948\n938633\n16729411\n6704344\n14921281\n2089522\n14775497\n16153134\n4586694\n10676750\n16304213\n15082379\n15764521\n5950039\n6209320\n11551897\n16481559\n2881399\n3376581\n15759972\n5180907\n11048140\n10554627\n11489381\n14990054\n7752231\n13613476\n5277904\n16696982\n5800889\n2230566\n8337099\n6147818\n3229129\n2301785\n13719258\n12237904\n7382439\n9785907\n3643828\n11134353\n11754808\n12302009\n2382090\n8503266\n5551056\n9249082\n13192789\n5251837\n10017549\n5418181\n5397213\n1968035\n4912897\n8247484\n12865356\n256088\n10044190\n14532465\n16421373\n2194067\n5596966\n486696\n14436119\n10123009\n1127865\n1999692\n9194974\n16151513\n6106890\n532360\n15611246\n3834250\n3443435\n14578023\n6029566\n8983138\n13099863\n4979287\n332620\n4832773\n11950493\n12620628\n2382435\n16606170\n528735\n16115775\n8743725\n12386464\n969675\n15336094\n1691528\n3597767\n8015804\n9573315\n695389\n9881858\n720566\n737418\n14307438\n9827052\n6860890\n10192501\n782795\n8159339\n13220670\n6007447\n9300204\n15711941\n5658856\n11974116\n6805065\n13625884\n5279827\n13107058\n12045308\n6913106\n3284039\n3134408\n12730793\n11041517\n2606761\n4524006\n14790432\n6240482\n4404483\n4869779\n12385184\n10186915\n10535570\n5506683\n9532826\n10276650\n11318879\n980742\n8684246\n7312630\n2471487\n6131774\n15266970\n5055069\n10809082\n8238814\n6375455\n5544899\n15402039\n12902530\n3085072\n6392956\n3132841\n15903803\n13532977\n7864176\n5398346\n16619761\n6205775\n8722082\n5660292\n4773082\n2099165\n7479792\n9802459\n12332757\n6200875\n14593413\n5614513\n10369984\n13362211\n3951724\n7531453\n3278316\n8284353\n6623207\n1618697\n3724143\n8474900\n2550540\n9271156\n12806311\n11278229\n13021239\n12957456\n9031235\n4057588\n8852956\n638252\n339244\n5158697\n8597011\n14350165\n13196822\n2899582\n10689346\n15872301\n11789823\n9653197\n16476152\n6148559\n10636222\n8451768\n11752463\n7434516\n10550437\n588729\n1339596\n6255657\n4705937\n2883661\n12520600\n11359398\n11338784\n5783606\n2420875\n15702442\n2257777\n3035853\n7258590\n10161279\n14545063\n7968244\n14656201\n15882150\n7912095\n4757950\n14767421\n9430393\n8106344\n15498809\n1491269\n1683487\n16079564\n15697148\n1780888\n9426172\n4319420\n5876769\n16725080\n7767946\n11521955\n11379003\n7239822\n14987302\n8793765\n9106054\n7167589\n11710555\n6685012\n10906667\n2035102\n5037300\n11233523\n"

13234715490 = Day22.part1(input) |> IO.inspect(label: :day22_part1, charlists: :as_lists)
1490 = Day22.part2(input) |> IO.inspect(label: :day22_part2, charlists: :as_lists)
```
